
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="bfc13d24-9a94-5353-a651-a6af953764ae")}catch(e){}}();
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./togeojson-okOaiIBC.js","./maplibre-BVTtx8Jb.js","./maplibre-gl-aGn2FQTM.js","./index-B9vnM0By.js","./format-detection-Chare-MU.js"])))=>i.map(i=>d[i]);
import{b as Bu,c as Hu,a as x,R as cr,_ as xe,M as Wu,d as zu,S as Vu,L as Ju}from"./maplibre-BVTtx8Jb.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var ls={exports:{}},_n={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ra;function Xu(){if(ra)return _n;ra=1;var t=Bu(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(o,c,l){var h,u={},f=null,d=null;l!==void 0&&(f=""+l),c.key!==void 0&&(f=""+c.key),c.ref!==void 0&&(d=c.ref);for(h in c)r.call(c,h)&&!i.hasOwnProperty(h)&&(u[h]=c[h]);if(o&&o.defaultProps)for(h in c=o.defaultProps,c)u[h]===void 0&&(u[h]=c[h]);return{$$typeof:e,type:o,key:f,ref:d,props:u,_owner:s.current}}return _n.Fragment=n,_n.jsx=a,_n.jsxs=a,_n}var sa;function Ku(){return sa||(sa=1,ls.exports=Xu()),ls.exports}var g=Ku(),lr={},ia;function Yu(){if(ia)return lr;ia=1;var t=Hu();return lr.createRoot=t.createRoot,lr.hydrateRoot=t.hydrateRoot,lr}var Qu=Yu();const C=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,j=globalThis,we="10.37.0";function Ge(){return Zr(j),j}function Zr(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||we,e[we]=e[we]||{}}function an(t,e,n=j){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[we]=r[we]||{};return s[t]||(s[t]=e())}const Zu=["debug","info","warn","error","log","assert","trace"],th="Sentry Logger ",Or={};function on(t){if(!("console"in j))return t();const e=j.console,n={},r=Object.keys(Or);r.forEach(s=>{const i=Or[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function eh(){mi().enabled=!0}function nh(){mi().enabled=!1}function tc(){return mi().enabled}function rh(...t){pi("log",...t)}function sh(...t){pi("warn",...t)}function ih(...t){pi("error",...t)}function pi(t,...e){C&&tc()&&on(()=>{j.console[t](`${th}[${t}]:`,...e)})}function mi(){return C?an("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const P={enable:eh,disable:nh,isEnabled:tc,log:rh,warn:sh,error:ih},ec=50,Ie="?",aa=/\(error: (.*)\)/,oa=/captureMessage|captureException/;function nc(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,s=0)=>{const i=[],a=n.split(`
`);for(let o=r;o<a.length;o++){let c=a[o];c.length>1024&&(c=c.slice(0,1024));const l=aa.test(c)?c.replace(aa,"$1"):c;if(!l.match(/\S*Error: /)){for(const h of e){const u=h(l);if(u){i.push(u);break}}if(i.length>=ec+s)break}}return oh(i.slice(s))}}function ah(t){return Array.isArray(t)?nc(...t):t}function oh(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(ur(e).function||"")&&e.pop(),e.reverse(),oa.test(ur(e).function||"")&&(e.pop(),oa.test(ur(e).function||"")&&e.pop()),e.slice(0,ec).map(n=>({...n,filename:n.filename||ur(e).filename,function:n.function||Ie}))}function ur(t){return t[t.length-1]||{}}const us="<anonymous>";function Vt(t){try{return!t||typeof t!="function"?us:t.name||us}catch{return us}}function ca(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}function rc(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const Er={},la={};function ge(t,e){Er[t]=Er[t]||[],Er[t].push(e)}function _e(t,e){if(!la[t]){la[t]=!0;try{e()}catch(n){C&&P.error(`Error while instrumenting ${t}`,n)}}}function Pt(t,e){const n=t&&Er[t];if(n)for(const r of n)try{r(e)}catch(s){C&&P.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Vt(r)}
Error:`,s)}}let hs=null;function sc(t){const e="error";ge(e,t),_e(e,ch)}function ch(){hs=j.onerror,j.onerror=function(t,e,n,r,s){return Pt("error",{column:r,error:s,line:n,msg:t,url:e}),hs?hs.apply(this,arguments):!1},j.onerror.__SENTRY_INSTRUMENTED__=!0}let fs=null;function ic(t){const e="unhandledrejection";ge(e,t),_e(e,lh)}function lh(){fs=j.onunhandledrejection,j.onunhandledrejection=function(t){return Pt("unhandledrejection",t),fs?fs.apply(this,arguments):!0},j.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const ac=Object.prototype.toString;function ts(t){switch(ac.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Jt(t,Error)}}function cn(t,e){return ac.call(t)===`[object ${e}]`}function oc(t){return cn(t,"ErrorEvent")}function ua(t){return cn(t,"DOMError")}function uh(t){return cn(t,"DOMException")}function Wt(t){return cn(t,"String")}function gi(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Xe(t){return t===null||gi(t)||typeof t!="object"&&typeof t!="function"}function kn(t){return cn(t,"Object")}function es(t){return typeof Event<"u"&&Jt(t,Event)}function hh(t){return typeof Element<"u"&&Jt(t,Element)}function fh(t){return cn(t,"RegExp")}function ln(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function dh(t){return kn(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Jt(t,e){try{return t instanceof e}catch{return!1}}function cc(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue||t.__v_isVNode))}function _i(t){return typeof Request<"u"&&Jt(t,Request)}const yi=j,ph=80;function It(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,a=0;const o=" > ",c=o.length;let l;const h=Array.isArray(e)?e:e.keyAttrs,u=!Array.isArray(e)&&e.maxStringLength||ph;for(;n&&i++<r&&(l=mh(n,h),!(l==="html"||i>1&&a+s.length*c+l.length>=u));)s.push(l),a+=l.length,n=n.parentNode;return s.reverse().join(o)}catch{return"<unknown>"}}function mh(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(yi.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(a=>n.getAttribute(a)).map(a=>[a,n.getAttribute(a)]):null;if(s!=null&&s.length)s.forEach(a=>{r.push(`[${a[0]}="${a[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const a=n.className;if(a&&Wt(a)){const o=a.split(/\s+/);for(const c of o)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const a of i){const o=n.getAttribute(a);o&&r.push(`[${a}="${o}"]`)}return r.join("")}function Un(){try{return yi.document.location.href}catch{return""}}function lc(t){if(!yi.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function Et(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&uc(s,r);try{t[e]=s}catch{C&&P.log(`Failed to replace method "${e}" in object`,t)}}function gt(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{C&&P.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function uc(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,gt(t,"__sentry_original__",e)}catch{}}function vi(t){return t.__sentry_original__}function hc(t){if(ts(t))return{message:t.message,name:t.name,stack:t.stack,...fa(t)};if(es(t)){const e={type:t.type,target:ha(t.target),currentTarget:ha(t.currentTarget),...fa(t)};return typeof CustomEvent<"u"&&Jt(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function ha(t){try{return hh(t)?It(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function fa(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function gh(t){const e=Object.keys(hc(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}let je;function qn(t){if(je!==void 0)return je?je(t):t();const e=Symbol.for("__SENTRY_SAFE_RANDOM_ID_WRAPPER__"),n=j;return e in n&&typeof n[e]=="function"?(je=n[e],je(t)):(je=null,t())}function ie(){return qn(()=>Math.random())}function Bn(){return qn(()=>Date.now())}function Ls(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function da(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{cc(s)?n.push(rc(s)):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function br(t,e,n=!1){return Wt(t)?fh(e)?e.test(t):Wt(e)?n?t===e:t.includes(e):!1:!1}function ae(t,e=[],n=!1){return e.some(r=>br(t,r,n))}function _h(){const t=j;return t.crypto||t.msCrypto}let ds;function yh(){return ie()*16}function Tt(t=_h()){try{if(t!=null&&t.randomUUID)return qn(()=>t.randomUUID()).replace(/-/g,"")}catch{}return ds||(ds="10000000100040008000"+1e11),ds.replace(/[018]/g,e=>(e^(yh()&15)>>e/4).toString(16))}function fc(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function be(t){const{message:e,event_id:n}=t;if(e)return e;const r=fc(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Os(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function Ke(t,e){const n=fc(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s==null?void 0:s.data,...e.data};n.mechanism.data=i}}function pa(t){if(vh(t))return!0;try{gt(t,"__sentry_captured__",!0)}catch{}return!1}function vh(t){try{return t.__sentry_captured__}catch{}}const dc=1e3;function Re(){return Bn()/dc}function Sh(){const{performance:t}=j;if(!(t!=null&&t.now)||!t.timeOrigin)return Re;const e=t.timeOrigin;return()=>(e+qn(()=>t.now()))/dc}let ma;function st(){return(ma??(ma=Sh()))()}let ps=null;function Eh(){var a;const{performance:t}=j;if(!(t!=null&&t.now))return;const e=3e5,n=qn(()=>t.now()),r=Bn(),s=t.timeOrigin;if(typeof s=="number"&&Math.abs(s+n-r)<e)return s;const i=(a=t.timing)==null?void 0:a.navigationStart;return typeof i=="number"&&Math.abs(i+n-r)<e?i:r-n}function bt(){return ps===null&&(ps=Eh()),ps}function bh(t){const e=st(),n={sid:Tt(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>xh(n)};return t&&Ye(n,t),n}function Ye(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||st(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Tt()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Mh(t,e){let n={};t.status==="ok"&&(n={status:"exited"}),Ye(t,n)}function xh(t){return{sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}}}function Hn(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Hn(r[s],e[s],n-1));return r}function Xt(){return Tt()}function zt(){return Tt().substring(16)}const js="_sentrySpan";function Qe(t,e){e?gt(t,js,e):delete t[js]}function jr(t){return t[js]}const wh=100;class Kt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Xt(),sampleRand:ie()}}clone(){const e=new Kt;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._attributes={...this._attributes},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,e._conversationId=this._conversationId,Qe(e,jr(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Ye(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setConversationId(e){return this._conversationId=e||void 0,this._notifyScopeListeners(),this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this.setTags({[e]:n})}setAttributes(e){return this._attributes={...this._attributes,...e},this._notifyScopeListeners(),this}setAttribute(e,n){return this.setAttributes({[e]:n})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Kt?n.getScopeData():kn(n)?e:void 0,{tags:s,attributes:i,extra:a,user:o,contexts:c,level:l,fingerprint:h=[],propagationContext:u,conversationId:f}=r||{};return this._tags={...this._tags,...s},this._attributes={...this._attributes,...i},this._extra={...this._extra,...a},this._contexts={...this._contexts,...c},o&&Object.keys(o).length&&(this._user=o),l&&(this._level=l),h.length&&(this._fingerprint=h),u&&(this._propagationContext=u),f&&(this._conversationId=f),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,this._conversationId=void 0,Qe(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Xt(),sampleRand:ie()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:wh;if(r<=0)return this;const s={timestamp:Re(),...e,message:e.message?Ls(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:jr(this),conversationId:this._conversationId}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Hn(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||Tt();if(!this._client)return C&&P.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||Tt();if(!this._client)return C&&P.warn("No client configured on scope - will not capture message!"),s;const i=(r==null?void 0:r.syntheticException)??new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||Tt();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(C&&P.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function Ph(){return an("defaultCurrentScope",()=>new Kt)}function Th(){return an("defaultIsolationScope",()=>new Kt)}class Nh{constructor(e,n){let r;e?r=e:r=new Kt;let s;n?s=n:s=new Kt,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return ln(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Ze(){const t=Ge(),e=Zr(t);return e.stack=e.stack||new Nh(Ph(),Th())}function Ih(t){return Ze().withScope(t)}function kh(t,e){const n=Ze();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function ga(t){return Ze().withScope(()=>t(Ze().getIsolationScope()))}function Ch(){return{withIsolationScope:ga,withScope:Ih,withSetScope:kh,withSetIsolationScope:(t,e)=>ga(e),getCurrentScope:()=>Ze().getScope(),getIsolationScope:()=>Ze().getIsolationScope()}}function un(t){const e=Zr(t);return e.acs?e.acs:Ch()}function z(){const t=Ge();return un(t).getCurrentScope()}function Qt(){const t=Ge();return un(t).getIsolationScope()}function Ah(){return an("globalScope",()=>new Kt)}function ns(...t){const e=Ge(),n=un(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function H(){return z().getClient()}function Gh(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||zt()};return r&&(i.parent_span_id=r),i}const $t="sentry.source",Si="sentry.sample_rate",pc="sentry.previous_trace_sample_rate",Yt="sentry.op",rt="sentry.origin",Cn="sentry.idle_span_finish_reason",Wn="sentry.measurement_unit",zn="sentry.measurement_value",_a="sentry.custom_span_name",Ei="sentry.profile_id",hn="sentry.exclusive_time",Rh="sentry.link.type",Lh="gen_ai.conversation.id",Oh=0,bi=1,nt=2;function jh(t){if(t<400&&t>=100)return{code:bi};if(t>=400&&t<500)switch(t){case 401:return{code:nt,message:"unauthenticated"};case 403:return{code:nt,message:"permission_denied"};case 404:return{code:nt,message:"not_found"};case 409:return{code:nt,message:"already_exists"};case 413:return{code:nt,message:"failed_precondition"};case 429:return{code:nt,message:"resource_exhausted"};case 499:return{code:nt,message:"cancelled"};default:return{code:nt,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:nt,message:"unimplemented"};case 503:return{code:nt,message:"unavailable"};case 504:return{code:nt,message:"deadline_exceeded"};default:return{code:nt,message:"internal_error"}}return{code:nt,message:"internal_error"}}function mc(t,e){t.setAttribute("http.response.status_code",e);const n=jh(e);n.message!=="unknown_error"&&t.setStatus(n)}const gc="_sentryScope",_c="_sentryIsolationScope";function Fh(t){try{const e=j.WeakRef;if(typeof e=="function")return new e(t)}catch{}return t}function $h(t){if(t){if(typeof t=="object"&&"deref"in t&&typeof t.deref=="function")try{return t.deref()}catch{return}return t}}function Dh(t,e,n){t&&(gt(t,_c,Fh(n)),gt(t,gc,e))}function Fr(t){const e=t;return{scope:e[gc],isolationScope:$h(e[_c])}}const Mi="sentry-",Uh=/^sentry-/,qh=8192;function yc(t){const e=Hh(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(Uh)){const a=s.slice(Mi.length);r[a]=i}return r},{});if(Object.keys(n).length>0)return n}function Bh(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,s])=>(s&&(n[`${Mi}${r}`]=s),n),{});return Wh(e)}function Hh(t){if(!(!t||!Wt(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=ya(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):ya(t)}function ya(t){return t.split(",").map(e=>{const n=e.indexOf("=");if(n===-1)return[];const r=e.slice(0,n),s=e.slice(n+1);return[r,s].map(i=>{try{return decodeURIComponent(i.trim())}catch{return}})}).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Wh(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],s)=>{const i=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,a=s===0?i:`${e},${i}`;return a.length>qh?(C&&P.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):a},"")}const zh=/^o(\d+)\./,Vh=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)((?:\[[:.%\w]+\]|[\w.-]+))(?::(\d+))?\/(.+)/;function Jh(t){return t==="http"||t==="https"}function fn(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:a,protocol:o,publicKey:c}=t;return`${o}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${a}`}function Xh(t){const e=Vh.exec(t);if(!e){on(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",a="",o=""]=e.slice(1);let c="",l=o;const h=l.split("/");if(h.length>1&&(c=h.slice(0,-1).join("/"),l=h.pop()),l){const u=l.match(/^\d+/);u&&(l=u[0])}return vc({host:i,pass:s,path:c,projectId:l,port:a,protocol:n,publicKey:r})}function vc(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Kh(t){if(!C)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(a=>t[a]?!1:(P.error(`Invalid Sentry Dsn: ${a} missing`),!0))?!1:n.match(/^\d+$/)?Jh(r)?e&&isNaN(parseInt(e,10))?(P.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(P.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(P.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Yh(t){const e=t.match(zh);return e==null?void 0:e[1]}function Qh(t){const e=t.getOptions(),{host:n}=t.getDsn()||{};let r;return e.orgId?r=String(e.orgId):n&&(r=Yh(n)),r}function Zh(t){const e=typeof t=="string"?Xh(t):vc(t);if(!(!e||!Kh(e)))return e}function An(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Sc=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function tf(t){if(!t)return;const e=t.match(Sc);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function ef(t,e){const n=tf(t),r=yc(e);if(!(n!=null&&n.traceId))return{traceId:Xt(),sampleRand:ie()};const s=nf(n,r);r&&(r.sample_rand=s.toString());const{traceId:i,parentSpanId:a,parentSampled:o}=n;return{traceId:i,parentSpanId:a,sampled:o,dsc:r||{},sampleRand:s}}function Ec(t=Xt(),e=zt(),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function bc(t=Xt(),e=zt(),n){return`00-${t}-${e}-${n?"01":"00"}`}function nf(t,e){const n=An(e==null?void 0:e.sample_rand);if(n!==void 0)return n;const r=An(e==null?void 0:e.sample_rate);return r&&(t==null?void 0:t.parentSampled)!==void 0?t.parentSampled?ie()*r:r+ie()*(1-r):ie()}const Mc=0,xi=1;let va=!1;function rf(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:a,origin:o,links:c}=D(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:a,origin:o,links:c}}function sf(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:D(t).parent_span_id,i=Fr(t).scope,a=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||zt():e;return{parent_span_id:s,span_id:a,trace_id:n}}function af(t){const{traceId:e,spanId:n}=t.spanContext(),r=ye(t);return Ec(e,n,r)}function of(t){const{traceId:e,spanId:n}=t.spanContext(),r=ye(t);return bc(e,n,r)}function xc(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===xi,attributes:i,...s}))}function Pe(t){return typeof t=="number"?Sa(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Sa(t.getTime()):st()}function Sa(t){return t>9999999999?t/1e3:t}function D(t){var r;if(lf(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(cf(t)){const{attributes:s,startTime:i,name:a,endTime:o,status:c,links:l}=t,h="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:a,parent_span_id:h,start_timestamp:Pe(i),timestamp:Pe(o)||void 0,status:wc(c),op:s[Yt],origin:s[rt],links:xc(l)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function cf(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function lf(t){return typeof t.getSpanJSON=="function"}function ye(t){const{traceFlags:e}=t.spanContext();return e===xi}function wc(t){if(!(!t||t.code===Oh))return t.code===bi?"ok":t.message||"internal_error"}const Te="_sentryChildSpans",Fs="_sentryRootSpan";function Pc(t,e){const n=t[Fs]||t;gt(e,Fs,n),t[Te]?t[Te].add(e):gt(t,Te,new Set([e]))}function uf(t,e){t[Te]&&t[Te].delete(e)}function Mr(t){const e=new Set;function n(r){if(!e.has(r)&&ye(r)){e.add(r);const s=r[Te]?Array.from(r[Te]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function ht(t){return t[Fs]||t}function Mt(){const t=Ge(),e=un(t);return e.getActiveSpan?e.getActiveSpan():jr(z())}function $s(){va||(on(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),va=!0)}let Ea=!1;function hf(){if(Ea)return;function t(){const e=Mt(),n=e&&ht(e);if(n){const r="internal_error";C&&P.log(`[Tracing] Root span: ${r} -> Global error occurred`),n.setStatus({code:nt,message:r})}}t.tag="sentry_tracingErrorCallback",Ea=!0,sc(t),ic(t)}function Ot(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=H())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}function ba(t){P.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function $r(t,e){if(!(e!=null&&e.length)||!t.description)return!1;for(const n of e){if(df(n)){if(br(t.description,n))return C&&ba(t),!0;continue}if(!n.name&&!n.op)continue;const r=n.name?br(t.description,n.name):!0,s=n.op?t.op&&br(t.op,n.op):!0;if(r&&s)return C&&ba(t),!0}return!1}function ff(t,e){const n=e.parent_span_id,r=e.span_id;if(n)for(const s of t)s.parent_span_id===r&&(s.parent_span_id=n)}function df(t){return typeof t=="string"||t instanceof RegExp}const wi="production",Tc="_frozenDsc";function xr(t,e){gt(t,Tc,e)}function Nc(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},s={environment:n.environment||wi,release:n.release,public_key:r,trace_id:t,org_id:Qh(e)};return e.emit("createDsc",s),s}function Ic(t,e){const n=e.getPropagationContext();return n.dsc||Nc(n.traceId,t)}function ue(t){var p;const e=H();if(!e)return{};const n=ht(t),r=D(n),s=r.data,i=n.spanContext().traceState,a=(i==null?void 0:i.get("sentry.sample_rate"))??s[Si]??s[pc];function o(_){return(typeof a=="number"||typeof a=="string")&&(_.sample_rate=`${a}`),_}const c=n[Tc];if(c)return o(c);const l=i==null?void 0:i.get("sentry.dsc"),h=l&&yc(l);if(h)return o(h);const u=Nc(t.spanContext().traceId,e),f=s[$t],d=r.description;return f!=="url"&&d&&(u.transaction=d),Ot()&&(u.sampled=String(ye(n)),u.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((p=Fr(n).scope)==null?void 0:p.getPropagationContext().sampleRand.toString())),o(u),e.emit("createDsc",u,n),u}class he{constructor(e={}){this._traceId=e.traceId||Xt(),this._spanId=e.spanId||zt()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Mc}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function Ht(t,e=100,n=1/0){try{return Ds("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function kc(t,e=3,n=100*1024){const r=Ht(t,e);return _f(r)>n?kc(t,e-1,n):r}function Ds(t,e,n=1/0,r=1/0,s=yf()){const[i,a]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const o=pf(t,e);if(!o.startsWith("[object "))return o;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return o.replace("object ","");if(i(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const d=l.toJSON();return Ds("",d,c-1,r,s)}catch{}const h=Array.isArray(e)?[]:{};let u=0;const f=hc(e);for(const d in f){if(!Object.prototype.hasOwnProperty.call(f,d))continue;if(u>=r){h[d]="[MaxProperties ~]";break}const p=f[d];h[d]=Ds(d,p,c-1,r,s),u++}return a(e),h}function pf(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(cc(e))return rc(e);if(dh(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Vt(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=mf(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function mf(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function gf(t){return~-encodeURI(t).split(/%..|./).length}function _f(t){return gf(JSON.stringify(t))}function yf(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function Le(t,e=[]){return[t,e]}function vf(t,e){const[n,r]=t;return[n,[...r,e]]}function Us(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Sf(t,e){return Us(t,(n,r)=>e.includes(r))}function qs(t){const e=Zr(j);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function Ef(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[qs(r),i]:r.push(typeof i=="string"?qs(i):i)}for(const i of n){const[a,o]=i;if(s(`
${JSON.stringify(a)}
`),typeof o=="string"||o instanceof Uint8Array)s(o);else{let c;try{c=JSON.stringify(o)}catch{c=JSON.stringify(Ht(o))}s(c)}}return typeof r=="string"?r:bf(r)}function bf(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Mf(t){return[{type:"span"},t]}function xf(t){const e=typeof t.data=="string"?qs(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const wf={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function Ma(t){return wf[t]}function Cc(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function Pf(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:fn(r)},...s&&{trace:s}}}function Tf(t,e){var r,s,i,a;if(!e)return t;const n=t.sdk||{};return t.sdk={...n,name:n.name||e.name,version:n.version||e.version,integrations:[...((r=t.sdk)==null?void 0:r.integrations)||[],...e.integrations||[]],packages:[...((s=t.sdk)==null?void 0:s.packages)||[],...e.packages||[]],settings:(i=t.sdk)!=null&&i.settings||e.settings?{...(a=t.sdk)==null?void 0:a.settings,...e.settings}:void 0},t}function Nf(t,e,n,r){const s=Cc(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:fn(e)}},a="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return Le(i,[a])}function If(t,e,n,r){const s=Cc(n),i=t.type&&t.type!=="replay_event"?t.type:"event";Tf(t,n==null?void 0:n.sdk);const a=Pf(t,s,r,e);return delete t.sdkProcessingMetadata,Le(a,[[{type:i},t]])}function kf(t,e){function n(d){return!!d.trace_id&&!!d.public_key}const r=ue(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,a={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:fn(s)}},{beforeSendSpan:o,ignoreSpans:c}=(e==null?void 0:e.getOptions())||{},l=c!=null&&c.length?t.filter(d=>!$r(D(d),c)):t,h=t.length-l.length;h&&(e==null||e.recordDroppedEvent("before_send","span",h));const u=o?d=>{const p=D(d),_=o(p);return _||($s(),p)}:D,f=[];for(const d of l){const p=u(d);p&&f.push(Mf(p))}return Le(a,f)}function Cf(t){if(!C)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=D(t),{spanId:s}=t.spanContext(),i=ye(t),a=ht(t),o=a===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${o?"root ":""}span`,l=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&l.push(`parent ID: ${r}`),!o){const{op:h,description:u}=D(a);l.push(`root ID: ${a.spanContext().spanId}`),h&&l.push(`root op: ${h}`),u&&l.push(`root description: ${u}`)}P.log(`${c}
  ${l.join(`
  `)}`)}function Af(t){if(!C)return;const{description:e="< unknown name >",op:n="< unknown op >"}=D(t),{spanId:r}=t.spanContext(),i=ht(t)===t,a=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;P.log(a)}function Gf(t,e,n,r=Mt()){const s=r&&ht(r);s&&(C&&P.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[zn]:e,[Wn]:n}))}function xa(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[Wn],i=r[zn];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const wa=1e3;class rs{constructor(e={}){this._traceId=e.traceId||Xt(),this._spanId=e.spanId||zt(),this._startTime=e.startTimestamp||st(),this._links=e.links,this._attributes={},this.setAttributes({[rt]:"manual",[Yt]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?xi:Mc}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=Pe(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute($t,"custom"),this}end(e){this._endTime||(this._endTime=Pe(e),Af(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Yt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:wc(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[rt],profile_id:this._attributes[Ei],exclusive_time:this._attributes[hn],measurements:xa(this._events),is_segment:this._isStandaloneSpan&&ht(this)===this||void 0,segment_id:this._isStandaloneSpan?ht(this).spanContext().spanId:void 0,links:xc(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){C&&P.log("[Tracing] Adding an event to span:",e);const s=Pa(n)?n:r||st(),i=Pa(n)?{}:n||{},a={name:e,time:Pe(s),attributes:i};return this._events.push(a),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=H();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===ht(this)))return;if(this._isStandaloneSpan){this._sampled?Lf(kf([this],e)):(C&&P.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Fr(this).scope||z()).captureEvent(r)}_convertSpanToTransaction(){var h;if(!Ta(D(this)))return;this._name||(C&&P.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Fr(this),r=(h=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:h.normalizedRequest;if(this._sampled!==!0)return;const i=Mr(this).filter(u=>u!==this&&!Rf(u)).map(u=>D(u)).filter(Ta),a=this._attributes[$t];delete this._attributes[_a],i.forEach(u=>{delete u.data[_a]});const o={contexts:{trace:rf(this)},spans:i.length>wa?i.sort((u,f)=>u.start_timestamp-f.start_timestamp).slice(0,wa):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:ue(this)},request:r,...a&&{transaction_info:{source:a}}},c=xa(this._events);return c&&Object.keys(c).length&&(C&&P.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),o.measurements=c),o}}function Pa(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Ta(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function Rf(t){return t instanceof rs&&t.isStandaloneSpan()}function Lf(t){const e=H();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}function Of(t,e,n=()=>{},r=()=>{}){let s;try{s=t()}catch(i){throw e(i),n(),i}return jf(s,e,n,r)}function jf(t,e,n,r){return ln(t)?t.then(s=>(n(),r(s),s),s=>{throw e(s),n(),s}):(n(),r(t),t)}function Ff(t,e,n){if(!Ot(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:o=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):o}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=An(s);if(i===void 0)return C&&P.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return C&&P.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const a=n<i;return a||C&&P.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[a,i,r]}const Ac="__SENTRY_SUPPRESS_TRACING__";function $f(t,e){const n=Ti();if(n.startSpan)return n.startSpan(t,e);const r=Rc(t),{forceTransaction:s,parentSpan:i,scope:a}=t,o=a==null?void 0:a.clone();return ns(o,()=>Uf(i)(()=>{const l=z(),h=Lc(l,i),f=t.onlyIfParent&&!h?new he:Gc({parentSpan:h,spanArguments:r,forceTransaction:s,scope:l});return Qe(l,f),Of(()=>e(f),()=>{const{status:d}=D(f);f.isRecording()&&(!d||d==="ok")&&f.setStatus({code:nt,message:"internal_error"})},()=>{f.end()})}))}function dn(t){const e=Ti();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=Rc(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?a=>ns(t.scope,a):s!==void 0?a=>Pi(s,a):a=>a())(()=>{const a=z(),o=Lc(a,s);return t.onlyIfParent&&!o?new he:Gc({parentSpan:o,spanArguments:n,forceTransaction:r,scope:a})})}function Pi(t,e){const n=Ti();return n.withActiveSpan?n.withActiveSpan(t,e):ns(r=>(Qe(r,t||void 0),e(r)))}function Gc({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Ot()){const a=new he;if(n||!t){const o={sampled:"false",sample_rate:"0",transaction:e.name,...ue(a)};xr(a,o)}return a}const s=Qt();let i;if(t&&!n)i=Df(t,r,e),Pc(t,i);else if(t){const a=ue(t),{traceId:o,spanId:c}=t.spanContext(),l=ye(t);i=Na({traceId:o,parentSpanId:c,...e},r,l),xr(i,a)}else{const{traceId:a,dsc:o,parentSpanId:c,sampled:l}={...s.getPropagationContext(),...r.getPropagationContext()};i=Na({traceId:a,parentSpanId:c,...e},r,l),o&&xr(i,o)}return Cf(i),Dh(i,r,s),i}function Rc(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=Pe(t.startTime),delete r.startTime,r}return n}function Ti(){const t=Ge();return un(t)}function Na(t,e,n){var p;const r=H(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,a={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",a,{decision:!1});const o=a.parentSampled??n,c=a.spanAttributes,l=e.getPropagationContext(),[h,u,f]=e.getScopeData().sdkProcessingMetadata[Ac]?[!1]:Ff(s,{name:i,parentSampled:o,attributes:c,parentSampleRate:An((p=l.dsc)==null?void 0:p.sample_rate)},l.sampleRand),d=new rs({...t,attributes:{[$t]:"custom",[Si]:u!==void 0&&f?u:void 0,...c},sampled:h});return!h&&r&&(C&&P.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",d),d}function Df(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[Ac]?!1:ye(t),a=i?new rs({...n,parentSpanId:r,traceId:s,sampled:i}):new he({traceId:s});Pc(t,a);const o=H();return o&&(o.emit("spanStart",a),n.endTimestamp&&o.emit("spanEnd",a)),a}function Lc(t,e){if(e)return e;if(e===null)return;const n=jr(t);if(!n)return;const r=H();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?ht(n):n}function Uf(t){return t!==void 0?e=>Pi(t,e):e=>e()}const wr={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},qf="heartbeatFailed",Bf="idleTimeout",Hf="finalTimeout",Wf="externalFinish";function Oc(t,e={}){const n=new Map;let r=!1,s,i=Wf,a=!e.disableAutoFinish;const o=[],{idleTimeout:c=wr.idleTimeout,finalTimeout:l=wr.finalTimeout,childSpanTimeout:h=wr.childSpanTimeout,beforeSpanEnd:u,trimIdleSpanEndTimestamp:f=!0}=e,d=H();if(!d||!Ot()){const E=new he,k={sample_rate:"0",sampled:"false",...ue(E)};return xr(E,k),E}const p=z(),_=Mt(),m=zf(t);m.end=new Proxy(m.end,{apply(E,k,L){if(u&&u(m),k instanceof he)return;const[V,...W]=L,it=V||st(),K=Pe(it),X=Mr(m).filter(G=>G!==m),Ut=D(m);if(!X.length||!f)return v(K),Reflect.apply(E,k,[K,...W]);const yt=d.getOptions().ignoreSpans,Ct=X==null?void 0:X.reduce((G,F)=>{const J=D(F);return!J.timestamp||yt&&$r(J,yt)?G:G?Math.max(G,J.timestamp):J.timestamp},void 0),A=Ut.start_timestamp,O=Math.min(A?A+l/1e3:1/0,Math.max(A||-1/0,Math.min(K,Ct||1/0)));return v(O),Reflect.apply(E,k,[O,...W])}});function y(){s&&(clearTimeout(s),s=void 0)}function S(E){y(),s=setTimeout(()=>{!r&&n.size===0&&a&&(i=Bf,m.end(E))},c)}function M(E){s=setTimeout(()=>{!r&&a&&(i=qf,m.end(E))},h)}function N(E){y(),n.set(E,!0);const k=st();M(k+h/1e3)}function I(E){if(n.has(E)&&n.delete(E),n.size===0){const k=st();S(k+c/1e3)}}function v(E){r=!0,n.clear(),o.forEach(X=>X()),Qe(p,_);const k=D(m),{start_timestamp:L}=k;if(!L)return;k.data[Cn]||m.setAttribute(Cn,i);const W=k.status;(!W||W==="unknown")&&m.setStatus({code:bi}),P.log(`[Tracing] Idle span "${k.op}" finished`);const it=Mr(m).filter(X=>X!==m);let K=0;it.forEach(X=>{X.isRecording()&&(X.setStatus({code:nt,message:"cancelled"}),X.end(E),C&&P.log("[Tracing] Cancelling span since span ended early",JSON.stringify(X,void 0,2)));const Ut=D(X),{timestamp:yt=0,start_timestamp:Ct=0}=Ut,A=Ct<=E,O=(l+c)/1e3,G=yt-Ct<=O;if(C){const F=JSON.stringify(X,void 0,2);A?G||P.log("[Tracing] Discarding span since it finished after idle span final timeout",F):P.log("[Tracing] Discarding span since it happened after idle span was finished",F)}(!G||!A)&&(uf(m,X),K++)}),K>0&&m.setAttribute("sentry.idle_span_discarded_spans",K)}return o.push(d.on("spanStart",E=>{if(r||E===m||D(E).timestamp||E instanceof rs&&E.isStandaloneSpan())return;Mr(m).includes(E)&&N(E.spanContext().spanId)})),o.push(d.on("spanEnd",E=>{r||I(E.spanContext().spanId)})),o.push(d.on("idleSpanEnableAutoFinish",E=>{E===m&&(a=!0,S(),n.size&&M())})),e.disableAutoFinish||S(),setTimeout(()=>{r||(m.setStatus({code:nt,message:"deadline_exceeded"}),i=Hf,m.end())},l),m}function zf(t){const e=dn(t);return Qe(z(),e),C&&P.log("[Tracing] Started span is an idle span"),e}const ms=0,Ia=1,ka=2;function ss(t){return new Gn(e=>{e(t)})}function Ni(t){return new Gn((e,n)=>{n(t)})}class Gn{constructor(e){this._state=ms,this._handlers=[],this._runExecutor(e)}then(e,n){return new Gn((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(a){s(a)}},i=>{if(!n)s(i);else try{r(n(i))}catch(a){s(a)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Gn((n,r)=>{let s,i;return this.then(a=>{i=!1,s=a,e&&e()},a=>{i=!0,s=a,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===ms)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Ia&&n[1](this._value),this._state===ka&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,a)=>{if(this._state===ms){if(ln(a)){a.then(r,s);return}this._state=i,this._value=a,this._executeHandlers()}},r=i=>{n(Ia,i)},s=i=>{n(ka,i)};try{e(r,s)}catch(i){s(i)}}}function Vf(t,e,n,r=0){try{const s=Bs(e,n,t,r);return ln(s)?s:ss(s)}catch(s){return Ni(s)}}function Bs(t,e,n,r){const s=n[r];if(!t||!s)return t;const i=s({...t},e);return C&&i===null&&P.log(`Event processor "${s.id||"?"}" dropped event`),ln(i)?i.then(a=>Bs(a,e,n,r+1)):Bs(i,e,n,r+1)}let Bt,Ca,Aa,ne;function Jf(t){const e=j._sentryDebugIds,n=j._debugIds;if(!e&&!n)return{};const r=e?Object.keys(e):[],s=n?Object.keys(n):[];if(ne&&r.length===Ca&&s.length===Aa)return ne;Ca=r.length,Aa=s.length,ne={},Bt||(Bt={});const i=(a,o)=>{for(const c of a){const l=o[c],h=Bt==null?void 0:Bt[c];if(h&&ne&&l)ne[h[0]]=l,Bt&&(Bt[c]=[h[0],l]);else if(l){const u=t(c);for(let f=u.length-1;f>=0;f--){const d=u[f],p=d==null?void 0:d.filename;if(p&&ne&&Bt){ne[p]=l,Bt[c]=[p,l];break}}}}};return e&&i(r,e),n&&i(s,n),ne}function Xf(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;Yf(t,e),r&&td(t,r),ed(t,n),Qf(t,s),Zf(t,i)}function Ga(t,e){const{extra:n,tags:r,attributes:s,user:i,contexts:a,level:o,sdkProcessingMetadata:c,breadcrumbs:l,fingerprint:h,eventProcessors:u,attachments:f,propagationContext:d,transactionName:p,span:_}=e;yn(t,"extra",n),yn(t,"tags",r),yn(t,"attributes",s),yn(t,"user",i),yn(t,"contexts",a),t.sdkProcessingMetadata=Hn(t.sdkProcessingMetadata,c,2),o&&(t.level=o),p&&(t.transactionName=p),_&&(t.span=_),l.length&&(t.breadcrumbs=[...t.breadcrumbs,...l]),h.length&&(t.fingerprint=[...t.fingerprint,...h]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),f.length&&(t.attachments=[...t.attachments,...f]),t.propagationContext={...t.propagationContext,...d}}function yn(t,e,n){t[e]=Hn(t[e],n,1)}function Kf(t,e){const n=Ah().getScopeData();return t&&Ga(n,t.getScopeData()),e&&Ga(n,e.getScopeData()),n}function Yf(t,e){const{extra:n,tags:r,user:s,contexts:i,level:a,transactionName:o}=e;Object.keys(n).length&&(t.extra={...n,...t.extra}),Object.keys(r).length&&(t.tags={...r,...t.tags}),Object.keys(s).length&&(t.user={...s,...t.user}),Object.keys(i).length&&(t.contexts={...i,...t.contexts}),a&&(t.level=a),o&&t.type!=="transaction"&&(t.transaction=o)}function Qf(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Zf(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function td(t,e){t.contexts={trace:sf(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:ue(e),...t.sdkProcessingMetadata};const n=ht(e),r=D(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function ed(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}function nd(t,e,n,r,s,i){const{normalizeDepth:a=3,normalizeMaxBreadth:o=1e3}=t,c={...e,event_id:e.event_id||n.event_id||Tt(),timestamp:e.timestamp||Re()},l=n.integrations||t.integrations.map(m=>m.name);rd(c,t),ad(c,l),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&sd(c,t.stackParser);const h=cd(r,n.captureContext);n.mechanism&&Ke(c,n.mechanism);const u=s?s.getEventProcessors():[],f=Kf(i,h),d=[...n.attachments||[],...f.attachments];d.length&&(n.attachments=d),Xf(c,f);const p=[...u,...f.eventProcessors];return Vf(p,c,n).then(m=>(m&&id(m),typeof a=="number"&&a>0?od(m,a,o):m))}function rd(t,e){var o,c;const{environment:n,release:r,dist:s,maxValueLength:i}=e;t.environment=t.environment||n||wi,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const a=t.request;a!=null&&a.url&&i&&(a.url=Ls(a.url,i)),i&&((c=(o=t.exception)==null?void 0:o.values)==null||c.forEach(l=>{l.value&&(l.value=Ls(l.value,i))}))}function sd(t,e){var r,s;const n=Jf(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var a,o;(o=(a=i.stacktrace)==null?void 0:a.frames)==null||o.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function id(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var a,o;(o=(a=i.stacktrace)==null?void 0:a.frames)==null||o.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,a])=>{n.push({type:"sourcemap",code_file:i,debug_id:a})})}function ad(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function od(t,e,n){var s,i;if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(a=>({...a,...a.data&&{data:Ht(a.data,e,n)}}))},...t.user&&{user:Ht(t.user,e,n)},...t.contexts&&{contexts:Ht(t.contexts,e,n)},...t.extra&&{extra:Ht(t.extra,e,n)}};return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Ht(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(a=>({...a,...a.data&&{data:Ht(a.data,e,n)}}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=Ht(t.contexts.flags,3,n)),r}function cd(t,e){if(!e)return t;const n=t?t.clone():new Kt;return n.update(e),n}function ld(t,e){return z().captureException(t,void 0)}function jc(t,e){return z().captureEvent(t,e)}function ud(t,e){Qt().setContext(t,e)}function hd(){const t=H();return(t==null?void 0:t.getOptions().enabled)!==!1&&!!(t!=null&&t.getTransport())}function Ra(t){const e=Qt(),n=z(),{userAgent:r}=j.navigator||{},s=bh({user:n.getUser()||e.getUser(),...r&&{userAgent:r},...t}),i=e.getSession();return(i==null?void 0:i.status)==="ok"&&Ye(i,{status:"exited"}),Fc(),e.setSession(s),s}function Fc(){const t=Qt(),n=z().getSession()||t.getSession();n&&Mh(n),$c(),t.setSession()}function $c(){const t=Qt(),e=H(),n=t.getSession();n&&e&&e.captureSession(n)}function La(t=!1){if(t){Fc();return}$c()}const fd="7";function dd(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function pd(t){return`${dd(t)}${t.projectId}/envelope/`}function md(t,e){const n={sentry_version:fd};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function gd(t,e,n){return e||`${pd(t)}?${md(t,n)}`}const Oa=[];function _d(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.values(e)}function yd(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(s=>{s.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...e,...n];else if(typeof n=="function"){const s=n(e);r=Array.isArray(s)?s:[s]}else r=e;return _d(r)}function vd(t,e){const n={};return e.forEach(r=>{r&&Dc(t,r,n)}),n}function ja(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function Dc(t,e,n){if(n[e.name]){C&&P.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,!Oa.includes(e.name)&&typeof e.setupOnce=="function"&&(e.setupOnce(),Oa.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,a)=>r(i,a,t),{id:e.name});t.addEventProcessor(s)}C&&P.log(`Integration installed: ${e.name}`)}function Sd(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function Ed(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=fn(r)),Le(s,[Sd(t)])}function Uc(t,e){const n=e??bd(t)??[];if(n.length===0)return;const r=t.getOptions(),s=Ed(n,r._metadata,r.tunnel,t.getDsn());qc().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function bd(t){return qc().get(t)}function qc(){return an("clientToLogBufferMap",()=>new WeakMap)}function Md(t){return[{type:"trace_metric",item_count:t.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:t}]}function xd(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=fn(r)),Le(s,[Md(t)])}function Bc(t,e){const n=e??wd(t)??[];if(n.length===0)return;const r=t.getOptions(),s=xd(n,r._metadata,r.tunnel,t.getDsn());Hc().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(s)}function wd(t){return Hc().get(t)}function Hc(){return an("clientToMetricBufferMap",()=>new WeakMap)}const Ii=Symbol.for("SentryBufferFullError");function ki(t=100){const e=new Set;function n(){return e.size<t}function r(a){e.delete(a)}function s(a){if(!n())return Ni(Ii);const o=a();return e.add(o),o.then(()=>r(o),()=>r(o)),o}function i(a){if(!e.size)return ss(!0);const o=Promise.allSettled(Array.from(e)).then(()=>!0);if(!a)return o;const c=[o,new Promise(l=>setTimeout(()=>l(!1),a))];return Promise.race(c)}return{get $(){return Array.from(e)},add:s,drain:i}}const Pd=60*1e3;function Td(t,e=Bn()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Pd:r-e}function Nd(t,e){return t[e]||t.all||0}function Id(t,e,n=Bn()){return Nd(t,e)>n}function kd(t,{statusCode:e,headers:n},r=Bn()){const s={...t},i=n==null?void 0:n["x-sentry-rate-limits"],a=n==null?void 0:n["retry-after"];if(i)for(const o of i.trim().split(",")){const[c,l,,,h]=o.split(":",5),u=parseInt(c,10),f=(isNaN(u)?60:u)*1e3;if(!l)s.all=r+f;else for(const d of l.split(";"))d==="metric_bucket"?(!h||h.split(";").includes("custom"))&&(s[d]=r+f):s[d]=r+f}else a?s.all=r+Td(a,r):e===429&&(s.all=r+60*1e3);return s}const Wc=64;function Cd(t,e,n=ki(t.bufferSize||Wc)){let r={};const s=a=>n.drain(a);function i(a){const o=[];if(Us(a,(u,f)=>{const d=Ma(f);Id(r,d)?t.recordDroppedEvent("ratelimit_backoff",d):o.push(u)}),o.length===0)return Promise.resolve({});const c=Le(a[0],o),l=u=>{if(Sf(c,["client_report"])){C&&P.warn(`Dropping client report. Will not send outcomes (reason: ${u}).`);return}Us(c,(f,d)=>{t.recordDroppedEvent(u,Ma(d))})},h=()=>e({body:Ef(c)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&C&&P.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),r=kd(r,u),u),u=>{throw l("network_error"),C&&P.error("Encountered error running transport request:",u),u});return n.add(h).then(u=>u,u=>{if(u===Ii)return C&&P.error("Skipped sending event because buffer is full."),l("queue_overflow"),Promise.resolve({});throw u})}return{send:i,flush:s}}function Ad(t,e,n){const r=[{type:"client_report"},{timestamp:Re(),discarded_events:t}];return Le(e?{dsn:e}:{},[r])}function zc(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch{}return e}function Gd(t){var c;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:a,op:o}=((c=t.contexts)==null?void 0:c.trace)??{};return{data:a??{},description:t.transaction,op:o,parent_span_id:n,span_id:r??"",start_timestamp:t.start_timestamp??0,status:s,timestamp:t.timestamp,trace_id:e??"",origin:i,profile_id:a==null?void 0:a[Ei],exclusive_time:a==null?void 0:a[hn],measurements:t.measurements,is_segment:!0}}function Rd(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:{...t.data,...t.profile_id&&{[Ei]:t.profile_id},...t.exclusive_time&&{[hn]:t.exclusive_time}}}},measurements:t.measurements}}const Fa="Not capturing exception because it's already been captured.",$a="Discarded session because of missing or non-string release",Vc=Symbol.for("SentryInternalError"),Jc=Symbol.for("SentryDoNotSendEventError"),Ld=5e3;function Pr(t){return{message:t,[Vc]:!0}}function gs(t){return{message:t,[Jc]:!0}}function Da(t){return!!t&&typeof t=="object"&&Vc in t}function Ua(t){return!!t&&typeof t=="object"&&Jc in t}function qa(t,e,n,r,s){let i=0,a,o=!1;t.on(n,()=>{i=0,clearTimeout(a),o=!1}),t.on(e,c=>{i+=r(c),i>=8e5?s(t):o||(o=!0,a=setTimeout(()=>{s(t)},Ld))}),t.on("flush",()=>{s(t)})}class Od{constructor(e){var r,s,i;if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=ki(((r=e.transportOptions)==null?void 0:r.bufferSize)??Wc),e.dsn?this._dsn=Zh(e.dsn):C&&P.warn("No DSN provided, client will not send events."),this._dsn){const a=gd(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:a})}this._options.enableLogs=this._options.enableLogs??((s=this._options._experiments)==null?void 0:s.enableLogs),this._options.enableLogs&&qa(this,"afterCaptureLog","flushLogs",Dd,Uc),(this._options.enableMetrics??((i=this._options._experiments)==null?void 0:i.enableMetrics)??!0)&&qa(this,"afterCaptureMetric","flushMetrics",$d,Bc)}captureException(e,n,r){const s=Tt();if(pa(e))return C&&P.log(Fa),s;const i={event_id:s,...n};return this._process(()=>this.eventFromException(e,i).then(a=>this._captureEvent(a,i,r)).then(a=>a),"error"),i.event_id}captureMessage(e,n,r,s){const i={event_id:Tt(),...r},a=gi(e)?e:String(e),o=Xe(e),c=o?this.eventFromMessage(a,n,i):this.eventFromException(e,i);return this._process(()=>c.then(l=>this._captureEvent(l,i,s)),o?"unknown":"error"),i.event_id}captureEvent(e,n,r){const s=Tt();if(n!=null&&n.originalException&&pa(n.originalException))return C&&P.log(Fa),s;const i={event_id:s,...n},a=e.sdkProcessingMetadata||{},o=a.capturedSpanScope,c=a.capturedSpanIsolationScope,l=Ba(e.type);return this._process(()=>this._captureEvent(e,i,o||r,c),l),i.event_id}captureSession(e){this.sendSession(e),Ye(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}async flush(e){const n=this._transport;if(!n)return!0;this.emit("flush");const r=await this._isClientDoneProcessing(e),s=await n.flush(e);return r&&s}async close(e){const n=await this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),n}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];Dc(this,e,this._integrations),n||ja(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=If(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=vf(r,xf(s));this.sendEnvelope(r).then(s=>this.emit("afterSendEvent",e,s))}sendSession(e){const{release:n,environment:r=wi}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){C&&P.warn($a);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){C&&P.warn($a);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=Nf(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;C&&P.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||new Set,s=(...i)=>n(...i);return r.add(s),()=>{r.delete(s)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}async sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return await this._transport.send(e)}catch(n){return C&&P.error("Error while sending envelope:",n),{}}return C&&P.error("Transport disabled"),{}}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=vd(this,e),ja(this,e)}_updateSessionFromEvent(e,n){var c,l;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0,r=!1;for(const h of i)if(((l=h.mechanism)==null?void 0:l.handled)===!1){r=!0;break}}const a=e.status==="ok";(a&&e.errors===0||a&&r)&&(Ye(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}async _isClientDoneProcessing(e){let n=0;for(;!e||n<e;){if(await new Promise(r=>setTimeout(r,1)),!this._numProcessing)return!0;n++}return!1}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),a=Object.keys(this._integrations);return!n.integrations&&(a!=null&&a.length)&&(n.integrations=a),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),nd(i,e,n,r,this,s).then(o=>{if(o===null)return o;this.emit("postprocessEvent",o,n),o.contexts={trace:Gh(r),...o.contexts};const c=Ic(this,r);return o.sdkProcessingMetadata={dynamicSamplingContext:c,...o.sdkProcessingMetadata},o})}_captureEvent(e,n={},r=z(),s=Qt()){return C&&Hs(e)&&P.log(`Captured error event \`${zc(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{C&&(Ua(i)?P.log(i.message):Da(i)?P.warn(i.message):P.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:a}=i,o=Xc(e),c=Hs(e),h=`before send for type \`${e.type||"error"}\``,u=typeof a>"u"?void 0:An(a);if(c&&typeof u=="number"&&ie()>u)return this.recordDroppedEvent("sample_rate","error"),Ni(gs(`Discarding event because it's not included in the random sample (sampling rate = ${a})`));const f=Ba(e.type);return this._prepareEvent(e,n,r,s).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",f),gs("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return d;const _=Fd(this,i,d,n);return jd(_,h)}).then(d=>{var m;if(d===null){if(this.recordDroppedEvent("before_send",f),o){const S=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",S)}throw gs(`${h} returned \`null\`, will not send event.`)}const p=r.getSession()||s.getSession();if(c&&p&&this._updateSessionFromEvent(p,d),o){const y=((m=d.sdkProcessingMetadata)==null?void 0:m.spanCountBeforeProcessing)||0,S=d.spans?d.spans.length:0,M=y-S;M>0&&this.recordDroppedEvent("before_send","span",M)}const _=d.transaction_info;if(o&&_&&d.transaction!==e.transaction){const y="custom";d.transaction_info={..._,source:y}}return this.sendEvent(d,n),d}).then(null,d=>{throw Ua(d)||Da(d)?d:(this.captureException(d,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:d}),Pr(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(e,n){this._numProcessing++,this._promiseBuffer.add(e).then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r===Ii&&this.recordDroppedEvent("queue_overflow",n),r))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){C&&P.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){C&&P.log("No outcomes to send");return}if(!this._dsn){C&&P.log("No dsn provided, will not send outcomes");return}C&&P.log("Sending outcomes:",e);const n=Ad(e,this._options.tunnel&&fn(this._dsn));this.sendEnvelope(n)}}function Ba(t){return t==="replay_event"?"replay":t||"error"}function jd(t,e){const n=`${e} must return \`null\` or a valid event.`;if(ln(t))return t.then(r=>{if(!kn(r)&&r!==null)throw Pr(n);return r},r=>{throw Pr(`${e} rejected with ${r}`)});if(!kn(t)&&t!==null)throw Pr(n);return t}function Fd(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:a,ignoreSpans:o}=e;let c=n;if(Hs(c)&&s)return s(c,r);if(Xc(c)){if(a||o){const l=Gd(c);if(o!=null&&o.length&&$r(l,o))return null;if(a){const h=a(l);h?c=Hn(n,Rd(h)):$s()}if(c.spans){const h=[],u=c.spans;for(const d of u){if(o!=null&&o.length&&$r(d,o)){ff(u,d);continue}if(a){const p=a(d);p?h.push(p):($s(),h.push(d))}else h.push(d)}const f=c.spans.length-h.length;f&&t.recordDroppedEvent("before_send","span",f),c.spans=h}}if(i){if(c.spans){const l=c.spans.length;c.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return i(c,r)}}return c}function Hs(t){return t.type===void 0}function Xc(t){return t.type==="transaction"}function $d(t){let e=0;return t.name&&(e+=t.name.length*2),e+=8,e+Kc(t.attributes)}function Dd(t){let e=0;return t.message&&(e+=t.message.length*2),e+Kc(t.attributes)}function Kc(t){if(!t)return 0;let e=0;return Object.values(t).forEach(n=>{Array.isArray(n)?e+=n.length*Ha(n[0]):Xe(n)?e+=Ha(n):e+=100}),e}function Ha(t){return typeof t=="string"?t.length*2:typeof t=="number"?8:typeof t=="boolean"?4:0}function Ud(t){return ts(t)&&"__sentry_fetch_url_host__"in t&&typeof t.__sentry_fetch_url_host__=="string"}function Wa(t){return Ud(t)?`${t.message} (${t.__sentry_fetch_url_host__})`:t.message}function qd(t,e){e.debug===!0&&(C?P.enable():on(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),z().update(e.initialScope);const r=new t(e);return Bd(r),r.init(),r}function Bd(t){z().setClient(t)}const Hd="thismessage:/";function Yc(t){return"isRelative"in t}function Qc(t,e){const n=t.indexOf("://")<=0&&t.indexOf("//")!==0,r=n?Hd:void 0;try{if("canParse"in URL&&!URL.canParse(t,r))return;const s=new URL(t,r);return n?{isRelative:n,pathname:s.pathname,search:s.search,hash:s.hash}:s}catch{}}function Wd(t){if(Yc(t))return t.pathname;const e=new URL(t);return e.search="",e.hash="",["80","443"].includes(e.port)&&(e.port=""),e.password&&(e.password="%filtered%"),e.username&&(e.username="%filtered%"),e.toString()}function Ne(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function zd(t){return t.split(/[?#]/,1)[0]}function oe(t,e=!0){if(t.startsWith("data:")){const n=t.match(/^data:([^;,]+)/),r=n?n[1]:"text/plain",s=t.includes(";base64,"),i=t.indexOf(",");let a="";if(e&&i!==-1){const o=t.slice(i+1);a=o.length>10?`${o.slice(0,10)}... [truncated]`:o}return`data:${r}${s?",base64":""}${a?`,${a}`:""}`}return t}function Vd(t){var e;"aggregates"in t?((e=t.attrs)==null?void 0:e.ip_address)===void 0&&(t.attrs={...t.attrs,ip_address:"{{auto}}"}):t.ipAddress===void 0&&(t.ipAddress="{{auto}}")}function Zc(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:we})),version:we}),t._metadata=s}function tl(t={}){const e=t.client||H();if(!hd()||!e)return{};const n=Ge(),r=un(n);if(r.getTraceData)return r.getTraceData(t);const s=t.scope||z(),i=t.span||Mt(),a=i?af(i):Jd(s),o=i?ue(i):Ic(e,s),c=Bh(o);if(!Sc.test(a))return P.warn("Invalid sentry-trace data. Cannot generate trace data"),{};const h={"sentry-trace":a,baggage:c};return t.propagateTraceparent&&(h.traceparent=i?of(i):Xd(s)),h}function Jd(t){const{traceId:e,sampled:n,propagationSpanId:r}=t.getPropagationContext();return Ec(e,r,n)}function Xd(t){const{traceId:e,sampled:n,propagationSpanId:r}=t.getPropagationContext();return bc(e,r,n)}const Kd=100;function ke(t,e){const n=H(),r=Qt();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=Kd}=n.getOptions();if(i<=0)return;const o={timestamp:Re(),...t},c=s?on(()=>s(o,e)):o;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let za;const Yd="FunctionToString",Va=new WeakMap,Qd=(()=>({name:Yd,setupOnce(){za=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=vi(this),n=Va.has(H())&&e!==void 0?e:this;return za.apply(n,t)}}catch{}},setup(t){Va.set(t,!0)}})),Zd=Qd,t0=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],e0="EventFilters",n0=(t={})=>{let e;return{name:e0,setup(n){const r=n.getOptions();e=Ja(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=Ja(t,i)}return s0(n,e)?null:n}}},r0=((t={})=>({...n0(t),name:"InboundFilters"}));function Ja(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:t0],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function s0(t,e){if(t.type){if(t.type==="transaction"&&a0(t,e.ignoreTransactions))return C&&P.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${be(t)}`),!0}else{if(i0(t,e.ignoreErrors))return C&&P.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${be(t)}`),!0;if(u0(t))return C&&P.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${be(t)}`),!0;if(o0(t,e.denyUrls))return C&&P.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${be(t)}.
Url: ${Dr(t)}`),!0;if(!c0(t,e.allowUrls))return C&&P.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${be(t)}.
Url: ${Dr(t)}`),!0}return!1}function i0(t,e){return e!=null&&e.length?zc(t).some(n=>ae(n,e)):!1}function a0(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?ae(n,e):!1}function o0(t,e){if(!(e!=null&&e.length))return!1;const n=Dr(t);return n?ae(n,e):!1}function c0(t,e){if(!(e!=null&&e.length))return!0;const n=Dr(t);return n?ae(n,e):!0}function l0(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Dr(t){var e,n;try{const r=[...((e=t.exception)==null?void 0:e.values)??[]].reverse().find(i=>{var a,o,c;return((a=i.mechanism)==null?void 0:a.parent_id)===void 0&&((c=(o=i.stacktrace)==null?void 0:o.frames)==null?void 0:c.length)}),s=(n=r==null?void 0:r.stacktrace)==null?void 0:n.frames;return s?l0(s):null}catch{return C&&P.error(`Cannot extract url for event ${be(t)}`),null}}function u0(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}function h0(t,e,n,r,s,i){var o;if(!((o=s.exception)!=null&&o.values)||!i||!Jt(i.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=Ws(t,e,r,i.originalException,n,s.exception.values,a,0))}function Ws(t,e,n,r,s,i,a,o){if(i.length>=n+1)return i;let c=[...i];if(Jt(r[s],Error)){Xa(a,o);const l=t(e,r[s]),h=c.length;Ka(l,s,h,o),c=Ws(t,e,n,r[s],s,[l,...c],l,h)}return Array.isArray(r.errors)&&r.errors.forEach((l,h)=>{if(Jt(l,Error)){Xa(a,o);const u=t(e,l),f=c.length;Ka(u,`errors[${h}]`,f,o),c=Ws(t,e,n,l,s,[u,...c],u,f)}}),c}function Xa(t,e){t.mechanism={handled:!0,type:"auto.core.linked_errors",...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Ka(t,e,n,r){t.mechanism={handled:!0,...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function f0(t){const e="console";ge(e,t),_e(e,d0)}function d0(){"console"in j&&Zu.forEach(function(t){t in j.console&&Et(j.console,t,function(e){return Or[t]=e,function(...n){Pt("console",{args:n,level:t});const s=Or[t];s==null||s.apply(j.console,n)}})})}function p0(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const m0="Dedupe",g0=(()=>{let t;return{name:m0,processEvent(e){if(e.type)return e;try{if(y0(e,t))return C&&P.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}}),_0=g0;function y0(t,e){return e?!!(v0(t,e)||S0(t,e)):!1}function v0(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!nl(t,e)||!el(t,e))}function S0(t,e){const n=Ya(e),r=Ya(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!nl(t,e)||!el(t,e))}function el(t,e){let n=ca(t),r=ca(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],a=n[s];if(i.filename!==a.filename||i.lineno!==a.lineno||i.colno!==a.colno||i.function!==a.function)return!1}return!0}function nl(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function Ya(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}const E0="ConversationId",b0=(()=>({name:E0,setup(t){t.on("spanStart",e=>{const n=z().getScopeData(),r=Qt().getScopeData(),s=n.conversationId||r.conversationId;s&&e.setAttribute(Lh,s)})}})),M0=b0;function x0(t,e,n,r,s){if(!t.fetchData)return;const{method:i,url:a}=t.fetchData,o=Ot()&&e(a);if(t.endTimestamp&&o){const d=t.fetchData.__span;if(!d)return;const p=r[d];p&&(T0(p,t),w0(p,t,s),delete r[d]);return}const{spanOrigin:c="auto.http.browser",propagateTraceparent:l=!1}=typeof s=="object"?s:{spanOrigin:s},h=!!Mt(),u=o&&h?dn(I0(a,i,c)):new he;if(t.fetchData.__span=u.spanContext().spanId,r[u.spanContext().spanId]=u,n(t.fetchData.url)){const d=t.args[0],p={...t.args[1]||{}},_=P0(d,p,Ot()&&h?u:void 0,l);_&&(t.args[1]=p,p.headers=_)}const f=H();if(f){const d={input:t.args,response:t.response,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp};f.emit("beforeOutgoingRequestSpan",u,d)}return u}function w0(t,e,n){var s;const r=typeof n=="object"&&n!==null?n.onRequestSpanEnd:void 0;r==null||r(t,{headers:(s=e.response)==null?void 0:s.headers,error:e.error})}function P0(t,e,n,r){const s=tl({span:n,propagateTraceparent:r}),i=s["sentry-trace"],a=s.baggage,o=s.traceparent;if(!i)return;const c=e.headers||(_i(t)?t.headers:void 0);if(c)if(N0(c)){const l=new Headers(c);if(l.get("sentry-trace")||l.set("sentry-trace",i),r&&o&&!l.get("traceparent")&&l.set("traceparent",o),a){const h=l.get("baggage");h?hr(h)||l.set("baggage",`${h},${a}`):l.set("baggage",a)}return l}else if(Array.isArray(c)){const l=[...c];c.find(u=>u[0]==="sentry-trace")||l.push(["sentry-trace",i]),r&&o&&!c.find(u=>u[0]==="traceparent")&&l.push(["traceparent",o]);const h=c.find(u=>u[0]==="baggage"&&hr(u[1]));return a&&!h&&l.push(["baggage",a]),l}else{const l="sentry-trace"in c?c["sentry-trace"]:void 0,h="traceparent"in c?c.traceparent:void 0,u="baggage"in c?c.baggage:void 0,f=u?Array.isArray(u)?[...u]:[u]:[],d=u&&(Array.isArray(u)?u.find(_=>hr(_)):hr(u));a&&!d&&f.push(a);const p={...c,"sentry-trace":l??i,baggage:f.length>0?f.join(","):void 0};return r&&o&&!h&&(p.traceparent=o),p}else return{...s}}function T0(t,e){var n,r;if(e.response){mc(t,e.response.status);const s=(r=(n=e.response)==null?void 0:n.headers)==null?void 0:r.get("content-length");if(s){const i=parseInt(s);i>0&&t.setAttribute("http.response_content_length",i)}}else e.error&&t.setStatus({code:nt,message:"internal_error"});t.end()}function hr(t){return t.split(",").some(e=>e.trim().startsWith(Mi))}function N0(t){return typeof Headers<"u"&&Jt(t,Headers)}function I0(t,e,n){if(t.startsWith("data:")){const i=oe(t);return{name:`${e} ${i}`,attributes:Qa(t,void 0,e,n)}}const r=Qc(t),s=r?Wd(r):t;return{name:`${e} ${s}`,attributes:Qa(t,r,e,n)}}function Qa(t,e,n,r){const s={url:oe(t),type:"fetch","http.method":n,[rt]:r,[Yt]:"http.client"};return e&&(Yc(e)||(s["http.url"]=oe(e.href),s["server.address"]=e.host),e.search&&(s["http.query"]=e.search),e.hash&&(s["http.fragment"]=e.hash)),s}function rl(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const Rn=j;function k0(){return"history"in Rn&&!!Rn.history}function C0(){if(!("fetch"in Rn))return!1;try{return new Headers,new Request("data:,"),new Response,!0}catch{return!1}}function zs(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function A0(){var n;if(typeof EdgeRuntime=="string")return!0;if(!C0())return!1;if(zs(Rn.fetch))return!0;let t=!1;const e=Rn.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),(n=r.contentWindow)!=null&&n.fetch&&(t=zs(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){C&&P.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function sl(t,e){const n="fetch";ge(n,t),_e(n,()=>il(void 0,e))}function G0(t){const e="fetch-body-resolved";ge(e,t),_e(e,()=>il(L0))}function il(t,e=!1){e&&!A0()||Et(j,"fetch",function(n){return function(...r){const s=new Error,{method:i,url:a}=O0(r),o={args:r,fetchData:{method:i,url:a},startTimestamp:st()*1e3,virtualError:s,headers:j0(r)};return t||Pt("fetch",{...o}),n.apply(j,r).then(async c=>(t?t(c):Pt("fetch",{...o,endTimestamp:st()*1e3,response:c}),c),c=>{Pt("fetch",{...o,endTimestamp:st()*1e3,error:c}),ts(c)&&c.stack===void 0&&(c.stack=s.stack,gt(c,"framesToPop",1));const l=H(),h=(l==null?void 0:l.getOptions().enhanceFetchErrorMessages)??"always";if(h!==!1&&c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const d=new URL(o.fetchData.url).host;h==="always"?c.message=`${c.message} (${d})`:gt(c,"__sentry_fetch_url_host__",d)}catch{}throw c})}})}async function R0(t,e){if(t!=null&&t.body){const n=t.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},90*1e3);let i=!0;for(;i;){let a;try{a=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:o}=await r.read();clearTimeout(a),o&&(e(),i=!1)}catch{i=!1}finally{clearTimeout(a)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}function L0(t){let e;try{e=t.clone()}catch{return}R0(e,()=>{Pt("fetch-body-resolved",{endTimestamp:st()*1e3,response:t})})}function Tr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Za(t){return typeof t=="string"?t:t?Tr(t,"url")?t.url:t.toString?t.toString():"":""}function O0(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:Za(n),method:Tr(r,"method")?String(r.method).toUpperCase():_i(n)&&Tr(n,"method")?String(n.method).toUpperCase():"GET"}}const e=t[0];return{url:Za(e),method:Tr(e,"method")?String(e.method).toUpperCase():"GET"}}function j0(t){const[e,n]=t;try{if(typeof n=="object"&&n!==null&&"headers"in n&&n.headers)return new Headers(n.headers);if(_i(e))return new Headers(e.headers)}catch{}}function F0(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function $0(){return"npm"}function D0(){return!F0()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function U0(){return typeof window<"u"&&(!D0()||q0())}function q0(){const t=j.process;return(t==null?void 0:t.type)==="renderer"}const $=j;let Vs=0;function al(){return Vs>0}function B0(){Vs++,setTimeout(()=>{Vs--})}function tn(t,e={}){function n(s){return typeof s=="function"}if(!n(t))return t;try{const s=t.__sentry_wrapped__;if(s)return typeof s=="function"?s:t;if(vi(t))return t}catch{return t}const r=function(...s){try{const i=s.map(a=>tn(a,e));return t.apply(this,i)}catch(i){throw B0(),ns(a=>{a.addEventProcessor(o=>(e.mechanism&&(Os(o,void 0),Ke(o,e.mechanism)),o.extra={...o.extra,arguments:s},o)),ld(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}uc(r,t),gt(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}function Ci(){const t=Un(),{referrer:e}=$.document||{},{userAgent:n}=$.navigator||{},r={...e&&{Referer:e},...n&&{"User-Agent":n}};return{url:t,headers:r}}function Ai(t,e){const n=Gi(t,e),r={type:J0(e),value:X0(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function H0(t,e,n,r){const s=H(),i=s==null?void 0:s.getOptions().normalizeDepth,a=tp(e),o={__serialized__:kc(e,i)};if(a)return{exception:{values:[Ai(t,a)]},extra:o};const c={exception:{values:[{type:es(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:Q0(e,{isUnhandledRejection:r})}]},extra:o};if(n){const l=Gi(t,n);l.length&&(c.exception.values[0].stacktrace={frames:l})}return c}function _s(t,e){return{exception:{values:[Ai(t,e)]}}}function Gi(t,e){const n=e.stacktrace||e.stack||"",r=z0(e),s=V0(e);try{return t(n,r,s)}catch{}return[]}const W0=/Minified React error #\d+;/i;function z0(t){return t&&W0.test(t.message)?1:0}function V0(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function ol(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function J0(t){const e=t==null?void 0:t.name;return!e&&ol(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function X0(t){const e=t==null?void 0:t.message;return ol(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?Wa(e.error):Wa(t):"No error message"}function K0(t,e,n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=Ri(t,e,s,r);return Ke(i),i.level="error",n!=null&&n.event_id&&(i.event_id=n.event_id),ss(i)}function Y0(t,e,n="info",r,s){const i=(r==null?void 0:r.syntheticException)||void 0,a=Js(t,e,i,s);return a.level=n,r!=null&&r.event_id&&(a.event_id=r.event_id),ss(a)}function Ri(t,e,n,r,s){let i;if(oc(e)&&e.error)return _s(t,e.error);if(ua(e)||uh(e)){const a=e;if("stack"in e)i=_s(t,e);else{const o=a.name||(ua(a)?"DOMError":"DOMException"),c=a.message?`${o}: ${a.message}`:o;i=Js(t,c,n,r),Os(i,c)}return"code"in a&&(i.tags={...i.tags,"DOMException.code":`${a.code}`}),i}return ts(e)?_s(t,e):kn(e)||es(e)?(i=H0(t,e,n,s),Ke(i,{synthetic:!0}),i):(i=Js(t,e,n,r),Os(i,`${e}`),Ke(i,{synthetic:!0}),i)}function Js(t,e,n,r){const s={};if(r&&n){const i=Gi(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]}),Ke(s,{synthetic:!0})}if(gi(e)){const{__sentry_template_string__:i,__sentry_template_values__:a}=e;return s.logentry={message:i,params:a},s}return s.message=e,s}function Q0(t,{isUnhandledRejection:e}){const n=gh(t),r=e?"promise rejection":"exception";return oc(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:es(t)?`Event \`${Z0(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function Z0(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function tp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}class ep extends Od{constructor(e){var h;const n=np(e),r=$.SENTRY_SDK_SOURCE||$0();Zc(n,"browser",["browser"],r),(h=n._metadata)!=null&&h.sdk&&(n._metadata.sdk.settings={infer_ip:n.sendDefaultPii?"auto":"never",...n._metadata.sdk.settings}),super(n);const{sendDefaultPii:s,sendClientReports:i,enableLogs:a,_experiments:o,enableMetrics:c}=this._options,l=c??(o==null?void 0:o.enableMetrics)??!0;$.document&&(i||a||l)&&$.document.addEventListener("visibilitychange",()=>{$.document.visibilityState==="hidden"&&(i&&this._flushOutcomes(),a&&Uc(this),l&&Bc(this))}),s&&this.on("beforeSendSession",Vd)}eventFromException(e,n){return K0(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return Y0(this._options.stackParser,e,n,r,this._options.attachStacktrace)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r,s)}}function np(t){return{release:"260fa3e5ce5cc77737d8e6de0ffd761a64f27bcf",sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...t}}const Vn=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,R=j,rp=(t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good",Jn=(t,e,n,r)=>{let s,i;return a=>{e.value>=0&&(a||r)&&(i=e.value-(s??0),(i||s===void 0)&&(s=e.value,e.delta=i,e.rating=rp(e.value,n),t(e)))}},Xn=(t=!0)=>{var n,r;const e=(r=(n=R.performance)==null?void 0:n.getEntriesByType)==null?void 0:r.call(n,"navigation")[0];if(!t||e&&e.responseStart>0&&e.responseStart<performance.now())return e},pn=()=>{const t=Xn();return(t==null?void 0:t.activationStart)??0};function ce(t,e,n){R.document&&R.addEventListener(t,e,n)}function Ur(t,e,n){R.document&&R.removeEventListener(t,e,n)}let ze=-1;const cl=new Set,sp=()=>{var t,e;return((t=R.document)==null?void 0:t.visibilityState)==="hidden"&&!((e=R.document)!=null&&e.prerendering)?0:1/0},Nr=t=>{if(ip(t)&&ze>-1){if(t.type==="visibilitychange"||t.type==="pagehide")for(const e of cl)e();isFinite(ze)||(ze=t.type==="visibilitychange"?t.timeStamp:0,Ur("prerenderingchange",Nr,!0))}},Kn=()=>{var t;if(R.document&&ze<0){const e=pn();ze=(R.document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>e)[0])==null?void 0:t.startTime)??sp(),ce("visibilitychange",Nr,!0),ce("pagehide",Nr,!0),ce("prerenderingchange",Nr,!0)}return{get firstHiddenTime(){return ze},onHidden(e){cl.add(e)}}};function ip(t){var e;return t.type==="pagehide"||((e=R.document)==null?void 0:e.visibilityState)==="hidden"}const ap=()=>`v5-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,Yn=(t,e=-1)=>{var i,a;const n=Xn();let r="navigate";return n&&((i=R.document)!=null&&i.prerendering||pn()>0?r="prerender":(a=R.document)!=null&&a.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:ap(),navigationType:r}},ys=new WeakMap;function Li(t,e){try{return ys.get(t)||ys.set(t,new e),ys.get(t)}catch{return new e}}class qr{constructor(){qr.prototype.__init.call(this),qr.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){var s;if(e.hadRecentInput)return;const n=this._sessionEntries[0],r=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),(s=this._onAfterProcessingUnexpectedShift)==null||s.call(this,e)}}const mn=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(s=>{Promise.resolve().then(()=>{e(s.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},Oi=t=>{let e=!1;return()=>{e||(t(),e=!0)}},is=t=>{var e;(e=R.document)!=null&&e.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},op=[1800,3e3],cp=(t,e={})=>{is(()=>{const n=Kn(),r=Yn("FCP");let s;const a=mn("paint",o=>{for(const c of o)c.name==="first-contentful-paint"&&(a.disconnect(),c.startTime<n.firstHiddenTime&&(r.value=Math.max(c.startTime-pn(),0),r.entries.push(c),s(!0)))});a&&(s=Jn(t,r,op,e.reportAllChanges))})},lp=[.1,.25],up=(t,e={})=>{cp(Oi(()=>{var c;const n=Yn("CLS",0);let r;const s=Kn(),i=Li(e,qr),a=l=>{for(const h of l)i._processEntry(h);i._sessionValue>n.value&&(n.value=i._sessionValue,n.entries=i._sessionEntries,r())},o=mn("layout-shift",a);o&&(r=Jn(t,n,lp,e.reportAllChanges),s.onHidden(()=>{a(o.takeRecords()),r(!0)}),(c=R==null?void 0:R.setTimeout)==null||c.call(R,r))}))};let ll=0,vs=1/0,fr=0;const hp=t=>{t.forEach(e=>{e.interactionId&&(vs=Math.min(vs,e.interactionId),fr=Math.max(fr,e.interactionId),ll=fr?(fr-vs)/7+1:0)})};let Xs;const ul=()=>Xs?ll:performance.interactionCount||0,fp=()=>{"interactionCount"in performance||Xs||(Xs=mn("event",hp,{type:"event",buffered:!0,durationThreshold:0}))},Ss=10;let hl=0;const dp=()=>ul()-hl;class Br{constructor(){Br.prototype.__init.call(this),Br.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){hl=ul(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor(dp()/50));return this._longestInteractionList[e]}_processEntry(e){var s,i;if((s=this._onBeforeProcessingEntry)==null||s.call(this,e),!(e.interactionId||e.entryType==="first-input"))return;const n=this._longestInteractionList.at(-1);let r=this._longestInteractionMap.get(e.interactionId);if(r||this._longestInteractionList.length<Ss||e.duration>n._latency){if(r?e.duration>r._latency?(r.entries=[e],r._latency=e.duration):e.duration===r._latency&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(r.id,r),this._longestInteractionList.push(r)),this._longestInteractionList.sort((a,o)=>o._latency-a._latency),this._longestInteractionList.length>Ss){const a=this._longestInteractionList.splice(Ss);for(const o of a)this._longestInteractionMap.delete(o.id)}(i=this._onAfterProcessingINPCandidate)==null||i.call(this,r)}}}const fl=t=>{var n;const e=R.requestIdleCallback||R.setTimeout;((n=R.document)==null?void 0:n.visibilityState)==="hidden"?t():(t=Oi(t),ce("visibilitychange",t,{once:!0,capture:!0}),ce("pagehide",t,{once:!0,capture:!0}),e(()=>{t(),Ur("visibilitychange",t,{capture:!0}),Ur("pagehide",t,{capture:!0})}))},pp=[200,500],mp=40,gp=(t,e={})=>{if(!(globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype))return;const n=Kn();is(()=>{fp();const r=Yn("INP");let s;const i=Li(e,Br),a=c=>{fl(()=>{for(const h of c)i._processEntry(h);const l=i._estimateP98LongestInteraction();l&&l._latency!==r.value&&(r.value=l._latency,r.entries=l.entries,s())})},o=mn("event",a,{durationThreshold:e.durationThreshold??mp});s=Jn(t,r,pp,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{a(o.takeRecords()),s(!0)}))})};class _p{_processEntry(e){var n;(n=this._onBeforeProcessingEntry)==null||n.call(this,e)}}const yp=[2500,4e3],vp=(t,e={})=>{is(()=>{const n=Kn(),r=Yn("LCP");let s;const i=Li(e,_p),a=c=>{e.reportAllChanges||(c=c.slice(-1));for(const l of c)i._processEntry(l),l.startTime<n.firstHiddenTime&&(r.value=Math.max(l.startTime-pn(),0),r.entries=[l],s())},o=mn("largest-contentful-paint",a);if(o){s=Jn(t,r,yp,e.reportAllChanges);const c=Oi(()=>{a(o.takeRecords()),o.disconnect(),s(!0)}),l=h=>{h.isTrusted&&(fl(c),Ur(h.type,l,{capture:!0}))};for(const h of["keydown","click","visibilitychange"])ce(h,l,{capture:!0})}})},Sp=[800,1800],Ks=t=>{var e,n;(e=R.document)!=null&&e.prerendering?is(()=>Ks(t)):((n=R.document)==null?void 0:n.readyState)!=="complete"?addEventListener("load",()=>Ks(t),!0):setTimeout(t)},Ep=(t,e={})=>{const n=Yn("TTFB"),r=Jn(t,n,Sp,e.reportAllChanges);Ks(()=>{const s=Xn();s&&(n.value=Math.max(s.responseStart-pn(),0),n.entries=[s],r(!0))})},xn={},Hr={};let dl,pl,ml,gl;function _l(t,e=!1){return as("cls",t,xp,dl,e)}function yl(t,e=!1){return as("lcp",t,wp,pl,e)}function bp(t){return as("ttfb",t,Pp,ml)}function Mp(t){return as("inp",t,Tp,gl)}function en(t,e){return vl(t,e),Hr[t]||(Np(t),Hr[t]=!0),Sl(t,e)}function Qn(t,e){const n=xn[t];if(n!=null&&n.length)for(const r of n)try{r(e)}catch(s){Vn&&P.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Vt(r)}
Error:`,s)}}function xp(){return up(t=>{Qn("cls",{metric:t}),dl=t},{reportAllChanges:!0})}function wp(){return vp(t=>{Qn("lcp",{metric:t}),pl=t},{reportAllChanges:!0})}function Pp(){return Ep(t=>{Qn("ttfb",{metric:t}),ml=t})}function Tp(){return gp(t=>{Qn("inp",{metric:t}),gl=t})}function as(t,e,n,r,s=!1){vl(t,e);let i;return Hr[t]||(i=n(),Hr[t]=!0),r&&e({metric:r}),Sl(t,e,s?i:void 0)}function Np(t){const e={};t==="event"&&(e.durationThreshold=0),mn(t,n=>{Qn(t,{entries:n})},e)}function vl(t,e){xn[t]=xn[t]||[],xn[t].push(e)}function Sl(t,e,n){return()=>{n&&n();const r=xn[t];if(!r)return;const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}function Ip(t){return"duration"in t}const kp=t=>{const e=n=>{var r;(n.type==="pagehide"||((r=R.document)==null?void 0:r.visibilityState)==="hidden")&&t(n)};ce("visibilitychange",e,{capture:!0,once:!0}),ce("pagehide",e,{capture:!0,once:!0})};function Es(t){return typeof t=="number"&&isFinite(t)}function fe(t,e,n,{...r}){const s=D(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),Pi(t,()=>{const i=dn({startTime:e,...r});return i&&i.end(n),i})}function ji(t){var m;const e=H();if(!e)return;const{name:n,transaction:r,attributes:s,startTime:i}=t,{release:a,environment:o,sendDefaultPii:c}=e.getOptions(),l=e.getIntegrationByName("Replay"),h=l==null?void 0:l.getReplayId(),u=z(),f=u.getUser(),d=f!==void 0?f.email||f.id||f.ip_address:void 0;let p;try{p=u.getScopeData().contexts.profile.profile_id}catch{}const _={release:a,environment:o,user:d||void 0,profile_id:p||void 0,replay_id:h||void 0,transaction:r,"user_agent.original":(m=R.navigator)==null?void 0:m.userAgent,"client.address":c?"{{auto}}":void 0,...s};return dn({name:n,attributes:_,startTime:i,experimental:{standalone:!0}})}function Zn(){return R.addEventListener&&R.performance}function Z(t){return t/1e3}function Cp(t){let e="unknown",n="unknown",r="";for(const s of t){if(s==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(s))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=s}return r===t&&(e=r),{name:e,version:n}}function El(t){try{return PerformanceObserver.supportedEntryTypes.includes(t)}catch{return!1}}function bl(t,e){let n,r=!1;function s(o){!r&&n&&e(o,n),r=!0}kp(()=>{s("pagehide")});const i=t.on("beforeStartNavigationSpan",(o,c)=>{c!=null&&c.isRedirect||(s("navigation"),i(),a())}),a=t.on("afterStartPageLoadSpan",o=>{n=o.spanContext().spanId,a()})}function Ap(t){let e=0,n;if(!El("layout-shift"))return;const r=_l(({metric:s})=>{const i=s.entries[s.entries.length-1];i&&(e=s.value,n=i)},!0);bl(t,(s,i)=>{Gp(e,n,i,s),r()})}function Gp(t,e,n,r){var l;Vn&&P.log(`Sending CLS span (${t})`);const s=e?Z((bt()||0)+e.startTime):st(),i=z().getScopeData().transactionName,a=e?It((l=e.sources[0])==null?void 0:l.node):"Layout shift",o={[rt]:"auto.http.browser.cls",[Yt]:"ui.webvital.cls",[hn]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};e!=null&&e.sources&&e.sources.forEach((h,u)=>{o[`cls.source.${u+1}`]=It(h.node)});const c=ji({name:a,transaction:i,attributes:o,startTime:s});c&&(c.addEvent("cls",{[Wn]:"",[zn]:t}),c.end(s))}function Rp(t){let e=0,n;if(!El("largest-contentful-paint"))return;const r=yl(({metric:s})=>{const i=s.entries[s.entries.length-1];i&&(e=s.value,n=i)},!0);bl(t,(s,i)=>{Lp(e,n,i,s),r()})}function Lp(t,e,n,r){Vn&&P.log(`Sending LCP span (${t})`);const s=Z((bt()||0)+((e==null?void 0:e.startTime)||0)),i=z().getScopeData().transactionName,a=e?It(e.element):"Largest contentful paint",o={[rt]:"auto.http.browser.lcp",[Yt]:"ui.webvital.lcp",[hn]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};e&&(e.element&&(o["lcp.element"]=It(e.element)),e.id&&(o["lcp.id"]=e.id),e.url&&(o["lcp.url"]=e.url),e.loadTime!=null&&(o["lcp.loadTime"]=e.loadTime),e.renderTime!=null&&(o["lcp.renderTime"]=e.renderTime),e.size!=null&&(o["lcp.size"]=e.size));const c=ji({name:a,transaction:i,attributes:o,startTime:s});c&&(c.addEvent("lcp",{[Wn]:"millisecond",[zn]:t}),c.end(s))}function xt(t){return t&&((bt()||performance.timeOrigin)+t)/1e3}function Ml(t){var n;const e={};if(t.nextHopProtocol!=null){const{name:r,version:s}=Cp(t.nextHopProtocol);e["network.protocol.version"]=s,e["network.protocol.name"]=r}return bt()||(n=Zn())!=null&&n.timeOrigin?Op({...e,"http.request.redirect_start":xt(t.redirectStart),"http.request.redirect_end":xt(t.redirectEnd),"http.request.worker_start":xt(t.workerStart),"http.request.fetch_start":xt(t.fetchStart),"http.request.domain_lookup_start":xt(t.domainLookupStart),"http.request.domain_lookup_end":xt(t.domainLookupEnd),"http.request.connect_start":xt(t.connectStart),"http.request.secure_connection_start":xt(t.secureConnectionStart),"http.request.connection_end":xt(t.connectEnd),"http.request.request_start":xt(t.requestStart),"http.request.response_start":xt(t.responseStart),"http.request.response_end":xt(t.responseEnd),"http.request.time_to_first_byte":t.responseStart!=null?t.responseStart/1e3:void 0}):e}function Op(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!=null))}const jp=2147483647;let to=0,Lt={},ft,De;function Fp({recordClsStandaloneSpans:t,recordLcpStandaloneSpans:e,client:n}){const r=Zn();if(r&&bt()){r.mark&&R.performance.mark("sentry-tracing-init");const s=e?Rp(n):Bp(),i=Hp(),a=t?Ap(n):qp();return()=>{s==null||s(),i(),a==null||a()}}return()=>{}}function $p(){en("longtask",({entries:t})=>{const e=Mt();if(!e)return;const{op:n,start_timestamp:r}=D(e);for(const s of t){const i=Z(bt()+s.startTime),a=Z(s.duration);n==="navigation"&&r&&i<r||fe(e,i,i+a,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[rt]:"auto.ui.browser.metrics"}})}})}function Dp(){new PerformanceObserver(e=>{const n=Mt();if(n)for(const r of e.getEntries()){if(!r.scripts[0])continue;const s=Z(bt()+r.startTime),{start_timestamp:i,op:a}=D(n);if(a==="navigation"&&i&&s<i)continue;const o=Z(r.duration),c={[rt]:"auto.ui.browser.metrics"},l=r.scripts[0],{invoker:h,invokerType:u,sourceURL:f,sourceFunctionName:d,sourceCharPosition:p}=l;c["browser.script.invoker"]=h,c["browser.script.invoker_type"]=u,f&&(c["code.filepath"]=f),d&&(c["code.function"]=d),p!==-1&&(c["browser.script.source_char_position"]=p),fe(n,s,s+o,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:c})}}).observe({type:"long-animation-frame",buffered:!0})}function Up(){en("event",({entries:t})=>{const e=Mt();if(e){for(const n of t)if(n.name==="click"){const r=Z(bt()+n.startTime),s=Z(n.duration),i={name:It(n.target),op:`ui.interaction.${n.name}`,startTime:r,attributes:{[rt]:"auto.ui.browser.metrics"}},a=lc(n.target);a&&(i.attributes["ui.component_name"]=a),fe(e,r,r+s,i)}}})}function qp(){return _l(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(Lt.cls={value:t.value,unit:""},De=e)},!0)}function Bp(){return yl(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(Lt.lcp={value:t.value,unit:"millisecond"},ft=e)},!0)}function Hp(){return bp(({metric:t})=>{t.entries[t.entries.length-1]&&(Lt.ttfb={value:t.value,unit:"millisecond"})})}function Wp(t,e){const n=Zn(),r=bt();if(!(n!=null&&n.getEntries)||!r)return;const s=Z(r),i=n.getEntries(),{op:a,start_timestamp:o}=D(t);i.slice(to).forEach(c=>{const l=Z(c.startTime),h=Z(Math.max(0,c.duration));if(!(a==="navigation"&&o&&s+l<o))switch(c.entryType){case"navigation":{Xp(t,c,s);break}case"mark":case"paint":case"measure":{Vp(t,c,l,h,s,e.ignorePerformanceApiSpans);const u=Kn(),f=c.startTime<u.firstHiddenTime;c.name==="first-paint"&&f&&(Lt.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&f&&(Lt.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{Qp(t,c,c.name,l,h,s,e.ignoreResourceSpans);break}}}),to=Math.max(i.length-1,0),Zp(t),a==="pageload"&&(nm(Lt),e.recordClsOnPageloadSpan||delete Lt.cls,e.recordLcpOnPageloadSpan||delete Lt.lcp,Object.entries(Lt).forEach(([c,l])=>{Gf(c,l.value,l.unit)}),t.setAttribute("performance.timeOrigin",s),t.setAttribute("performance.activationStart",pn()),tm(t,e)),ft=void 0,De=void 0,Lt={}}function zp(t){if((t==null?void 0:t.entryType)==="measure")try{return t.detail.devtools.track==="Components "}catch{return}}function Vp(t,e,n,r,s,i){if(zp(e)||["mark","measure"].includes(e.entryType)&&ae(e.name,i))return;const a=Xn(!1),o=Z(a?a.requestStart:0),c=s+Math.max(n,o),l=s+n,h=l+r,u={[rt]:"auto.resource.browser.metrics"};c!==l&&(u["sentry.browser.measure_happened_before_request"]=!0,u["sentry.browser.measure_start_time"]=c),Jp(u,e),c<=h&&fe(t,c,h,{name:e.name,op:e.entryType,attributes:u})}function Jp(t,e){try{const n=e.detail;if(!n)return;if(typeof n=="object"){for(const[r,s]of Object.entries(n))if(s&&Xe(s))t[`sentry.browser.measure.detail.${r}`]=s;else if(s!==void 0)try{t[`sentry.browser.measure.detail.${r}`]=JSON.stringify(s)}catch{}return}if(Xe(n)){t["sentry.browser.measure.detail"]=n;return}try{t["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}function Xp(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{dr(t,e,r,n)}),dr(t,e,"secureConnection",n,"TLS/SSL"),dr(t,e,"fetch",n,"cache"),dr(t,e,"domainLookup",n,"DNS"),Yp(t,e,n)}function dr(t,e,n,r,s=n){const i=Kp(n),a=e[i],o=e[`${n}Start`];!o||!a||fe(t,r+Z(o),r+Z(a),{op:`browser.${s}`,name:e.name,attributes:{[rt]:"auto.ui.browser.metrics",...n==="redirect"&&e.redirectCount!=null?{"http.redirect_count":e.redirectCount}:{}}})}function Kp(t){return t==="secureConnection"?"connectEnd":t==="fetch"?"domainLookupStart":`${t}End`}function Yp(t,e,n){const r=n+Z(e.requestStart),s=n+Z(e.responseEnd),i=n+Z(e.responseStart);e.responseEnd&&(fe(t,r,s,{op:"browser.request",name:e.name,attributes:{[rt]:"auto.ui.browser.metrics"}}),fe(t,i,s,{op:"browser.response",name:e.name,attributes:{[rt]:"auto.ui.browser.metrics"}}))}function Qp(t,e,n,r,s,i,a){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const o=e.initiatorType?`resource.${e.initiatorType}`:"resource.other";if(a!=null&&a.includes(o))return;const c={[rt]:"auto.resource.browser.metrics"},l=Ne(n);l.protocol&&(c["url.scheme"]=l.protocol.split(":").pop()),l.host&&(c["server.address"]=l.host),c["url.same_origin"]=n.includes(R.location.origin),em(e,c,[["responseStatus","http.response.status_code"],["transferSize","http.response_transfer_size"],["encodedBodySize","http.response_content_length"],["decodedBodySize","http.decoded_response_content_length"],["renderBlockingStatus","resource.render_blocking_status"],["deliveryType","http.response_delivery_type"]]);const h={...c,...Ml(e)},u=i+r,f=u+s;fe(t,u,f,{name:n.replace(R.location.origin,""),op:o,attributes:h})}function Zp(t){const e=R.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&t.setAttribute("connectionType",n.type),Es(n.rtt)&&(Lt["connection.rtt"]={value:n.rtt,unit:"millisecond"})),Es(e.deviceMemory)&&t.setAttribute("deviceMemory",`${e.deviceMemory} GB`),Es(e.hardwareConcurrency)&&t.setAttribute("hardwareConcurrency",String(e.hardwareConcurrency))}function tm(t,e){ft&&e.recordLcpOnPageloadSpan&&(ft.element&&t.setAttribute("lcp.element",It(ft.element)),ft.id&&t.setAttribute("lcp.id",ft.id),ft.url&&t.setAttribute("lcp.url",ft.url.trim().slice(0,200)),ft.loadTime!=null&&t.setAttribute("lcp.loadTime",ft.loadTime),ft.renderTime!=null&&t.setAttribute("lcp.renderTime",ft.renderTime),t.setAttribute("lcp.size",ft.size)),De!=null&&De.sources&&e.recordClsOnPageloadSpan&&De.sources.forEach((n,r)=>t.setAttribute(`cls.source.${r+1}`,It(n.node)))}function em(t,e,n){n.forEach(([r,s])=>{const i=t[r];i!=null&&(typeof i=="number"&&i<jp||typeof i=="string")&&(e[s]=i)})}function nm(t){const e=Xn(!1);if(!e)return;const{responseStart:n,requestStart:r}=e;r<=n&&(t["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}function rm(){return Zn()&&bt()?en("element",sm):()=>{}}const sm=({entries:t})=>{const e=Mt(),n=e?ht(e):void 0,r=n?D(n).description:z().getScopeData().transactionName;t.forEach(s=>{var d,p;const i=s;if(!i.identifier)return;const a=i.name,o=i.renderTime,c=i.loadTime,[l,h]=c?[Z(c),"load-time"]:o?[Z(o),"render-time"]:[st(),"entry-emission"],u=a==="image-paint"?Z(Math.max(0,(o??0)-(c??0))):0,f={[rt]:"auto.ui.browser.elementtiming",[Yt]:"ui.elementtiming",[$t]:"component","sentry.span_start_time_source":h,"sentry.transaction_name":r,"element.id":i.id,"element.type":((p=(d=i.element)==null?void 0:d.tagName)==null?void 0:p.toLowerCase())||"unknown","element.size":i.naturalWidth&&i.naturalHeight?`${i.naturalWidth}x${i.naturalHeight}`:void 0,"element.render_time":o,"element.load_time":c,"element.url":i.url||void 0,"element.identifier":i.identifier,"element.paint_type":a};$f({name:`element[${i.identifier}]`,attributes:f,startTime:l,onlyIfParent:!0},_=>{_.end(l+u)})})},im=1e3;let eo,Ys,Qs;function am(t){ge("dom",t),_e("dom",om)}function om(){if(!R.document)return;const t=Pt.bind(null,"dom"),e=no(t,!0);R.document.addEventListener("click",e,!1),R.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{var i,a;const s=(i=R[n])==null?void 0:i.prototype;(a=s==null?void 0:s.hasOwnProperty)!=null&&a.call(s,"addEventListener")&&(Et(s,"addEventListener",function(o){return function(c,l,h){if(c==="click"||c=="keypress")try{const u=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=u[c]=u[c]||{refCount:0};if(!f.handler){const d=no(t);f.handler=d,o.call(this,c,d,h)}f.refCount++}catch{}return o.call(this,c,l,h)}}),Et(s,"removeEventListener",function(o){return function(c,l,h){if(c==="click"||c=="keypress")try{const u=this.__sentry_instrumentation_handlers__||{},f=u[c];f&&(f.refCount--,f.refCount<=0&&(o.call(this,c,f.handler,h),f.handler=void 0,delete u[c]),Object.keys(u).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return o.call(this,c,l,h)}}))})}function cm(t){if(t.type!==Ys)return!1;try{if(!t.target||t.target._sentryId!==Qs)return!1}catch{}return!0}function lm(t,e){return t!=="keypress"?!1:e!=null&&e.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0}function no(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=um(n);if(lm(n.type,r))return;gt(n,"_sentryCaptured",!0),r&&!r._sentryId&&gt(r,"_sentryId",Tt());const s=n.type==="keypress"?"input":n.type;cm(n)||(t({event:n,name:s,global:e}),Ys=n.type,Qs=r?r._sentryId:void 0),clearTimeout(eo),eo=R.setTimeout(()=>{Qs=void 0,Ys=void 0},im)}}function um(t){try{return t.target}catch{return null}}let pr;function Fi(t){const e="history";ge(e,t),_e(e,hm)}function hm(){if(R.addEventListener("popstate",()=>{const e=R.location.href,n=pr;if(pr=e,n===e)return;Pt("history",{from:n,to:e})}),!k0())return;function t(e){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const s=pr,i=fm(String(r));if(pr=i,s===i)return e.apply(this,n);Pt("history",{from:s,to:i})}return e.apply(this,n)}}Et(R.history,"pushState",t),Et(R.history,"replaceState",t)}function fm(t){try{return new URL(t,R.location.origin).toString()}catch{return t}}const Ir={};function dm(t){const e=Ir[t];if(e)return e;let n=R[t];if(zs(n))return Ir[t]=n.bind(R);const r=R.document;if(r&&typeof r.createElement=="function")try{const s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s);const i=s.contentWindow;i!=null&&i[t]&&(n=i[t]),r.head.removeChild(s)}catch(s){Vn&&P.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return n&&(Ir[t]=n.bind(R))}function pm(t){Ir[t]=void 0}const Ue="__sentry_xhr_v3__";function xl(t){ge("xhr",t),_e("xhr",mm)}function mm(){if(!R.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const s=new Error,i=st()*1e3,a=Wt(r[0])?r[0].toUpperCase():void 0,o=gm(r[1]);if(!a||!o)return e.apply(n,r);n[Ue]={method:a,url:o,request_headers:{}},a==="POST"&&o.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const c=()=>{const l=n[Ue];if(l&&n.readyState===4){try{l.status_code=n.status}catch{}const h={endTimestamp:st()*1e3,startTimestamp:i,xhr:n,virtualError:s};Pt("xhr",h)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(l,h,u){return c(),l.apply(h,u)}}):n.addEventListener("readystatechange",c),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(l,h,u){const[f,d]=u,p=h[Ue];return p&&Wt(f)&&Wt(d)&&(p.request_headers[f.toLowerCase()]=d),l.apply(h,u)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const s=n[Ue];if(!s)return e.apply(n,r);r[0]!==void 0&&(s.body=r[0]);const i={startTimestamp:st()*1e3,xhr:n};return Pt("xhr",i),e.apply(n,r)}})}function gm(t){if(Wt(t))return t;try{return t.toString()}catch{}}function _m(t){let e;try{e=t.getAllResponseHeaders()}catch(n){return Vn&&P.error(n,"Failed to get xhr response headers",t),{}}return e?e.split(`\r
`).reduce((n,r)=>{const[s,i]=r.split(": ");return i&&(n[s.toLowerCase()]=i),n},{}):{}}const bs=[],kr=new Map,Fe=new Map,ym=60;function vm(){if(Zn()&&bt()){const e=Sm();return()=>{e()}}return()=>{}}const Zs={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function Sm(){return Mp(Em)}const Em=({metric:t})=>{if(t.value==null)return;const e=Z(t.value);if(e>ym)return;const n=t.entries.find(p=>p.duration===t.value&&Zs[p.name]);if(!n)return;const{interactionId:r}=n,s=Zs[n.name],i=Z(bt()+n.startTime),a=Mt(),o=a?ht(a):void 0,c=r!=null?kr.get(r):void 0,l=(c==null?void 0:c.span)||o,h=l?D(l).description:z().getScopeData().transactionName,u=(c==null?void 0:c.elementName)||It(n.target),f={[rt]:"auto.http.browser.inp",[Yt]:`ui.interaction.${s}`,[hn]:n.duration},d=ji({name:u,transaction:h,attributes:f,startTime:i});d&&(d.addEvent("inp",{[Wn]:"millisecond",[zn]:t.value}),d.end(i+e))};function bm(){const t=Object.keys(Zs);U0()&&t.forEach(s=>{R.addEventListener(s,e,{capture:!0,passive:!0})});function e(s){const i=s.target;if(!i)return;const a=It(i),o=Math.round(s.timeStamp);if(Fe.set(o,a),Fe.size>50){const c=Fe.keys().next().value;c!==void 0&&Fe.delete(c)}}function n(s){const i=Math.round(s.startTime);let a=Fe.get(i);if(!a)for(let o=-5;o<=5;o++){const c=Fe.get(i+o);if(c){a=c;break}}return a||"<unknown>"}const r=({entries:s})=>{const i=Mt(),a=i&&ht(i);s.forEach(o=>{if(!Ip(o))return;const c=o.interactionId;if(c==null||kr.has(c))return;const l=o.target?It(o.target):n(o);if(bs.length>10){const h=bs.shift();kr.delete(h)}bs.push(c),kr.set(c,{span:a,elementName:l})})};en("event",r),en("first-input",r)}const Mm=40;function xm(t,e=dm("fetch")){let n=0,r=0;async function s(i){const a=i.body.length;n+=a,r++;const o={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{const c=await e(t.url,o);return{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}}catch(c){throw pm("fetch"),c}finally{n-=a,r--}}return Cd(t,s,ki(t.bufferSize||Mm))}const kt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,wm=30,Pm=50;function ti(t,e,n,r){const s={filename:t,function:e==="<anonymous>"?Ie:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const Tm=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Nm=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Im=/\((\S*)(?::(\d+))(?::(\d+))\)/,km=/at (.+?) ?\(data:(.+?),/,Cm=t=>{const e=t.match(km);if(e)return{filename:`<data:${e[2]}>`,function:e[1]};const n=Tm.exec(t);if(n){const[,s,i,a]=n;return ti(s,Ie,+i,+a)}const r=Nm.exec(t);if(r){if(r[2]&&r[2].indexOf("eval")===0){const o=Im.exec(r[2]);o&&(r[2]=o[1],r[3]=o[2],r[4]=o[3])}const[i,a]=wl(r[1]||Ie,r[2]);return ti(a,i,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}},Am=[wm,Cm],Gm=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Rm=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Lm=t=>{const e=Gm.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=Rm.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||Ie;return[s,r]=wl(s,r),ti(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Om=[Pm,Lm],jm=[Am,Om],Fm=nc(...jm),wl=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ie,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},mr=1024,$m="Breadcrumbs",Dm=((t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:$m,setup(n){e.console&&f0(Hm(n)),e.dom&&am(Bm(n,e.dom)),e.xhr&&xl(Wm(n)),e.fetch&&sl(zm(n)),e.history&&Fi(Vm(n)),e.sentry&&n.on("beforeSendEvent",qm(n))}}}),Um=Dm;function qm(t){return function(n){H()===t&&ke({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:be(n)},{event:n})}}function Bm(t,e){return function(r){if(H()!==t)return;let s,i,a=typeof e=="object"?e.serializeAttribute:void 0,o=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;o&&o>mr&&(kt&&P.warn(`\`dom.maxStringLength\` cannot exceed ${mr}, but a value of ${o} was configured. Sentry will use ${mr} instead.`),o=mr),typeof a=="string"&&(a=[a]);try{const l=r.event,h=Jm(l)?l.target:l;s=It(h,{keyAttrs:a,maxStringLength:o}),i=lc(h)}catch{s="<unknown>"}if(s.length===0)return;const c={category:`ui.${r.name}`,message:s};i&&(c.data={"ui.component_name":i}),ke(c,{event:r.event,name:r.name,global:r.global})}}function Hm(t){return function(n){if(H()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:p0(n.level),message:da(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${da(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;ke(r,{input:n.args,level:n.level})}}function Wm(t){return function(n){if(H()!==t)return;const{startTimestamp:r,endTimestamp:s}=n,i=n.xhr[Ue];if(!r||!s||!i)return;const{method:a,url:o,status_code:c,body:l}=i,h={method:a,url:o,status_code:c},u={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:s},f={category:"xhr",data:h,type:"http",level:rl(c)};t.emit("beforeOutgoingRequestBreadcrumb",f,u),ke(f,u)}}function zm(t){return function(n){if(H()!==t)return;const{startTimestamp:r,endTimestamp:s}=n;if(s&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.fetchData.method,n.fetchData.url,n.error){const i=n.fetchData,a={data:n.error,input:n.args,startTimestamp:r,endTimestamp:s},o={category:"fetch",data:i,level:"error",type:"http"};t.emit("beforeOutgoingRequestBreadcrumb",o,a),ke(o,a)}else{const i=n.response,a={...n.fetchData,status_code:i==null?void 0:i.status};n.fetchData.request_body_size,n.fetchData.response_body_size,i==null||i.status;const o={input:n.args,response:i,startTimestamp:r,endTimestamp:s},c={category:"fetch",data:a,type:"http",level:rl(a.status_code)};t.emit("beforeOutgoingRequestBreadcrumb",c,o),ke(c,o)}}}function Vm(t){return function(n){if(H()!==t)return;let r=n.from,s=n.to;const i=Ne($.location.href);let a=r?Ne(r):void 0;const o=Ne(s);a!=null&&a.path||(a=i),i.protocol===o.protocol&&i.host===o.host&&(s=o.relative),i.protocol===a.protocol&&i.host===a.host&&(r=a.relative),ke({category:"navigation",data:{from:r,to:s}})}}function Jm(t){return!!t&&!!t.target}const Xm=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Km="BrowserApiErrors",Ym=((t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...t};return{name:Km,setupOnce(){e.setTimeout&&Et($,"setTimeout",ro),e.setInterval&&Et($,"setInterval",ro),e.requestAnimationFrame&&Et($,"requestAnimationFrame",Zm),e.XMLHttpRequest&&"XMLHttpRequest"in $&&Et(XMLHttpRequest.prototype,"send",tg);const n=e.eventTarget;n&&(Array.isArray(n)?n:Xm).forEach(s=>eg(s,e))}}}),Qm=Ym;function ro(t){return function(...e){const n=e[0];return e[0]=tn(n,{mechanism:{handled:!1,type:`auto.browser.browserapierrors.${Vt(t)}`}}),t.apply(this,e)}}function Zm(t){return function(e){return t.apply(this,[tn(e,{mechanism:{data:{handler:Vt(t)},handled:!1,type:"auto.browser.browserapierrors.requestAnimationFrame"}})])}}function tg(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&Et(n,s,function(i){const a={mechanism:{data:{handler:Vt(i)},handled:!1,type:`auto.browser.browserapierrors.xhr.${s}`}},o=vi(i);return o&&(a.mechanism.data.handler=Vt(o)),tn(i,a)})}),t.apply(this,e)}}function eg(t,e){var s,i;const r=(s=$[t])==null?void 0:s.prototype;(i=r==null?void 0:r.hasOwnProperty)!=null&&i.call(r,"addEventListener")&&(Et(r,"addEventListener",function(a){return function(o,c,l){try{ng(c)&&(c.handleEvent=tn(c.handleEvent,{mechanism:{data:{handler:Vt(c),target:t},handled:!1,type:"auto.browser.browserapierrors.handleEvent"}}))}catch{}return e.unregisterOriginalCallbacks&&rg(this,o,c),a.apply(this,[o,tn(c,{mechanism:{data:{handler:Vt(c),target:t},handled:!1,type:"auto.browser.browserapierrors.addEventListener"}}),l])}}),Et(r,"removeEventListener",function(a){return function(o,c,l){try{const h=c.__sentry_wrapped__;h&&a.call(this,o,h,l)}catch{}return a.call(this,o,c,l)}}))}function ng(t){return typeof t.handleEvent=="function"}function rg(t,e,n){t&&typeof t=="object"&&"removeEventListener"in t&&typeof t.removeEventListener=="function"&&t.removeEventListener(e,n)}const sg=()=>({name:"BrowserSession",setupOnce(){if(typeof $.document>"u"){kt&&P.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}Ra({ignoreDuration:!0}),La(),Fi(({from:t,to:e})=>{t!==void 0&&t!==e&&(Ra({ignoreDuration:!0}),La())})}}),ig="GlobalHandlers",ag=((t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:ig,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(cg(n),so("onerror")),e.onunhandledrejection&&(lg(n),so("onunhandledrejection"))}}}),og=ag;function cg(t){sc(e=>{const{stackParser:n,attachStacktrace:r}=Pl();if(H()!==t||al())return;const{msg:s,url:i,line:a,column:o,error:c}=e,l=fg(Ri(n,c||s,void 0,r,!1),i,a,o);l.level="error",jc(l,{originalException:c,mechanism:{handled:!1,type:"auto.browser.global_handlers.onerror"}})})}function lg(t){ic(e=>{const{stackParser:n,attachStacktrace:r}=Pl();if(H()!==t||al())return;const s=ug(e),i=Xe(s)?hg(s):Ri(n,s,void 0,r,!0);i.level="error",jc(i,{originalException:s,mechanism:{handled:!1,type:"auto.browser.global_handlers.onunhandledrejection"}})})}function ug(t){if(Xe(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function hg(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function fg(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],a=i[0]=i[0]||{},o=a.stacktrace=a.stacktrace||{},c=o.frames=o.frames||[],l=r,h=n,u=dg(e)??Un();return c.length===0&&c.push({colno:l,filename:u,function:Ie,in_app:!0,lineno:h}),t}function so(t){kt&&P.log(`Global Handler attached: ${t}`)}function Pl(){const t=H();return(t==null?void 0:t.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}function dg(t){if(!(!Wt(t)||t.length===0))return t.startsWith("data:")?`<${oe(t,!1)}>`:t}const pg=()=>({name:"HttpContext",preprocessEvent(t){var r;if(!$.navigator&&!$.location&&!$.document)return;const e=Ci(),n={...e.headers,...(r=t.request)==null?void 0:r.headers};t.request={...e,...t.request,headers:n}}}),mg="cause",gg=5,_g="LinkedErrors",yg=((t={})=>{const e=t.limit||gg,n=t.key||mg;return{name:_g,preprocessEvent(r,s,i){const a=i.getOptions();h0(Ai,a.stackParser,n,e,r,s)}}}),vg=yg;function Sg(){return Eg()?(kt&&on(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function Eg(){var i;if(typeof $.window>"u")return!1;const t=$;if(t.nw)return!1;const e=t.chrome||t.browser;if(!((i=e==null?void 0:e.runtime)!=null&&i.id))return!1;const n=Un(),r=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!($===$.top&&r.some(a=>n.startsWith(`${a}://`)))}function bg(t){return[r0(),Zd(),M0(),Qm(),Um(),og(),vg(),_0(),pg(),sg()]}function Mg(t={}){const e=!t.skipBrowserExtensionCheck&&Sg();let n=t.defaultIntegrations==null?bg():t.defaultIntegrations;const r={...t,enabled:e?!1:t.enabled,stackParser:ah(t.stackParser||Fm),integrations:yd({integrations:t.integrations,defaultIntegrations:n}),transport:t.transport||xm};return qd(ep,r)}function xg(t){return t.split(",").some(e=>e.trim().startsWith("sentry-"))}function Tl(t){try{return new URL(t,$.location.origin).href}catch{return}}function wg(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function Nl(t){try{return new Headers(t)}catch{return}}const io=new WeakMap,Ms=new Map,Il={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function Pg(t,e){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:i,enableHTTPTimings:a,tracePropagationTargets:o,onRequestSpanStart:c,onRequestSpanEnd:l}={...Il,...e},h=typeof i=="function"?i:p=>!0,u=p=>Tg(p,o),f={},d=t.getOptions().propagateTraceparent;n&&(t.addEventProcessor(p=>(p.type==="transaction"&&p.spans&&p.spans.forEach(_=>{if(_.op==="http.client"){const m=Ms.get(_.span_id);m&&(_.timestamp=m/1e3,Ms.delete(_.span_id))}}),p)),s&&G0(p=>{if(p.response){const _=io.get(p.response);_&&p.endTimestamp&&Ms.set(_,p.endTimestamp)}}),sl(p=>{const _=x0(p,h,u,f,{propagateTraceparent:d,onRequestSpanEnd:l});if(p.response&&p.fetchData.__span&&io.set(p.response,p.fetchData.__span),_){const m=Tl(p.fetchData.url),y=m?Ne(m).host:void 0;_.setAttributes({"http.url":m?oe(m):void 0,"server.address":y}),a&&ao(_),c==null||c(_,{headers:p.headers})}})),r&&xl(p=>{var m;const _=Ng(p,h,u,f,d,l);_&&(a&&ao(_),c==null||c(_,{headers:Nl((m=p.xhr.__sentry_xhr_v3__)==null?void 0:m.request_headers)}))})}function ao(t){const{url:e}=D(t).data;if(!e||typeof e!="string")return;const n=en("resource",({entries:r})=>{r.forEach(s=>{wg(s)&&s.name.endsWith(e)&&(t.setAttributes(Ml(s)),setTimeout(n))})})}function Tg(t,e){const n=Un();if(n){let r,s;try{r=new URL(t,n),s=new URL(n).origin}catch{return!1}const i=r.origin===s;return e?ae(r.toString(),e)||i&&ae(r.pathname,e):i}else{const r=!!t.match(/^\/(?!\/)/);return e?ae(t,e):r}}function Ng(t,e,n,r,s,i){const a=t.xhr,o=a==null?void 0:a[Ue];if(!a||a.__sentry_own_request__||!o)return;const{url:c,method:l}=o,h=Ot()&&e(c);if(t.endTimestamp&&h){const y=a.__sentry_xhr_span_id__;if(!y)return;const S=r[y];S&&o.status_code!==void 0&&(mc(S,o.status_code),S.end(),i==null||i(S,{headers:Nl(_m(a)),error:t.error}),delete r[y]);return}const u=Tl(c),f=Ne(u||c),d=oe(zd(c)),p=!!Mt(),_=h&&p?dn({name:`${l} ${d}`,attributes:{url:oe(c),type:"xhr","http.method":l,"http.url":u?oe(u):void 0,"server.address":f==null?void 0:f.host,[rt]:"auto.http.browser",[Yt]:"http.client",...(f==null?void 0:f.search)&&{"http.query":f==null?void 0:f.search},...(f==null?void 0:f.hash)&&{"http.fragment":f==null?void 0:f.hash}}}):new he;a.__sentry_xhr_span_id__=_.spanContext().spanId,r[a.__sentry_xhr_span_id__]=_,n(c)&&Ig(a,Ot()&&p?_:void 0,s);const m=H();return m&&m.emit("beforeOutgoingRequestSpan",_,t),_}function Ig(t,e,n){const{"sentry-trace":r,baggage:s,traceparent:i}=tl({span:e,propagateTraceparent:n});r&&kg(t,r,s,i)}function kg(t,e,n,r){var i;const s=(i=t.__sentry_xhr_v3__)==null?void 0:i.request_headers;if(!(s!=null&&s["sentry-trace"]||!t.setRequestHeader))try{if(t.setRequestHeader("sentry-trace",e),r&&!(s!=null&&s.traceparent)&&t.setRequestHeader("traceparent",r),n){const a=s==null?void 0:s.baggage;(!a||!xg(a))&&t.setRequestHeader("baggage",n)}}catch{}}function Cg(){$.document?$.document.addEventListener("visibilitychange",()=>{const t=Mt();if(!t)return;const e=ht(t);if($.document.hidden&&e){const n="cancelled",{op:r,status:s}=D(e);kt&&P.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),s||e.setStatus({code:nt,message:n}),e.setAttribute("sentry.cancellation_reason","document.hidden"),e.end()}}):kt&&P.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const Ag=3600,kl="sentry_previous_trace",Gg="sentry.previous_trace";function Rg(t,{linkPreviousTrace:e,consistentTraceSampling:n}){const r=e==="session-storage";let s=r?jg():void 0;t.on("spanStart",a=>{if(ht(a)!==a)return;const o=z().getPropagationContext();s=Lg(s,a,o),r&&Og(s)});let i=!0;n&&t.on("beforeSampling",a=>{if(!s)return;const o=z(),c=o.getPropagationContext();if(i&&c.parentSpanId){i=!1;return}o.setPropagationContext({...c,dsc:{...c.dsc,sample_rate:String(s.sampleRate),sampled:String(ei(s.spanContext))},sampleRand:s.sampleRand}),a.parentSampled=ei(s.spanContext),a.parentSampleRate=s.sampleRate,a.spanAttributes={...a.spanAttributes,[pc]:s.sampleRate}})}function Lg(t,e,n){const r=D(e);function s(){var o,c;try{return Number((o=n.dsc)==null?void 0:o.sample_rate)??Number((c=r.data)==null?void 0:c[Si])}catch{return 0}}const i={spanContext:e.spanContext(),startTimestamp:r.start_timestamp,sampleRate:s(),sampleRand:n.sampleRand};if(!t)return i;const a=t.spanContext;return a.traceId===r.trace_id?t:(Date.now()/1e3-t.startTimestamp<=Ag&&(kt&&P.log(`Adding previous_trace \`${JSON.stringify(a)}\` link to span \`${JSON.stringify({op:r.op,...e.spanContext()})}\``),e.addLink({context:a,attributes:{[Rh]:"previous_trace"}}),e.setAttribute(Gg,`${a.traceId}-${a.spanId}-${ei(a)?1:0}`)),i)}function Og(t){try{$.sessionStorage.setItem(kl,JSON.stringify(t))}catch(e){kt&&P.warn("Could not store previous trace in sessionStorage",e)}}function jg(){var t;try{const e=(t=$.sessionStorage)==null?void 0:t.getItem(kl);return JSON.parse(e)}catch{return}}function ei(t){return t.traceFlags===1}const Fg="BrowserTracing",$g={...wr,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,enableReportPageLoaded:!1,_experiments:{},...Il},Dg=((t={})=>{const e={name:void 0,source:void 0},n=$.document,{enableInp:r,enableElementTiming:s,enableLongTask:i,enableLongAnimationFrame:a,_experiments:{enableInteractions:o,enableStandaloneClsSpans:c,enableStandaloneLcpSpans:l},beforeStartSpan:h,idleTimeout:u,finalTimeout:f,childSpanTimeout:d,markBackgroundSpan:p,traceFetch:_,traceXHR:m,trackFetchStreamPerformance:y,shouldCreateSpanForRequest:S,enableHTTPTimings:M,ignoreResourceSpans:N,ignorePerformanceApiSpans:I,instrumentPageLoad:v,instrumentNavigation:E,detectRedirects:k,linkPreviousTrace:L,consistentTraceSampling:V,enableReportPageLoaded:W,onRequestSpanStart:it,onRequestSpanEnd:K}={...$g,...t};let X,Ut,yt;function Ct(A,O,G=!0){const F=O.op==="pageload",J=O.name,at=h?h(O):O,At=at.attributes||{};if(J!==at.name&&(At[$t]="custom",at.attributes=At),!G){const qt=Re();dn({...at,startTime:qt}).end(qt);return}e.name=at.name,e.source=At[$t];const vt=Oc(at,{idleTimeout:u,finalTimeout:f,childSpanTimeout:d,disableAutoFinish:F,beforeSpanEnd:qt=>{X==null||X(),Wp(qt,{recordClsOnPageloadSpan:!c,recordLcpOnPageloadSpan:!l,ignoreResourceSpans:N,ignorePerformanceApiSpans:I}),co(A,void 0);const ee=z(),Gt=ee.getPropagationContext();ee.setPropagationContext({...Gt,traceId:vt.spanContext().traceId,sampled:ye(vt),dsc:ue(qt)}),F&&(yt=void 0)},trimIdleSpanEndTimestamp:!W});F&&W&&(yt=vt),co(A,vt);function Oe(){n&&["interactive","complete"].includes(n.readyState)&&A.emit("idleSpanEnableAutoFinish",vt)}F&&!W&&n&&(n.addEventListener("readystatechange",()=>{Oe()}),Oe())}return{name:Fg,setup(A){if(hf(),X=Fp({recordClsStandaloneSpans:c||!1,recordLcpStandaloneSpans:l||!1,client:A}),r&&vm(),s&&rm(),a&&j.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?Dp():i&&$p(),o&&Up(),k&&n){const G=()=>{Ut=st()};addEventListener("click",G,{capture:!0}),addEventListener("keydown",G,{capture:!0,passive:!0})}function O(){const G=Ln(A);G&&!D(G).timestamp&&(kt&&P.log(`[Tracing] Finishing current active span with op: ${D(G).op}`),G.setAttribute(Cn,"cancelled"),G.end())}A.on("startNavigationSpan",(G,F)=>{if(H()!==A)return;if(F!=null&&F.isRedirect){kt&&P.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),Ct(A,{op:"navigation.redirect",...G},!1);return}Ut=void 0,O(),Qt().setPropagationContext({traceId:Xt(),sampleRand:Math.random(),propagationSpanId:Ot()?void 0:zt()});const J=z();J.setPropagationContext({traceId:Xt(),sampleRand:Math.random(),propagationSpanId:Ot()?void 0:zt()}),J.setSDKProcessingMetadata({normalizedRequest:void 0}),Ct(A,{op:"navigation",...G,parentSpan:null,forceTransaction:!0})}),A.on("startPageLoadSpan",(G,F={})=>{if(H()!==A)return;O();const J=F.sentryTrace||oo("sentry-trace"),at=F.baggage||oo("baggage"),At=ef(J,at),vt=z();vt.setPropagationContext(At),Ot()||(vt.getPropagationContext().propagationSpanId=zt()),vt.setSDKProcessingMetadata({normalizedRequest:Ci()}),Ct(A,{op:"pageload",...G})}),A.on("endPageloadSpan",()=>{W&&yt&&(yt.setAttribute(Cn,"reportPageLoaded"),yt.end())})},afterAllSetup(A){let O=Un();if(L!=="off"&&Rg(A,{linkPreviousTrace:L,consistentTraceSampling:V}),$.location){if(v){const G=bt();Ug(A,{name:$.location.pathname,startTime:G?G/1e3:void 0,attributes:{[$t]:"url",[rt]:"auto.pageload.browser"}})}E&&Fi(({to:G,from:F})=>{if(F===void 0&&(O==null?void 0:O.indexOf(G))!==-1){O=void 0;return}O=void 0;const J=Qc(G),at=Ln(A),At=at&&k&&Hg(at,Ut);qg(A,{name:(J==null?void 0:J.pathname)||$.location.pathname,attributes:{[$t]:"url",[rt]:"auto.navigation.browser"}},{url:G,isRedirect:At})})}p&&Cg(),o&&Bg(A,u,f,d,e),r&&bm(),Pg(A,{traceFetch:_,traceXHR:m,trackFetchStreamPerformance:y,tracePropagationTargets:A.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:S,enableHTTPTimings:M,onRequestSpanStart:it,onRequestSpanEnd:K})}}});function Ug(t,e,n){t.emit("startPageLoadSpan",e,n),z().setTransactionName(e.name);const r=Ln(t);return r&&t.emit("afterStartPageLoadSpan",r),r}function qg(t,e,n){const{url:r,isRedirect:s}=n||{};t.emit("beforeStartNavigationSpan",e,{isRedirect:s}),t.emit("startNavigationSpan",e,{isRedirect:s});const i=z();return i.setTransactionName(e.name),r&&!s&&i.setSDKProcessingMetadata({normalizedRequest:{...Ci(),url:r}}),Ln(t)}function oo(t){const e=$.document,n=e==null?void 0:e.querySelector(`meta[name=${t}]`);return(n==null?void 0:n.getAttribute("content"))||void 0}function Bg(t,e,n,r,s){const i=$.document;let a;const o=()=>{const c="ui.action.click",l=Ln(t);if(l){const h=D(l).op;if(["navigation","pageload"].includes(h)){kt&&P.warn(`[Tracing] Did not create ${c} span because a pageload or navigation span is in progress.`);return}}if(a&&(a.setAttribute(Cn,"interactionInterrupted"),a.end(),a=void 0),!s.name){kt&&P.warn(`[Tracing] Did not create ${c} transaction because _latestRouteName is missing.`);return}a=Oc({name:s.name,op:c,attributes:{[$t]:s.source||"url"}},{idleTimeout:e,finalTimeout:n,childSpanTimeout:r})};i&&addEventListener("click",o,{capture:!0})}const Cl="_sentry_idleSpan";function Ln(t){return t[Cl]}function co(t,e){gt(t,Cl,e)}const lo=1.5;function Hg(t,e){const n=D(t),r=Re(),s=n.start_timestamp;return!(r-s>lo||e&&r-e<=lo)}function Wg(t){const e={...t};return Zc(e,"react"),ud("react",{version:x.version}),Mg(e)}/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Al=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Vg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=x.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},c)=>x.createElement("svg",{ref:c,...Vg,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:Al("lucide",s),...o},[...a.map(([l,h])=>x.createElement(l,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=(t,e)=>{const n=x.forwardRef(({className:r,...s},i)=>x.createElement(Jg,{ref:i,iconNode:e,className:Al(`lucide-${zg(t)}`,r),...s}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=B("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=B("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=B("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=B("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=B("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=B("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=B("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=B("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=B("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=B("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=B("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=B("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=B("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=B("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=B("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=B("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=B("LocateFixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=B("LocateOff",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["path",{d:"M7.11 7.11C5.83 8.39 5 10.1 5 12c0 3.87 3.13 7 7 7 1.9 0 3.61-.83 4.89-2.11",key:"1oh7ia"}],["path",{d:"M18.71 13.96c.19-.63.29-1.29.29-1.96 0-3.87-3.13-7-7-7-.67 0-1.33.1-1.96.29",key:"3qdecy"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=B("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=B("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=B("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=B("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=B("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1=B("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=B("Pentagon",[["path",{d:"M10.83 2.38a2 2 0 0 1 2.34 0l8 5.74a2 2 0 0 1 .73 2.25l-3.04 9.26a2 2 0 0 1-1.9 1.37H7.04a2 2 0 0 1-1.9-1.37L2.1 10.37a2 2 0 0 1 .73-2.25z",key:"2hea0t"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=B("Spline",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=B("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=B("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=B("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=B("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function v1({theme:t,onThemeChange:e}){const n=()=>{const s=["light","dark","system"],a=(s.indexOf(t)+1)%s.length,o=s[a];o&&e(o)},r=t==="dark"?p1:t==="light"?m1:d1;return g.jsxs("header",{className:"flex h-10 shrink-0 items-center justify-between border-b border-neutral-200 bg-white px-3 md:h-14 md:px-4 dark:border-neutral-800 dark:bg-neutral-900",children:[g.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[g.jsx("h1",{className:"text-lg font-semibold text-primary-600 md:text-xl dark:text-primary-400",children:"GeoFiddle"}),g.jsx("span",{className:"rounded bg-primary-100 px-1 py-0.5 text-[10px] font-medium text-primary-700 md:px-1.5 md:text-xs dark:bg-primary-900 dark:text-primary-300",children:"v2"})]}),g.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[g.jsx("button",{onClick:n,className:"rounded-md p-1.5 text-neutral-600 hover:bg-neutral-100 md:p-2 dark:text-neutral-400 dark:hover:bg-neutral-800","aria-label":`Current theme: ${t}. Click to change.`,children:g.jsx(r,{className:"h-4 w-4 md:h-5 md:w-5"})}),g.jsxs("a",{href:"https://github.com/ruipinge/geofiddle",target:"_blank",rel:"noopener noreferrer",className:"hidden items-center gap-1 rounded-md px-2 py-1.5 text-sm text-neutral-600 hover:bg-neutral-100 md:flex dark:text-neutral-400 dark:hover:bg-neutral-800","aria-label":"View source on GitHub",children:[g.jsx("span",{children:"GitHub"}),g.jsx(r1,{className:"h-4 w-4"})]})]})]})}function S1({left:t,right:e,leftWidthPercent:n,minLeftWidthPercent:r,maxLeftWidthPercent:s,onLeftWidthPercentChange:i}){const[a,o]=x.useState(!1),[c,l]=x.useState(0),h=x.useRef(null);x.useEffect(()=>{const d=h.current;if(!d)return;const p=()=>{l(d.getBoundingClientRect().width)};p();const _=new ResizeObserver(p);return _.observe(d),()=>{_.disconnect()}},[]);const u=x.useCallback(()=>{o(!0)},[]);x.useEffect(()=>{if(!a)return;const d=_=>{if(!h.current)return;const m=h.current.getBoundingClientRect(),S=(_.clientX-m.left)/m.width*100,M=Math.min(s,Math.max(r,S));i(M)},p=()=>{o(!1)};return document.addEventListener("mousemove",d),document.addEventListener("mouseup",p),()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",p)}},[a,r,s,i]);const f=c>0?n/100*c:0;return g.jsxs("main",{id:"main-content",ref:h,className:"flex flex-1 overflow-hidden",role:"main",children:[g.jsx("section",{style:{width:f},className:"shrink-0 overflow-hidden","aria-label":"Input and conversion panel",children:t}),g.jsx("div",{onMouseDown:u,role:"separator","aria-orientation":"vertical","aria-label":"Resize panels",tabIndex:0,onKeyDown:d=>{d.key==="ArrowLeft"?i(Math.max(r,n-2)):d.key==="ArrowRight"&&i(Math.min(s,n+2))},className:`w-1 shrink-0 cursor-col-resize bg-neutral-200 transition-colors hover:bg-primary-400 focus-visible:bg-primary-500 focus-visible:outline-none dark:bg-neutral-700 dark:hover:bg-primary-500 ${a?"bg-primary-500 dark:bg-primary-500":""}`}),g.jsx("section",{className:"flex-1 overflow-hidden","aria-label":"Map view",children:e})]})}function E1({children:t,onFileDrop:e,accept:n}){const[r,s]=x.useState(!1),i=x.useCallback(l=>{l.preventDefault(),l.stopPropagation(),s(!0)},[]),a=x.useCallback(l=>{l.preventDefault(),l.stopPropagation(),l.currentTarget===l.target&&s(!1)},[]),o=x.useCallback(l=>{l.preventDefault(),l.stopPropagation()},[]),c=x.useCallback(l=>{var f;l.preventDefault(),l.stopPropagation(),s(!1);const h=l.dataTransfer.files[0];if(!h)return;if(n&&n.length>0){const d=`.${((f=h.name.split(".").pop())==null?void 0:f.toLowerCase())??""}`;if(!n.includes(d)&&!n.includes("*")){console.warn(`File type ${d} not accepted`);return}}const u=new FileReader;u.onload=d=>{var _;const p=(_=d.target)==null?void 0:_.result;typeof p=="string"&&e(p,h.name)},u.onerror=()=>{console.error("Failed to read file")},u.readAsText(h)},[e,n]);return g.jsxs("div",{onDragEnter:i,onDragLeave:a,onDragOver:o,onDrop:c,className:"relative",children:[t,r&&g.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center rounded-md border-2 border-dashed border-primary-500 bg-primary-50/90 dark:bg-primary-950/90",children:[g.jsx(_1,{className:"mb-2 h-8 w-8 text-primary-500"}),g.jsx("p",{className:"text-sm font-medium text-primary-700 dark:text-primary-300",children:"Drop file to load"}),g.jsx("p",{className:"text-xs text-primary-600 dark:text-primary-400",children:"GeoJSON, WKT, CSV, KML, GPX"})]})]})}function b1({value:t,onChange:e,placeholder:n}){const r=x.useCallback(a=>{e(a.target.value)},[e]),s=x.useCallback(a=>{a.preventDefault();const o=a.dataTransfer.files[0];if(o){const c=new FileReader;c.onload=l=>{var u;const h=(u=l.target)==null?void 0:u.result;typeof h=="string"&&e(h)},c.readAsText(o)}},[e]),i=x.useCallback(a=>{a.preventDefault()},[]);return g.jsx("textarea",{value:t,onChange:r,onDrop:s,onDragOver:i,placeholder:n,"aria-label":"Geometry input",className:"h-48 w-full resize-none rounded-md border border-neutral-300 bg-white p-3 font-mono text-sm text-neutral-900 placeholder:text-neutral-400 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-neutral-600 dark:bg-neutral-800 dark:text-neutral-100 dark:placeholder:text-neutral-500",spellCheck:!1})}const fo=[{value:"auto",label:"Auto-detect"},{value:"geojson",label:"GeoJSON"},{value:"wkt",label:"WKT"},{value:"ewkt",label:"EWKT"},{value:"csv",label:"CSV"},{value:"kml",label:"KML"},{value:"gpx",label:"GPX"},{value:"polyline5",label:"Polyline (5)"},{value:"polyline6",label:"Polyline (6)"}];function M1({value:t,onChange:e,detectedValue:n,label:r}){var i;const s=t==="auto"&&n?`Auto (${n.toUpperCase()})`:((i=fo.find(a=>a.value===t))==null?void 0:i.label)??t;return g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"label",children:r}),g.jsx("select",{value:t,onChange:a=>{e(a.target.value)},className:"input","aria-label":`${r}: ${s}`,children:fo.map(a=>g.jsx("option",{value:a.value,children:a.label},a.value))})]})}const po=[{value:"auto",label:"Auto-detect"},{value:"EPSG:4326",label:"WGS84 (EPSG:4326)"},{value:"EPSG:3857",label:"Web Mercator (EPSG:3857)"},{value:"EPSG:27700",label:"British National Grid (EPSG:27700)"}];function x1({value:t,onChange:e,detectedValue:n,label:r}){var i;const s=t==="auto"&&n?`Auto (${n})`:((i=po.find(a=>a.value===t))==null?void 0:i.label)??t;return g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"label",children:r}),g.jsx("select",{value:t,onChange:a=>{e(a.target.value)},className:"input","aria-label":`${r}: ${s}`,children:po.map(a=>g.jsx("option",{value:a.value,children:a.label},a.value))})]})}const mo=t=>{let e;const n=new Set,r=(l,h)=>{const u=typeof l=="function"?l(e):l;if(!Object.is(u,e)){const f=e;e=h??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(d=>d(e,f))}},s=()=>e,o={setState:r,getState:s,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(r,s,o);return o},w1=(t=>t?mo(t):mo),P1=t=>t;function T1(t,e=P1){const n=cr.useSyncExternalStore(t.subscribe,cr.useCallback(()=>e(t.getState()),[t,e]),cr.useCallback(()=>e(t.getInitialState()),[t,e]));return cr.useDebugValue(n),n}const go=t=>{const e=w1(t),n=r=>T1(e,r);return Object.assign(n,e),n},tr=(t=>t?go(t):go),_o={rawText:"",inputFormat:"auto",inputProjection:"auto",detectedFormat:null,detectedProjection:null,features:[],parseError:null,coordinateError:null,isParsing:!1,selectedFeatureId:null,hoveredFeatureId:null},Ft=tr(t=>({..._o,setRawText:e=>{t({rawText:e})},setInputFormat:e=>{t({inputFormat:e})},setInputProjection:e=>{t({inputProjection:e})},setFeatures:e=>{t({features:e,parseError:null})},setParseError:e=>{t({parseError:e,features:[]})},setCoordinateError:e=>{t({coordinateError:e})},setIsParsing:e=>{t({isParsing:e})},setSelectedFeatureId:e=>{t({selectedFeatureId:e})},setHoveredFeatureId:e=>{t({hoveredFeatureId:e})},setDetectedFormat:e=>{t({detectedFormat:e})},setDetectedProjection:e=>{t({detectedProjection:e})},reset:()=>{t(_o)}}));function N1(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Ce=1,Ae=2,Ve=3,I1=4,ni=5,yo=6378137,k1=6356752314e-3,vo=.0066943799901413165,wn=484813681109536e-20,b=Math.PI/2,C1=.16666666666666666,A1=.04722222222222222,G1=.022156084656084655,w=1e-10,Q=.017453292519943295,mt=57.29577951308232,U=Math.PI/4,On=Math.PI*2,tt=3.14159265359,_t={};_t.greenwich=0;_t.lisbon=-9.131906111111;_t.paris=2.337229166667;_t.bogota=-74.080916666667;_t.madrid=-3.687938888889;_t.rome=12.452333333333;_t.bern=7.439583333333;_t.jakarta=106.807719444444;_t.ferro=-17.666666666667;_t.brussels=4.367975;_t.stockholm=18.058277777778;_t.athens=23.7163375;_t.oslo=10.722916666667;const R1={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var So=/[\s_\-\/\(\)]/g;function de(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(So,""),s=-1,i,a;++s<n.length;)if(i=n[s],a=i.toLowerCase().replace(So,""),a===r)return t[i]}function ri(t){var e={},n=t.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,c){var l=c.split("=");return l.push(!0),o[l[0].toLowerCase()]=l[1],o},{}),r,s,i,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Q},lat_1:function(o){e.lat1=o*Q},lat_2:function(o){e.lat2=o*Q},lat_ts:function(o){e.lat_ts=o*Q},lon_0:function(o){e.long0=o*Q},lon_1:function(o){e.long1=o*Q},lon_2:function(o){e.long2=o*Q},alpha:function(o){e.alpha=parseFloat(o)*Q},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Q},lonc:function(o){e.longc=o*Q},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(c){return parseFloat(c)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var c=de(R1,o);c&&(e.to_meter=c.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Q},pm:function(o){var c=de(_t,o);e.from_greenwich=(c||parseFloat(o))*Q},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var c="ewnsud";o.length===3&&c.indexOf(o.substr(0,1))!==-1&&c.indexOf(o.substr(1,1))!==-1&&c.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in n)s=n[r],r in a?(i=a[r],typeof i=="function"?i(s):e[i]=s):e[r]=s;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=t,e}class jl{static getId(e){const n=e.find(r=>Array.isArray(r)&&r[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=e[1],s=parseFloat(e[2])||null,i=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=i?{authority:i[1],code:parseInt(i[2],10)}:null;return{type:n,name:r,conversion_factor:s,id:a}}static convertAxis(e){const n=e[1]||"Unknown";let r;const s=n.match(/^\((.)\)$/);if(s){const l=s[1].toUpperCase();if(l==="E")r="east";else if(l==="N")r="north";else if(l==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${l}`)}else r=e[2]?e[2].toLowerCase():"unknown";const i=e.find(l=>Array.isArray(l)&&l[0]==="ORDER"),a=i?parseInt(i[1],10):null,o=e.find(l=>Array.isArray(l)&&(l[0]==="LENGTHUNIT"||l[0]==="ANGLEUNIT"||l[0]==="SCALEUNIT")),c=this.convertUnit(o);return{name:n,direction:r,unit:c,order:a}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")):null,n.conversion=e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")):null;const r=e.find(f=>Array.isArray(f)&&f[0]==="CS");r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(e)});const s=e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT");if(s){const f=this.convertUnit(s);n.coordinate_system.unit=f}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const i=e.find(f=>Array.isArray(f)&&(f[0]==="DATUM"||f[0]==="ENSEMBLE"));if(i){const f=this.convert(i);i[0]==="ENSEMBLE"?n.datum_ensemble=f:n.datum=f;const d=e.find(p=>Array.isArray(p)&&p[0]==="PRIMEM");d&&d[1]!=="Greenwich"&&(f.prime_meridian={name:d[1],longitude:parseFloat(d[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(f=>Array.isArray(f)&&f[0]==="MEMBER").map(f=>({type:"DatumEnsembleMember",name:f[1],id:this.getId(f)}));const a=e.find(f=>Array.isArray(f)&&f[0]==="ENSEMBLEACCURACY");a&&(n.accuracy=parseFloat(a[1]));const o=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID");o&&(n.ellipsoid=this.convert(o)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT")&&this.convert(e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&f[0]==="PARAMETER").map(f=>this.convert(f));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(f=>Array.isArray(f)&&(f[0]==="LENGTHUNIT"||f[0]==="ANGLEUNIT"||f[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const c=e.find(f=>Array.isArray(f)&&f[0]==="SOURCECRS");if(c){const f=c.find(d=>Array.isArray(d));n.source_crs=f?this.convert(f):null}const l=e.find(f=>Array.isArray(f)&&f[0]==="TARGETCRS");if(l){const f=l.find(d=>Array.isArray(d));n.target_crs=f?this.convert(f):null}const h=e.find(f=>Array.isArray(f)&&f[0]==="ABRIDGEDTRANSFORMATION");h?n.transformation=this.convert(h):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&(f[0]==="PARAMETER"||f[0]==="PARAMETERFILE")).map(f=>{if(f[0]==="PARAMETER")return this.convert(f);if(f[0]==="PARAMETERFILE")return{name:f[1],value:f[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const f=n.parameters[6];f.name==="Scale difference"&&(f.value=Math.round((f.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const u=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(f=>{f.unit||(f.unit=u)}),u.conversion_factor&&u.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:u});break;default:n.keyword=e[0];break}return n}}class L1 extends jl{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class O1 extends jl{static convert(e,n={}){super.convert(e,n);const r=e.find(i=>Array.isArray(i)&&i[0]==="CS");r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const s=e.find(i=>Array.isArray(i)&&i[0]==="USAGE");if(s){const i=s.find(c=>Array.isArray(c)&&c[0]==="SCOPE"),a=s.find(c=>Array.isArray(c)&&c[0]==="AREA"),o=s.find(c=>Array.isArray(c)&&c[0]==="BBOX");n.usage={},i&&(n.usage.scope=i[1]),a&&(n.usage.area=a[1]),o&&(n.usage.bbox=o.slice(1))}return n}}function j1(t){return t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(t.find(e=>Array.isArray(e)&&e[0]==="CS")||t[0]==="BOUNDCRS"||t[0]==="PROJCRS"||t[0]==="GEOGCRS","2015")}function F1(t){return(j1(t)==="2019"?O1:L1).convert(t)}function $1(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var jn=1,Fl=2,$l=3,Wr=4,Dl=5,$i=-1,D1=/\s/,U1=/[A-Za-z]/,q1=/[A-Za-z84_]/,os=/[,\]]/,Ul=/[\d\.E\-\+]/;function Zt(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=jn}Zt.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==Wr)for(;D1.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case jn:return this.neutral(t);case Fl:return this.keyword(t);case Wr:return this.quoted(t);case Dl:return this.afterquote(t);case $l:return this.number(t);case $i:return}};Zt.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=Wr;return}if(os.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};Zt.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=jn;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=jn,this.currentObject=this.stack.pop(),this.currentObject||(this.state=$i);return}};Zt.prototype.number=function(t){if(Ul.test(t)){this.word+=t;return}if(os.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};Zt.prototype.quoted=function(t){if(t==='"'){this.state=Dl;return}this.word+=t};Zt.prototype.keyword=function(t){if(q1.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=jn;return}if(os.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};Zt.prototype.neutral=function(t){if(U1.test(t)){this.word=t,this.state=Fl;return}if(t==='"'){this.word="",this.state=Wr;return}if(Ul.test(t)){this.word=t,this.state=$l;return}if(os.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};Zt.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===$i)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function B1(t){var e=new Zt(t);return e.output()}function xs(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,s=n.reduce(function(i,a){return qe(a,i),i},r);e&&(t[e]=s)}function qe(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},qe(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&qe(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&qe(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],xs(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],xs(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return qe(t,e[n]);return xs(e,n,t)}}var H1=.017453292519943295;function Rt(t){return t*H1}function ql(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");!t.long0&&t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(t.lat0=Rt(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1):!t.lat_ts&&t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(t.lat_ts=t.lat0,t.lat0=Rt(t.lat0>0?90:-90),delete t.lat1)}function Eo(t){let e={units:null,to_meter:void 0};return typeof t=="string"?(e.units=t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function bo(t){return typeof t=="object"?t.value*t.unit.conversion_factor:t}function Mo(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=bo(t.ellipsoid.semi_major_axis),t.ellipsoid.inverse_flattening!==void 0?e.rf=t.ellipsoid.inverse_flattening:t.ellipsoid.semi_major_axis!==void 0&&t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-bo(t.ellipsoid.semi_minor_axis))))}function zr(t,e={}){return!t||typeof t!="object"?t:t.type==="BoundCRS"?(zr(t.source_crs,e),t.transformation&&(t.transformation.method&&t.transformation.method.name==="NTv2"?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(n=>n.value)),e):(Object.keys(t).forEach(n=>{const r=t[n];if(r!==null)switch(n){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,Mo(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,Mo(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(s=>{const i=s.direction;if(i==="east")return"e";if(i==="north")return"n";if(i==="west")return"w";if(i==="south")return"s";throw new Error(`Unknown axis direction: ${i}`)}).join("")+"u",r.unit){const{units:s,to_meter:i}=Eo(r.unit);e.units=s,e.to_meter=i}else if(r.axis[0]&&r.axis[0].unit){const{units:s,to_meter:i}=Eo(r.axis[0].unit);e.units=s,e.to_meter=i}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(s=>{const i=s.name.toLowerCase().replace(/\s+/g,"_"),a=s.value;s.unit&&s.unit.conversion_factor?e[i]=a*s.unit.conversion_factor:s.unit==="degree"?e[i]=a*Math.PI/180:e[i]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":zr(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),ql(e),e)}var W1=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function z1(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function Bl(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var s=e[n];W1.indexOf(s)!==-1&&V1(t[s]),typeof t[s]=="object"&&Bl(t[s])}}function V1(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,s=t.AXIS.length;r<s;++r){var i=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];i[0].indexOf("north")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="north"?n+="n":i[0].indexOf("south")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="south"?n+="s":i[0].indexOf("east")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="east"?n+="e":(i[0].indexOf("west")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var a=t.GEOGCS;t.type==="GEOGCS"&&(a=t),a&&(a.DATUM?t.datumCode=a.DATUM.name.toLowerCase():t.datumCode=a.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(t.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=a.DATUM.SPHEROID.a,t.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(t.datum_params=a.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Rt(t.rectified_grid_angle));function o(h){var u=t.to_meter||1;return h*u}var c=function(h){return z1(t,h)},l=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Rt],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Rt],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Rt],["lat0","latitude_of_origin",Rt],["lat0","standard_parallel_1",Rt],["lat1","standard_parallel_1",Rt],["lat2","standard_parallel_2",Rt],["azimuth","Azimuth"],["alpha","azimuth",Rt],["srsCode","name"]];l.forEach(c),ql(t)}function Vr(t){if(typeof t=="object")return zr(t);const e=$1(t);var n=B1(t);if(e==="WKT2"){const i=F1(n);return zr(i)}var r=n[0],s={};return qe(n,s),Bl(s),s[r]}function ot(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?ot[t]=ri(arguments[1]):ot[t]=Vr(arguments[1]):n&&typeof n=="object"&&!("projName"in n)?ot[t]=Vr(arguments[1]):(ot[t]=n,n||delete ot[t])}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){return Array.isArray(r)?ot.apply(e,r):ot(r)});if(typeof t=="string"){if(t in ot)return ot[t]}else"EPSG"in t?ot["EPSG:"+t.EPSG]=t:"ESRI"in t?ot["ESRI:"+t.ESRI]=t:"IAU2000"in t?ot["IAU2000:"+t.IAU2000]=t:console.log(t);return}}N1(ot);function J1(t){return typeof t=="string"}function X1(t){return t in ot}function K1(t){return t.indexOf("+")!==0&&t.indexOf("[")!==-1||typeof t=="object"&&!("srsCode"in t)}var Y1=["3857","900913","3785","102113"];function Q1(t){var e=de(t,"authority");if(e){var n=de(e,"epsg");return n&&Y1.indexOf(n)>-1}}function Z1(t){var e=de(t,"extension");if(e)return de(e,"proj4")}function t_(t){return t[0]==="+"}function e_(t){if(J1(t)){if(X1(t))return ot[t];if(K1(t)){var e=Vr(t);if(Q1(e))return ot["EPSG:3857"];var n=Z1(e);return n?ri(n):e}if(t_(t))return ri(t)}else return"projName"in t?t:Vr(t)}function xo(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Dt(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function er(t){return t<0?-1:1}function T(t,e){return e||Math.abs(t)<=tt?t:t-er(t)*On}function jt(t,e,n){var r=t*n,s=.5*t;return r=Math.pow((1-r)/(1+r),s),Math.tan(.5*(b-e))/r}function Fn(t,e){for(var n=.5*t,r,s,i=b-2*Math.atan(e),a=0;a<=15;a++)if(r=t*Math.sin(i),s=b-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-i,i+=s,Math.abs(s)<=1e-10)return i;return-9999}function n_(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Dt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function r_(t){var e=t.x,n=t.y;if(n*mt>90&&n*mt<-90&&e*mt>180&&e*mt<-180)return null;var r,s;if(Math.abs(Math.abs(n)-b)<=w)return null;if(this.sphere)r=this.x0+this.a*this.k0*T(e-this.long0,this.over),s=this.y0+this.a*this.k0*Math.log(Math.tan(U+.5*n));else{var i=Math.sin(n),a=jt(this.e,n,i);r=this.x0+this.a*this.k0*T(e-this.long0,this.over),s=this.y0-this.a*this.k0*Math.log(a)}return t.x=r,t.y=s,t}function s_(t){var e=t.x-this.x0,n=t.y-this.y0,r,s;if(this.sphere)s=b-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var i=Math.exp(-n/(this.a*this.k0));if(s=Fn(this.e,i),s===-9999)return null}return r=T(this.long0+e/(this.a*this.k0),this.over),t.x=r,t.y=s,t}var i_=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const a_={init:n_,forward:r_,inverse:s_,names:i_};function o_(){}function wo(t){return t}var Hl=["longlat","identity"];const c_={init:o_,forward:wo,inverse:wo,names:Hl};var l_=[a_,c_],Se={},Be=[];function Wl(t,e){var n=Be.length;return t.names?(Be[n]=t,t.names.forEach(function(r){Se[r.toLowerCase()]=n}),this):(console.log(e),!0)}function zl(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function u_(t){if(!t)return!1;var e=t.toLowerCase();if(typeof Se[e]<"u"&&Be[Se[e]]||(e=zl(e),e in Se&&Be[Se[e]]))return Be[Se[e]]}function h_(){l_.forEach(Wl)}const f_={start:h_,add:Wl,get:u_};var Vl={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const d_=Vl.WGS84;function p_(t,e,n,r){var s=t*t,i=e*e,a=(s-i)/s,o=0;r?(t*=1-a*(C1+a*(A1+a*G1)),s=t*t,a=0):o=Math.sqrt(a);var c=(s-i)/i;return{es:a,e:o,ep2:c}}function m_(t,e,n,r,s){if(!t){var i=de(Vl,r);i||(i=d_),t=i.a,e=i.b,n=i.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<w)&&(s=!0,e=t),{a:t,b:e,rf:n,sphere:s}}var Cr={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var g_ in Cr){var ws=Cr[g_];ws.datumName&&(Cr[ws.datumName]=ws)}function __(t,e,n,r,s,i,a){var o={};return t===void 0||t==="none"?o.datum_type=ni:o.datum_type=I1,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Ce),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Ae,o.datum_params[3]*=wn,o.datum_params[4]*=wn,o.datum_params[5]*=wn,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=Ve,o.grids=a),o.a=n,o.b=r,o.es=s,o.ep2=i,o}var Di={};function y_(t,e,n){return e instanceof ArrayBuffer?v_(t,e,n):{ready:S_(t,e)}}function v_(t,e,n){var r=!0;n!==void 0&&n.includeErrorFields===!1&&(r=!1);var s=new DataView(e),i=M_(s),a=x_(s,i),o=w_(s,a,i,r),c={header:a,subgrids:o};return Di[t]=c,c}async function S_(t,e){for(var n=[],r=await e.getImageCount(),s=r-1;s>=0;s--){var i=await e.getImage(s),a=await i.readRasters(),o=a,c=[i.getWidth(),i.getHeight()],l=i.getBoundingBox().map(Po),h=[i.fileDirectory.ModelPixelScale[0],i.fileDirectory.ModelPixelScale[1]].map(Po),u=l[0]+(c[0]-1)*h[0],f=l[3]-(c[1]-1)*h[1],d=o[0],p=o[1],_=[];for(let S=c[1]-1;S>=0;S--)for(let M=c[0]-1;M>=0;M--){var m=S*c[0]+M;_.push([-se(p[m]),se(d[m])])}n.push({del:h,lim:c,ll:[-u,f],cvs:_})}var y={header:{nSubgrids:r},subgrids:n};return Di[t]=y,y}function E_(t){if(t===void 0)return null;var e=t.split(",");return e.map(b_)}function b_(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:Di[t]||null,isNull:!1}}function Po(t){return t*Math.PI/180}function se(t){return t/3600*Math.PI/180}function M_(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function x_(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:si(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function si(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function w_(t,e,n,r){for(var s=176,i=[],a=0;a<e.nSubgrids;a++){var o=T_(t,s,n),c=N_(t,s,o,n,r),l=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);i.push({ll:[se(o.lowerLongitude),se(o.lowerLatitude)],del:[se(o.longitudeInterval),se(o.latitudeInterval)],lim:[l,h],count:o.gridNodeCount,cvs:P_(c)});var u=16;r===!1&&(u=8),s+=176+o.gridNodeCount*u}return i}function P_(t){return t.map(function(e){return[se(e.longitudeShift),se(e.latitudeShift)]})}function T_(t,e,n){return{name:si(t,e+8,e+16).trim(),parent:si(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function N_(t,e,n,r,s){var i=e+176,a=16;s===!1&&(a=8);for(var o=[],c=0;c<n.gridNodeCount;c++){var l={latitudeShift:t.getFloat32(i+c*a,r),longitudeShift:t.getFloat32(i+c*a+4,r)};s!==!1&&(l.latitudeAccuracy=t.getFloat32(i+c*a+8,r),l.longitudeAccuracy=t.getFloat32(i+c*a+12,r)),o.push(l)}return o}function Nt(t,e){if(!(this instanceof Nt))return new Nt(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(l){if(l)throw l};var n=e_(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=Nt.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var s=de(Cr,n.datumCode);s&&(n.datum_params=n.datum_params||(s.towgs84?s.towgs84.split(","):null),n.ellps=s.ellipse,n.datumName=s.datumName?s.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var i=m_(n.a,n.b,n.rf,n.ellps,n.sphere),a=p_(i.a,i.b,i.rf,n.R_A),o=E_(n.nadgrids),c=n.datum||__(n.datumCode,n.datum_params,i.a,i.b,a.es,a.ep2,o);xo(this,n),xo(this,r),this.a=i.a,this.b=i.b,this.rf=i.rf,this.sphere=i.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=c,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Nt.projections=f_;Nt.projections.start();function I_(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Ce?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===Ae?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function Jl(t,e,n){var r=t.x,s=t.y,i=t.z?t.z:0,a,o,c,l;if(s<-b&&s>-1.001*b)s=-b;else if(s>b&&s<1.001*b)s=b;else{if(s<-b)return{x:-1/0,y:-1/0,z:t.z};if(s>b)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(s),l=Math.cos(s),c=o*o,a=n/Math.sqrt(1-e*c),{x:(a+i)*l*Math.cos(r),y:(a+i)*l*Math.sin(r),z:(a*(1-e)+i)*o}}function Xl(t,e,n,r){var s=1e-12,i=s*s,a=30,o,c,l,h,u,f,d,p,_,m,y,S,M,N=t.x,I=t.y,v=t.z?t.z:0,E,k,L;if(o=Math.sqrt(N*N+I*I),c=Math.sqrt(N*N+I*I+v*v),o/n<s){if(E=0,c/n<s)return k=b,L=-r,{x:t.x,y:t.y,z:t.z}}else E=Math.atan2(I,N);l=v/c,h=o/c,u=1/Math.sqrt(1-e*(2-e)*h*h),p=h*(1-e)*u,_=l*u,M=0;do M++,d=n/Math.sqrt(1-e*_*_),L=o*p+v*_-d*(1-e*_*_),f=e*d/(d+L),u=1/Math.sqrt(1-f*(2-f)*h*h),m=h*(1-f)*u,y=l*u,S=y*p-m*_,p=m,_=y;while(S*S>i&&M<a);return k=Math.atan(y/Math.abs(m)),{x:E,y:k,z:L}}function k_(t,e,n){if(e===Ce)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===Ae){var r=n[0],s=n[1],i=n[2],a=n[3],o=n[4],c=n[5],l=n[6];return{x:l*(t.x-c*t.y+o*t.z)+r,y:l*(c*t.x+t.y-a*t.z)+s,z:l*(-o*t.x+a*t.y+t.z)+i}}}function C_(t,e,n){if(e===Ce)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===Ae){var r=n[0],s=n[1],i=n[2],a=n[3],o=n[4],c=n[5],l=n[6],h=(t.x-r)/l,u=(t.y-s)/l,f=(t.z-i)/l;return{x:h+c*u-o*f,y:-c*h+u+a*f,z:o*h-a*u+f}}}function gr(t){return t===Ce||t===Ae}function A_(t,e,n){if(I_(t,e)||t.datum_type===ni||e.datum_type===ni)return n;var r=t.a,s=t.es;if(t.datum_type===Ve){var i=To(t,!1,n);if(i!==0)return;r=yo,s=vo}var a=e.a,o=e.b,c=e.es;if(e.datum_type===Ve&&(a=yo,o=k1,c=vo),s===c&&r===a&&!gr(t.datum_type)&&!gr(e.datum_type))return n;if(n=Jl(n,s,r),gr(t.datum_type)&&(n=k_(n,t.datum_type,t.datum_params)),gr(e.datum_type)&&(n=C_(n,e.datum_type,e.datum_params)),n=Xl(n,c,a,o),e.datum_type===Ve){var l=To(e,!0,n);if(l!==0)return}return n}function To(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},s={x:Number.NaN,y:Number.NaN},i=[];t:for(var a=0;a<t.grids.length;a++){var o=t.grids[a];if(i.push(o.name),o.isNull){s=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var c=o.grid.subgrids,l=0,h=c.length;l<h;l++){var u=c[l],f=(Math.abs(u.del[1])+Math.abs(u.del[0]))/1e4,d=u.ll[0]-f,p=u.ll[1]-f,_=u.ll[0]+(u.lim[0]-1)*u.del[0]+f,m=u.ll[1]+(u.lim[1]-1)*u.del[1]+f;if(!(p>r.y||d>r.x||m<r.y||_<r.x)&&(s=G_(r,e,u),!isNaN(s.x)))break t}}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*mt+" "+r.y*mt+" tried: '"+i+"'"),-1):(n.x=-s.x,n.y=s.y,0)}function G_(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var s={x:t.x,y:t.y};s.x-=n.ll[0],s.y-=n.ll[1],s.x=T(s.x-Math.PI)+Math.PI;var i=No(s,n);if(e){if(isNaN(i.x))return r;i.x=s.x-i.x,i.y=s.y-i.y;var a=9,o=1e-12,c,l;do{if(l=No(i,n),isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}c={x:s.x-(l.x+i.x),y:s.y-(l.y+i.y)},i.x+=c.x,i.y+=c.y}while(a--&&Math.abs(c.x)>o&&Math.abs(c.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=T(i.x+n.ll[0]),r.y=i.y+n.ll[1]}else isNaN(i.x)||(r.x=t.x+i.x,r.y=t.y+i.y);return r}function No(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},s={x:n.x-1*r.x,y:n.y-1*r.y},i={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return i;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var c={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var l={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},u=s.x*s.y,f=s.x*(1-s.y),d=(1-s.x)*(1-s.y),p=(1-s.x)*s.y;return i.x=d*o.x+f*c.x+p*h.x+u*l.x,i.y=d*o.y+f*c.y+p*h.y+u*l.y,i}function Io(t,e,n){var r=n.x,s=n.y,i=n.z||0,a,o,c,l={};for(c=0;c<3;c++)if(!(e&&c===2&&n.z===void 0))switch(c===0?(a=r,"ew".indexOf(t.axis[c])!==-1?o="x":o="y"):c===1?(a=s,"ns".indexOf(t.axis[c])!==-1?o="y":o="x"):(a=i,o="z"),t.axis[c]){case"e":l[o]=a;break;case"w":l[o]=-a;break;case"n":l[o]=a;break;case"s":l[o]=-a;break;case"u":n[o]!==void 0&&(l.z=a);break;case"d":n[o]!==void 0&&(l.z=-a);break;default:return null}return l}function Kl(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function R_(t){ko(t.x),ko(t.y)}function ko(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function L_(t,e){return(t.datum.datum_type===Ce||t.datum.datum_type===Ae||t.datum.datum_type===Ve)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Ce||e.datum.datum_type===Ae||e.datum.datum_type===Ve)&&t.datumCode!=="WGS84"}function Jr(t,e,n,r){var s;Array.isArray(n)?n=Kl(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var i=n.z!==void 0;if(R_(n),t.datum&&e.datum&&L_(t,e)&&(s=new Nt("WGS84"),n=Jr(t,s,n,r),t=s),r&&t.axis!=="enu"&&(n=Io(t,!1,n)),t.projName==="longlat")n={x:n.x*Q,y:n.y*Q,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=A_(t.datum,e.datum,n),!!n)return n=n,e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*mt,y:n.y*mt,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?Io(e,!0,n):(n&&!i&&delete n.z,n)}var Co=Nt("WGS84");function Ps(t,e,n,r){var s,i,a;return Array.isArray(n)?(s=Jr(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof s.z=="number"?[s.x,s.y,s.z].concat(n.slice(3)):[s.x,s.y,n[2]].concat(n.slice(3)):[s.x,s.y].concat(n.slice(2)):[s.x,s.y]):(i=Jr(t,e,n,r),a=Object.keys(n),a.length===2||a.forEach(function(o){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;i[o]=n[o]}),i)}function _r(t){return t instanceof Nt?t:typeof t=="object"&&"oProj"in t?t.oProj:Nt(t)}function O_(t,e,n){var r,s,i=!1,a;return typeof e>"u"?(s=_r(t),r=Co,i=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,s=_r(t),r=Co,i=!0),r||(r=_r(t)),s||(s=_r(e)),n?Ps(r,s,n):(a={forward:function(o,c){return Ps(r,s,o,c)},inverse:function(o,c){return Ps(s,r,o,c)}},i&&(a.oProj=s),a)}var Ao=6,Yl="AJSAJS",Ql="AFAFAF",He=65,dt=73,wt=79,En=86,bn=90;const j_={forward:Zl,inverse:F_,toPoint:tu};function Zl(t,e){return e=e||5,U_($_({lat:t[1],lon:t[0]}),e)}function F_(t){var e=Ui(nu(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function tu(t){var e=Ui(nu(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Ts(t){return t*(Math.PI/180)}function Go(t){return 180*(t/Math.PI)}function $_(t){var e=t.lat,n=t.lon,r=6378137,s=.00669438,i=.9996,a,o,c,l,h,u,f,d=Ts(e),p=Ts(n),_,m;m=Math.floor((n+180)/6)+1,n===180&&(m=60),e>=56&&e<64&&n>=3&&n<12&&(m=32),e>=72&&e<84&&(n>=0&&n<9?m=31:n>=9&&n<21?m=33:n>=21&&n<33?m=35:n>=33&&n<42&&(m=37)),a=(m-1)*6-180+3,_=Ts(a),o=s/(1-s),c=r/Math.sqrt(1-s*Math.sin(d)*Math.sin(d)),l=Math.tan(d)*Math.tan(d),h=o*Math.cos(d)*Math.cos(d),u=Math.cos(d)*(p-_),f=r*((1-s/4-3*s*s/64-5*s*s*s/256)*d-(3*s/8+3*s*s/32+45*s*s*s/1024)*Math.sin(2*d)+(15*s*s/256+45*s*s*s/1024)*Math.sin(4*d)-35*s*s*s/3072*Math.sin(6*d));var y=i*c*(u+(1-l+h)*u*u*u/6+(5-18*l+l*l+72*h-58*o)*u*u*u*u*u/120)+5e5,S=i*(f+c*Math.tan(d)*(u*u/2+(5-l+9*h+4*h*h)*u*u*u*u/24+(61-58*l+l*l+600*h-330*o)*u*u*u*u*u*u/720));return e<0&&(S+=1e7),{northing:Math.round(S),easting:Math.round(y),zoneNumber:m,zoneLetter:D_(e)}}function Ui(t){var e=t.northing,n=t.easting,r=t.zoneLetter,s=t.zoneNumber;if(s<0||s>60)return null;var i=.9996,a=6378137,o=.00669438,c,l=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,u,f,d,p,_,m,y,S,M=n-5e5,N=e;r<"N"&&(N-=1e7),m=(s-1)*6-180+3,c=o/(1-o),_=N/i,y=_/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),S=y+(3*l/2-27*l*l*l/32)*Math.sin(2*y)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*y)+151*l*l*l/96*Math.sin(6*y),h=a/Math.sqrt(1-o*Math.sin(S)*Math.sin(S)),u=Math.tan(S)*Math.tan(S),f=c*Math.cos(S)*Math.cos(S),d=a*(1-o)/Math.pow(1-o*Math.sin(S)*Math.sin(S),1.5),p=M/(h*i);var I=S-h*Math.tan(S)/d*(p*p/2-(5+3*u+10*f-4*f*f-9*c)*p*p*p*p/24+(61+90*u+298*f+45*u*u-252*c-3*f*f)*p*p*p*p*p*p/720);I=Go(I);var v=(p-(1+2*u+f)*p*p*p/6+(5-2*f+28*u-3*f*f+8*c+24*u*u)*p*p*p*p*p/120)/Math.cos(S);v=m+Go(v);var E;if(t.accuracy){var k=Ui({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});E={top:k.lat,right:k.lon,bottom:I,left:v}}else E={lat:I,lon:v};return E}function D_(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function U_(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+q_(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function q_(t,e,n){var r=eu(n),s=Math.floor(t/1e5),i=Math.floor(e/1e5)%20;return B_(s,i,r)}function eu(t){var e=t%Ao;return e===0&&(e=Ao),e}function B_(t,e,n){var r=n-1,s=Yl.charCodeAt(r),i=Ql.charCodeAt(r),a=s+t-1,o=i+e,c=!1;a>bn&&(a=a-bn+He-1,c=!0),(a===dt||s<dt&&a>dt||(a>dt||s<dt)&&c)&&a++,(a===wt||s<wt&&a>wt||(a>wt||s<wt)&&c)&&(a++,a===dt&&a++),a>bn&&(a=a-bn+He-1),o>En?(o=o-En+He-1,c=!0):c=!1,(o===dt||i<dt&&o>dt||(o>dt||i<dt)&&c)&&o++,(o===wt||i<wt&&o>wt||(o>wt||i<wt)&&c)&&(o++,o===dt&&o++),o>En&&(o=o-En+He-1);var l=String.fromCharCode(a)+String.fromCharCode(o);return l}function nu(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",s,i=0;!/[A-Z]/.test(s=t.charAt(i));){if(i>=2)throw"MGRSPoint bad conversion from: "+t;r+=s,i++}var a=parseInt(r,10);if(i===0||i+3>e)throw"MGRSPoint bad conversion from: "+t;var o=t.charAt(i++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+t;n=t.substring(i,i+=2);for(var c=eu(a),l=H_(n.charAt(0),c),h=W_(n.charAt(1),c);h<z_(o);)h+=2e6;var u=e-i;if(u%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var f=u/2,d=0,p=0,_,m,y,S,M;return f>0&&(_=1e5/Math.pow(10,f),m=t.substring(i,i+f),d=parseFloat(m)*_,y=t.substring(i+f),p=parseFloat(y)*_),S=d+l,M=p+h,{easting:S,northing:M,zoneLetter:o,zoneNumber:a,accuracy:_}}function H_(t,e){for(var n=Yl.charCodeAt(e-1),r=1e5,s=!1;n!==t.charCodeAt(0);){if(n++,n===dt&&n++,n===wt&&n++,n>bn){if(s)throw"Bad character: "+t;n=He,s=!0}r+=1e5}return r}function W_(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=Ql.charCodeAt(e-1),r=0,s=!1;n!==t.charCodeAt(0);){if(n++,n===dt&&n++,n===wt&&n++,n>En){if(s)throw"Bad character: "+t;n=He,s=!0}r+=1e5}return r}function z_(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function nn(t,e,n){if(!(this instanceof nn))return new nn(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}nn.fromMGRS=function(t){return new nn(tu(t))};nn.prototype.toMGRS=function(t){return Zl([this.x,this.y],t)};var V_=1,J_=.25,Ro=.046875,Lo=.01953125,Oo=.01068115234375,X_=.75,K_=.46875,Y_=.013020833333333334,Q_=.007120768229166667,Z_=.3645833333333333,ty=.005696614583333333,ey=.3076171875;function qi(t){var e=[];e[0]=V_-t*(J_+t*(Ro+t*(Lo+t*Oo))),e[1]=t*(X_-t*(Ro+t*(Lo+t*Oo)));var n=t*t;return e[2]=n*(K_-t*(Y_+t*Q_)),n*=t,e[3]=n*(Z_-t*ty),e[4]=n*t*ey,e}function gn(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var ny=20;function Bi(t,e,n){for(var r=1/(1-e),s=t,i=ny;i;--i){var a=Math.sin(s),o=1-e*a*a;if(o=(gn(s,a,Math.cos(s),n)-t)*(o*Math.sqrt(o))*r,s-=o,Math.abs(o)<w)return s}return s}function ry(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=qi(this.es),this.ml0=gn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function sy(t){var e=t.x,n=t.y,r=T(e-this.long0,this.over),s,i,a,o=Math.sin(n),c=Math.cos(n);if(this.es){var h=c*r,u=Math.pow(h,2),f=this.ep2*Math.pow(c,2),d=Math.pow(f,2),p=Math.abs(c)>w?Math.tan(n):0,_=Math.pow(p,2),m=Math.pow(_,2);s=1-this.es*Math.pow(o,2),h=h/Math.sqrt(s);var y=gn(n,o,c,this.en);i=this.a*(this.k0*h*(1+u/6*(1-_+f+u/20*(5-18*_+m+14*f-58*_*f+u/42*(61+179*m-m*_-479*_)))))+this.x0,a=this.a*(this.k0*(y-this.ml0+o*r*h/2*(1+u/12*(5-_+9*f+4*d+u/30*(61+m-58*_+270*f-330*_*f+u/56*(1385+543*m-m*_-3111*_))))))+this.y0}else{var l=c*Math.sin(r);if(Math.abs(Math.abs(l)-1)<w)return 93;if(i=.5*this.a*this.k0*Math.log((1+l)/(1-l))+this.x0,a=c*Math.cos(r)/Math.sqrt(1-Math.pow(l,2)),l=Math.abs(a),l>=1){if(l-1>w)return 93;a=0}else a=Math.acos(a);n<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return t.x=i,t.y=a,t}function iy(t){var e,n,r,s,i=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,n=Bi(e,this.es,this.en),Math.abs(n)<b){var u=Math.sin(n),f=Math.cos(n),d=Math.abs(f)>w?Math.tan(n):0,p=this.ep2*Math.pow(f,2),_=Math.pow(p,2),m=Math.pow(d,2),y=Math.pow(m,2);e=1-this.es*Math.pow(u,2);var S=i*Math.sqrt(e)/this.k0,M=Math.pow(S,2);e=e*d,r=n-e*M/(1-this.es)*.5*(1-M/12*(5+3*m-9*p*m+p-4*_-M/30*(61+90*m-252*p*m+45*y+46*p-M/56*(1385+3633*m+4095*y+1574*y*m)))),s=T(this.long0+S*(1-M/6*(1+2*m+p-M/20*(5+28*m+24*y+8*p*m+6*p-M/42*(61+662*m+1320*y+720*y*m))))/f,this.over)}else r=b*er(a),s=0;else{var o=Math.exp(i/this.k0),c=.5*(o-1/o),l=this.lat0+a/this.k0,h=Math.cos(l);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(c,2))),r=Math.asin(e),a<0&&(r=-r),c===0&&h===0?s=0:s=T(Math.atan2(c,h)+this.long0,this.over)}return t.x=s,t.y=r,t}var ay=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Ar={init:ry,forward:sy,inverse:iy,names:ay};function ru(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function pt(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function oy(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function cy(t){var e=Math.abs(t);return e=oy(e*(1+e/(pt(1,e)+1))),t<0?-e:e}function Hi(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,s=t[r],i=0,a;--r>=0;)a=-i+n*s+t[r],i=s,s=a;return e+a*Math.sin(2*e)}function ly(t,e){for(var n=2*Math.cos(e),r=t.length-1,s=t[r],i=0,a;--r>=0;)a=-i+n*s+t[r],i=s,s=a;return Math.sin(e)*a}function uy(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function su(t,e,n){for(var r=Math.sin(e),s=Math.cos(e),i=ru(n),a=uy(n),o=2*s*a,c=-2*r*i,l=t.length-1,h=t[l],u=0,f=0,d=0,p,_;--l>=0;)p=f,_=u,f=h,u=d,h=-p+o*f-c*u+t[l],d=-_+c*f+o*u;return o=r*a,c=s*i,[o*h-c*d,o*d+c*h]}function hy(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Ar.init.apply(this),this.forward=Ar.forward,this.inverse=Ar.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=Hi(this.cbg,this.lat0);this.Zb=-this.Qn*(r+ly(this.gtu,2*r))}function fy(t){var e=T(t.x-this.long0,this.over),n=t.y;n=Hi(this.cbg,n);var r=Math.sin(n),s=Math.cos(n),i=Math.sin(e),a=Math.cos(e);n=Math.atan2(r,a*s),e=Math.atan2(i*s,pt(r,s*a)),e=cy(Math.tan(e));var o=su(this.gtu,2*n,2*e);n=n+o[0],e=e+o[1];var c,l;return Math.abs(e)<=2.623395162778?(c=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(c=1/0,l=1/0),t.x=c,t.y=l,t}function dy(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,s;if(Math.abs(e)<=2.623395162778){var i=su(this.utg,2*n,2*e);n=n+i[0],e=e+i[1],e=Math.atan(ru(e));var a=Math.sin(n),o=Math.cos(n),c=Math.sin(e),l=Math.cos(e);n=Math.atan2(a*l,pt(c,l*o)),e=Math.atan2(c,l*o),r=T(e+this.long0,this.over),s=Hi(this.cgb,n)}else r=1/0,s=1/0;return t.x=r,t.y=s,t}var py=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Gr={init:hy,forward:fy,inverse:dy,names:py};function my(t,e){if(t===void 0){if(t=Math.floor((T(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var gy="etmerc";function _y(){var t=my(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Q,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Gr.init.apply(this),this.forward=Gr.forward,this.inverse=Gr.inverse}var yy=["Universal Transverse Mercator System","utm"];const vy={init:_y,names:yy,dependsOn:gy};function Wi(t,e){return Math.pow((1-t)/(1+t),e)}var Sy=20;function Ey(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+U)/(Math.pow(Math.tan(.5*this.lat0+U),this.C)*Wi(this.e*t,this.ratexp))}function by(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+U),this.C)*Wi(this.e*Math.sin(n),this.ratexp))-b,t.x=this.C*e,t}function My(t){for(var e=1e-14,n=t.x/this.C,r=t.y,s=Math.pow(Math.tan(.5*r+U)/this.K,1/this.C),i=Sy;i>0&&(r=2*Math.atan(s*Wi(this.e*Math.sin(t.y),-.5*this.e))-b,!(Math.abs(r-t.y)<e));--i)t.y=r;return i?(t.x=n,t.y=r,t):null}const zi={init:Ey,forward:by,inverse:My};function xy(){zi.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function wy(t){var e,n,r,s;return t.x=T(t.x-this.long0,this.over),zi.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),s=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=s*n*Math.sin(t.x),t.y=s*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Py(t){var e,n,r,s,i;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,i=pt(t.x,t.y)){var a=2*Math.atan2(i,this.R2);e=Math.sin(a),n=Math.cos(a),s=Math.asin(n*this.sinc0+t.y*e*this.cosc0/i),r=Math.atan2(t.x*e,i*this.cosc0*n-t.y*this.sinc0*e)}else s=this.phic0,r=0;return t.x=r,t.y=s,zi.inverse.apply(this,[t]),t.x=T(t.x+this.long0,this.over),t}var Ty=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Ny={init:xy,forward:wy,inverse:Py,names:Ty};function Vi(t,e,n){return e*=n,Math.tan(.5*(b+t))*Math.pow((1-e)/(1+e),.5*n)}function Iy(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=w&&(this.k0=.5*(1+er(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=w&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=w&&Math.abs(Math.cos(this.lat_ts))>w&&(this.k0=.5*this.cons*Dt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/jt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Dt(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(Vi(this.lat0,this.sinlat0,this.e))-b,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function ky(t){var e=t.x,n=t.y,r=Math.sin(n),s=Math.cos(n),i,a,o,c,l,h,u=T(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=w&&Math.abs(n+this.lat0)<=w?(t.x=NaN,t.y=NaN,t):this.sphere?(i=2*this.k0/(1+this.sinlat0*r+this.coslat0*s*Math.cos(u)),t.x=this.a*i*s*Math.sin(u)+this.x0,t.y=this.a*i*(this.coslat0*r-this.sinlat0*s*Math.cos(u))+this.y0,t):(a=2*Math.atan(Vi(n,r,this.e))-b,c=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=w?(l=jt(this.e,n*this.con,this.con*r),h=2*this.a*this.k0*l/this.cons,t.x=this.x0+h*Math.sin(e-this.long0),t.y=this.y0-this.con*h*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<w?(i=2*this.a*this.k0/(1+c*Math.cos(u)),t.y=i*o):(i=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*c*Math.cos(u))),t.y=i*(this.cosX0*o-this.sinX0*c*Math.cos(u))+this.y0),t.x=i*c*Math.sin(u)+this.x0,t))}function Cy(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,s,i,a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,n=this.lat0,a<=w?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<w?this.lat0>0?e=T(this.long0+Math.atan2(t.x,-1*t.y),this.over):e=T(this.long0+Math.atan2(t.x,t.y),this.over):e=T(this.long0+Math.atan2(t.x*Math.sin(o),a*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o)),this.over),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=w){if(a<=w)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=a*this.cons/(2*this.a*this.k0),n=this.con*Fn(this.e,r),e=this.con*T(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else s=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=w?i=this.X0:(i=Math.asin(Math.cos(s)*this.sinX0+t.y*Math.sin(s)*this.cosX0/a),e=T(this.long0+Math.atan2(t.x*Math.sin(s),a*this.cosX0*Math.cos(s)-t.y*this.sinX0*Math.sin(s)),this.over)),n=-1*Fn(this.e,Math.tan(.5*(b+i)));return t.x=e,t.y=n,t}var Ay=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Gy={init:Iy,forward:ky,inverse:Cy,names:Ay,ssfn_:Vi};function Ry(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,s=1/r,i=2*s-Math.pow(s,2),a=this.e=Math.sqrt(i);this.R=this.k0*n*Math.sqrt(1-i)/(1-i*Math.pow(e,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),c=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*c+this.alpha*a/2*l}function Ly(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,s=2*(Math.atan(Math.exp(r))-Math.PI/4),i=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(i)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(i))),o=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(i));return t.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,t.x=this.R*a+this.x0,t}function Oy(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,s=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),i=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(s))),o=this.lambda0+a/this.alpha,c=0,l=i,h=-1e3,u=0;Math.abs(l-h)>1e-7;){if(++u>20)return;c=1/this.alpha*(Math.log(Math.tan(Math.PI/4+i/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(c))-Math.PI/2}return t.x=o,t.y=l,t}var jy=["somerc"];const Fy={init:Ry,forward:Ly,inverse:Oy,names:jy};var $e=1e-7;function $y(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.projName=="object"?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1||e.indexOf(zl(n))!==-1}function Dy(){var t,e,n,r,s,i,a,o,c,l,h=0,u,f=0,d=0,p=0,_=0,m=0,y=0;this.no_off=$y(this),this.no_rot="no_rot"in this;var S=!1;"alpha"in this&&(S=!0);var M=!1;if("rectified_grid_angle"in this&&(M=!0),S&&(y=this.alpha),M&&(h=this.rectified_grid_angle),S||M)f=this.longc;else if(d=this.long1,_=this.lat1,p=this.long2,m=this.lat2,Math.abs(_-m)<=$e||(t=Math.abs(_))<=$e||Math.abs(t-b)<=$e||Math.abs(Math.abs(this.lat0)-b)<=$e||Math.abs(Math.abs(m)-b)<=$e)throw new Error;var N=1-this.es;e=Math.sqrt(N),Math.abs(this.lat0)>w?(o=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*o*o,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),s=r*r-1,s<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=r,this.E*=Math.pow(jt(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=s=1),S||M?(S?(u=Math.asin(Math.sin(y)/r),M||(h=y)):(u=h,y=Math.asin(r*Math.sin(u))),this.lam0=f-Math.asin(.5*(s-1/s)*Math.tan(u))/this.B):(i=Math.pow(jt(this.e,_,Math.sin(_)),this.B),a=Math.pow(jt(this.e,m,Math.sin(m)),this.B),s=this.E/i,c=(a-i)/(a+i),l=this.E*this.E,l=(l-a*i)/(l+a*i),t=d-p,t<-Math.PI?p-=On:t>Math.PI&&(p+=On),this.lam0=T(.5*(d+p)-Math.atan(l*Math.tan(.5*this.B*(d-p))/c)/this.B,this.over),u=Math.atan(2*Math.sin(this.B*T(d-this.lam0,this.over))/(s-1/s)),h=y=Math.asin(r*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(y))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(U-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(U+s))}function Uy(t){var e={},n,r,s,i,a,o,c,l;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-b)>w){if(a=this.E/Math.pow(jt(this.e,t.y,Math.sin(t.y)),this.B),o=1/a,n=.5*(a-o),r=.5*(a+o),i=Math.sin(this.B*t.x),s=(n*this.singam-i*this.cosgam)/r,Math.abs(Math.abs(s)-1)<w)throw new Error;l=.5*this.ArB*Math.log((1-s)/(1+s)),o=Math.cos(this.B*t.x),Math.abs(o)<$e?c=this.A*t.x:c=this.ArB*Math.atan2(n*this.cosgam+i*this.singam,o)}else l=t.y>0?this.v_pole_n:this.v_pole_s,c=this.ArB*t.y;return this.no_rot?(e.x=c,e.y=l):(c-=this.u_0,e.x=l*this.cosrot+c*this.sinrot,e.y=c*this.cosrot-l*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function qy(t){var e,n,r,s,i,a,o,c={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),s=.5*(r-1/r),i=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+s*this.singam)/i,Math.abs(Math.abs(o)-1)<w)c.x=0,c.y=o<0?-b:b;else{if(c.y=this.E/Math.sqrt((1+o)/(1-o)),c.y=Fn(this.e,Math.pow(c.y,1/this.B)),c.y===1/0)throw new Error;c.x=-this.rB*Math.atan2(s*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return c.x+=this.lam0,c}var By=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Hy={init:Dy,forward:Uy,inverse:qy,names:By};function Wy(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<w)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Dt(this.e,e,n),s=jt(this.e,this.lat1,e),i=Math.sin(this.lat2),a=Math.cos(this.lat2),o=Dt(this.e,i,a),c=jt(this.e,this.lat2,i),l=Math.abs(Math.abs(this.lat0)-b)<w?0:jt(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>w?this.ns=Math.log(r/o)/Math.log(s/c):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function zy(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=w&&(n=er(n)*(b-2*w));var r=Math.abs(Math.abs(n)-b),s,i;if(r>w)s=jt(this.e,n,Math.sin(n)),i=this.a*this.f0*Math.pow(s,this.ns);else{if(r=n*this.ns,r<=0)return null;i=0}var a=this.ns*T(e-this.long0,this.over);return t.x=this.k0*(i*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-i*Math.cos(a))+this.y0,t}function Vy(t){var e,n,r,s,i,a=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),n=1):(e=-Math.sqrt(a*a+o*o),n=-1);var c=0;if(e!==0&&(c=Math.atan2(n*a,n*o)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),s=Fn(this.e,r),s===-9999)return null}else s=-b;return i=T(c/this.ns+this.long0,this.over),t.x=i,t.y=s,t}var Jy=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Xy={init:Wy,forward:zy,inverse:Vy,names:Jy};function Ky(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Yy(t){var e,n,r,s,i,a,o,c=t.x,l=t.y,h=T(c-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(s)),a=this.n*i,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),t.y=o*Math.cos(a)/1,t.x=o*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t}function Qy(t){var e,n,r,s,i,a,o,c,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),a=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.atan2(t.y,t.x),s=i/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(s)),n=Math.asin(Math.cos(r)*Math.sin(s)/Math.cos(e)),t.x=this.long0-n/this.alfa,o=e,c=0;var h=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(c=1),o=t.y,h+=1;while(c===0&&h<15);return h>=15?null:t}var Zy=["Krovak","krovak"];const t2={init:Ky,forward:Yy,inverse:Qy,names:Zy};function ut(t,e,n,r,s){return t*s-e*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)}function nr(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function rr(t){return .375*t*(1+.25*t*(1+.46875*t))}function sr(t){return .05859375*t*t*(1+.75*t)}function ir(t){return t*t*t*(35/3072)}function Ji(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function ve(t){return Math.abs(t)<b?t:t-er(t)*Math.PI}function Xr(t,e,n,r,s){var i,a;i=t/e;for(var o=0;o<15;o++)if(a=(t-(e*i-n*Math.sin(2*i)+r*Math.sin(4*i)-s*Math.sin(6*i)))/(e-2*n*Math.cos(2*i)+4*r*Math.cos(4*i)-6*s*Math.cos(6*i)),i+=a,Math.abs(a)<=1e-10)return i;return NaN}function e2(){this.sphere||(this.e0=nr(this.es),this.e1=rr(this.es),this.e2=sr(this.es),this.e3=ir(this.es),this.ml0=this.a*ut(this.e0,this.e1,this.e2,this.e3,this.lat0))}function n2(t){var e,n,r=t.x,s=t.y;if(r=T(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(s)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(s),Math.cos(r))-this.lat0);else{var i=Math.sin(s),a=Math.cos(s),o=Ji(this.a,this.e,i),c=Math.tan(s)*Math.tan(s),l=r*Math.cos(s),h=l*l,u=this.es*a*a/(1-this.es),f=this.a*ut(this.e0,this.e1,this.e2,this.e3,s);e=o*l*(1-h*c*(1/6-(8-c+8*u)*h/120)),n=f-this.ml0+o*i/a*h*(.5+(5-c+6*u)*h/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function r2(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,s;if(this.sphere){var i=n+this.lat0;r=Math.asin(Math.sin(i)*Math.cos(e)),s=Math.atan2(Math.tan(e),Math.cos(i))}else{var a=this.ml0/this.a+n,o=Xr(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-b)<=w)return t.x=this.long0,t.y=b,n<0&&(t.y*=-1),t;var c=Ji(this.a,this.e,Math.sin(o)),l=c*c*c/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),u=e*this.a/c,f=u*u;r=o-c*Math.tan(o)/l*u*u*(.5-(1+3*h)*u*u/24),s=u*(1-f*(h/3+(1+3*h)*h*f/15))/Math.cos(o)}return t.x=T(s+this.long0,this.over),t.y=ve(r),t}var s2=["Cassini","Cassini_Soldner","cass"];const i2={init:e2,forward:n2,inverse:r2,names:s2};function le(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var ii=1,ai=2,oi=3,Rr=4;function a2(){var t=Math.abs(this.lat0);if(Math.abs(t-b)<w?this.mode=this.lat0<0?ii:ai:Math.abs(t)<w?this.mode=oi:this.mode=Rr,this.es>0){var e;switch(this.qp=le(this.e,1),this.mmf=.5/(1-this.es),this.apa=m2(this.es),this.mode){case ai:this.dd=1;break;case ii:this.dd=1;break;case oi:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case Rr:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=le(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===Rr&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function o2(t){var e,n,r,s,i,a,o,c,l,h,u=t.x,f=t.y;if(u=T(u-this.long0,this.over),this.sphere){if(i=Math.sin(f),h=Math.cos(f),r=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+h*r:1+this.sinph0*i+this.cosph0*h*r,n<=w)return null;n=Math.sqrt(2/n),e=n*h*Math.sin(u),n*=this.mode===this.EQUIT?i:this.cosph0*i-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<w)return null;n=U-f*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(u),n*=r}}else{switch(o=0,c=0,l=0,r=Math.cos(u),s=Math.sin(u),i=Math.sin(f),a=le(this.e,i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,c=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:l=1+this.sinb1*o+this.cosb1*c*r;break;case this.EQUIT:l=1+c*r;break;case this.N_POLE:l=b+f,a=this.qp-a;break;case this.S_POLE:l=f-b,a=this.qp+a;break}if(Math.abs(l)<w)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),this.mode===this.OBLIQ?n=this.ymf*l*(this.cosb1*o-this.sinb1*c*r):n=(l=Math.sqrt(2/(1+c*r)))*o*this.ymf,e=this.xmf*l*c*s;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(l=Math.sqrt(a))*s,n=r*(this.mode===this.S_POLE?l:-l)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function c2(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,s,i,a,o,c,l;if(this.sphere){var h=0,u,f=0;if(u=Math.sqrt(e*e+n*n),s=u*.5,s>1)return null;switch(s=2*Math.asin(s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(s),h=Math.cos(s)),this.mode){case this.EQUIT:s=Math.abs(u)<=w?0:Math.asin(n*f/u),e*=f,n=h*u;break;case this.OBLIQ:s=Math.abs(u)<=w?this.lat0:Math.asin(h*this.sinph0+n*f*this.cosph0/u),e*=f*this.cosph0,n=(h-Math.sin(s)*this.sinph0)*u;break;case this.N_POLE:n=-n,s=b-s;break;case this.S_POLE:s-=b;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,c=Math.sqrt(e*e+n*n),c<w)return t.x=this.long0,t.y=this.lat0,t;a=2*Math.asin(.5*c/this.rq),i=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(l=i*this.sinb1+n*a*this.cosb1/c,o=this.qp*l,n=c*this.cosb1*i-n*this.sinb1*a):(l=n*a/c,o=this.qp*l,n=c*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),o=e*e+n*n,!o)return t.x=this.long0,t.y=this.lat0,t;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}r=Math.atan2(e,n),s=g2(Math.asin(l),this.apa)}return t.x=T(this.long0+r,this.over),t.y=s,t}var l2=.3333333333333333,u2=.17222222222222222,h2=.10257936507936508,f2=.06388888888888888,d2=.0664021164021164,p2=.016415012942191543;function m2(t){var e,n=[];return n[0]=t*l2,e=t*t,n[0]+=e*u2,n[1]=e*f2,e*=t,n[0]+=e*h2,n[1]+=e*d2,n[2]=e*p2,n}function g2(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var _2=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const y2={init:a2,forward:o2,inverse:c2,names:_2,S_POLE:ii,N_POLE:ai,EQUIT:oi,OBLIQ:Rr};function pe(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function v2(){Math.abs(this.lat1+this.lat2)<w||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Dt(this.e3,this.sin_po,this.cos_po),this.qs1=le(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Dt(this.e3,this.sin_po,this.cos_po),this.qs2=le(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=le(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>w?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function S2(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=le(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,i=this.ns0*T(e-this.long0,this.over),a=s*Math.sin(i)+this.x0,o=this.rh-s*Math.cos(i)+this.y0;return t.x=a,t.y=o,t}function E2(t){var e,n,r,s,i,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),s=0,e!==0&&(s=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,n)),i=T(s/this.ns0+this.long0,this.over),t.x=i,t.y=a,t}function b2(t,e){var n,r,s,i,a,o=pe(.5*e);if(t<w)return o;for(var c=t*t,l=1;l<=25;l++)if(n=Math.sin(o),r=Math.cos(o),s=t*n,i=1-s*s,a=.5*i*i/r*(e/(1-c)-n/i+.5/t*Math.log((1-s)/(1+s))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var M2=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const x2={init:v2,forward:S2,inverse:E2,names:M2,phi1z:b2};function w2(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function P2(t){var e,n,r,s,i,a,o,c,l=t.x,h=t.y;return r=T(l-this.long0,this.over),e=Math.sin(h),n=Math.cos(h),s=Math.cos(r),a=this.sin_p14*e+this.cos_p14*n*s,i=1,a>0||Math.abs(a)<=w?(o=this.x0+this.a*i*n*Math.sin(r)/a,c=this.y0+this.a*i*(this.cos_p14*e-this.sin_p14*n*s)/a):(o=this.x0+this.infinity_dist*n*Math.sin(r),c=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*s)),t.x=o,t.y=c,t}function T2(t){var e,n,r,s,i,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(s=Math.atan2(e,this.rc),n=Math.sin(s),r=Math.cos(s),a=pe(r*this.sin_p14+t.y*n*this.cos_p14/e),i=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),i=T(this.long0+i,this.over)):(a=this.phic0,i=0),t.x=i,t.y=a,t}var N2=["gnom"];const I2={init:w2,forward:P2,inverse:T2,names:N2};function k2(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*b:b;for(var r=Math.asin(.5*e),s,i,a,o,c=0;c<30;c++)if(i=Math.sin(r),a=Math.cos(r),o=t*i,s=Math.pow(1-o*o,2)/(2*a)*(e/(1-t*t)-i/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),r+=s,Math.abs(s)<=1e-10)return r;return NaN}function C2(){this.sphere||(this.k0=Dt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function A2(t){var e=t.x,n=t.y,r,s,i=T(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*i*Math.cos(this.lat_ts),s=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var a=le(this.e,Math.sin(n));r=this.x0+this.a*this.k0*i,s=this.y0+this.a*a*.5/this.k0}return t.x=r,t.y=s,t}function G2(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=T(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=k2(this.e,2*t.y*this.k0/this.a),e=T(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=n,t}var R2=["cea"];const L2={init:C2,forward:A2,inverse:G2,names:R2};function O2(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function j2(t){var e=t.x,n=t.y,r=T(e-this.long0,this.over),s=ve(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*s,t}function F2(t){var e=t.x,n=t.y;return t.x=T(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=ve(this.lat0+(n-this.y0)/this.a),t}var $2=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const D2={init:O2,forward:j2,inverse:F2,names:$2};var jo=20;function U2(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=nr(this.es),this.e1=rr(this.es),this.e2=sr(this.es),this.e3=ir(this.es),this.ml0=this.a*ut(this.e0,this.e1,this.e2,this.e3,this.lat0)}function q2(t){var e=t.x,n=t.y,r,s,i,a=T(e-this.long0,this.over);if(i=a*Math.sin(n),this.sphere)Math.abs(n)<=w?(r=this.a*a,s=-1*this.a*this.lat0):(r=this.a*Math.sin(i)/Math.tan(n),s=this.a*(ve(n-this.lat0)+(1-Math.cos(i))/Math.tan(n)));else if(Math.abs(n)<=w)r=this.a*a,s=-1*this.ml0;else{var o=Ji(this.a,this.e,Math.sin(n))/Math.tan(n);r=o*Math.sin(i),s=this.a*ut(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+o*(1-Math.cos(i))}return t.x=r+this.x0,t.y=s+this.y0,t}function B2(t){var e,n,r,s,i,a,o,c,l;if(r=t.x-this.x0,s=t.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=w)e=T(r/this.a+this.long0,this.over),n=0;else{a=this.lat0+s/this.a,o=r*r/this.a/this.a+a*a,c=a;var h;for(i=jo;i;--i)if(h=Math.tan(c),l=-1*(a*(c*h+1)-c-.5*(c*c+o)*h)/((c-a)/h-1),c+=l,Math.abs(l)<=w){n=c;break}e=T(this.long0+Math.asin(r*Math.tan(c)/this.a)/Math.sin(n),this.over)}else if(Math.abs(s+this.ml0)<=w)n=0,e=T(this.long0+r/this.a,this.over);else{a=(this.ml0+s)/this.a,o=r*r/this.a/this.a+a*a,c=a;var u,f,d,p,_;for(i=jo;i;--i)if(_=this.e*Math.sin(c),u=Math.sqrt(1-_*_)*Math.tan(c),f=this.a*ut(this.e0,this.e1,this.e2,this.e3,c),d=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),p=f/this.a,l=(a*(u*p+1)-p-.5*u*(p*p+o))/(this.es*Math.sin(2*c)*(p*p+o-2*a*p)/(4*u)+(a-p)*(u*d-2/Math.sin(2*c))-d),c-=l,Math.abs(l)<=w){n=c;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=T(this.long0+Math.asin(r*u/this.a)/Math.sin(n),this.over)}return t.x=e,t.y=n,t}var H2=["Polyconic","American_Polyconic","poly"];const W2={init:U2,forward:q2,inverse:B2,names:H2};function z2(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function V2(t){var e,n=t.x,r=t.y,s=r-this.lat0,i=n-this.long0,a=s/wn*1e-5,o=i,c=1,l=0;for(e=1;e<=10;e++)c=c*a,l=l+this.A[e]*c;var h=l,u=o,f=1,d=0,p,_,m=0,y=0;for(e=1;e<=6;e++)p=f*h-d*u,_=d*h+f*u,f=p,d=_,m=m+this.B_re[e]*f-this.B_im[e]*d,y=y+this.B_im[e]*f+this.B_re[e]*d;return t.x=y*this.a+this.x0,t.y=m*this.a+this.y0,t}function J2(t){var e,n=t.x,r=t.y,s=n-this.x0,i=r-this.y0,a=i/this.a,o=s/this.a,c=1,l=0,h,u,f=0,d=0;for(e=1;e<=6;e++)h=c*a-l*o,u=l*a+c*o,c=h,l=u,f=f+this.C_re[e]*c-this.C_im[e]*l,d=d+this.C_im[e]*c+this.C_re[e]*l;for(var p=0;p<this.iterations;p++){var _=f,m=d,y,S,M=a,N=o;for(e=2;e<=6;e++)y=_*f-m*d,S=m*f+_*d,_=y,m=S,M=M+(e-1)*(this.B_re[e]*_-this.B_im[e]*m),N=N+(e-1)*(this.B_im[e]*_+this.B_re[e]*m);_=1,m=0;var I=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)y=_*f-m*d,S=m*f+_*d,_=y,m=S,I=I+e*(this.B_re[e]*_-this.B_im[e]*m),v=v+e*(this.B_im[e]*_+this.B_re[e]*m);var E=I*I+v*v;f=(M*I+N*v)/E,d=(N*I-M*v)/E}var k=f,L=d,V=1,W=0;for(e=1;e<=9;e++)V=V*k,W=W+this.D[e]*V;var it=this.lat0+W*wn*1e5,K=this.long0+L;return t.x=K,t.y=it,t}var X2=["New_Zealand_Map_Grid","nzmg"];const K2={init:z2,forward:V2,inverse:J2,names:X2};function Y2(){}function Q2(t){var e=t.x,n=t.y,r=T(e-this.long0,this.over),s=this.x0+this.a*r,i=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=s,t.y=i,t}function Z2(t){t.x-=this.x0,t.y-=this.y0;var e=T(this.long0+t.x/this.a,this.over),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var tv=["Miller_Cylindrical","mill"];const ev={init:Y2,forward:Q2,inverse:Z2,names:tv};var nv=20;function rv(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=qi(this.es)}function sv(t){var e,n,r=t.x,s=t.y;if(r=T(r-this.long0,this.over),this.sphere){if(!this.m)s=this.n!==1?Math.asin(this.n*Math.sin(s)):s;else for(var i=this.n*Math.sin(s),a=nv;a;--a){var o=(this.m*s+Math.sin(s)-i)/(this.m+Math.cos(s));if(s-=o,Math.abs(o)<w)break}e=this.a*this.C_x*r*(this.m+Math.cos(s)),n=this.a*this.C_y*s}else{var c=Math.sin(s),l=Math.cos(s);n=this.a*gn(s,c,l,this.en),e=this.a*r*l/Math.sqrt(1-this.es*c*c)}return t.x=e,t.y=n,t}function iv(t){var e,n,r,s;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=pe((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=pe(Math.sin(e)/this.n)),r=T(r+this.long0,this.over),e=ve(e)):(e=Bi(t.y/this.a,this.es,this.en),s=Math.abs(e),s<b?(s=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(e)),r=T(n,this.over)):s-w<b&&(r=this.long0)),t.x=r,t.y=e,t}var av=["Sinusoidal","sinu"];const ov={init:rv,forward:sv,inverse:iv,names:av};function cv(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function lv(t){for(var e=t.x,n=t.y,r=T(e-this.long0,this.over),s=n,i=Math.PI*Math.sin(n);;){var a=-(s+Math.sin(s)-i)/(1+Math.cos(s));if(s+=a,Math.abs(a)<w)break}s/=2,Math.PI/2-Math.abs(n)<w&&(r=0);var o=.900316316158*this.a*r*Math.cos(s)+this.x0,c=1.4142135623731*this.a*Math.sin(s)+this.y0;return t.x=o,t.y=c,t}function uv(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=T(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var s=Math.asin(n);return t.x=r,t.y=s,t}var hv=["Mollweide","moll"];const fv={init:cv,forward:lv,inverse:uv,names:hv};function dv(){Math.abs(this.lat1+this.lat2)<w||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=nr(this.es),this.e1=rr(this.es),this.e2=sr(this.es),this.e3=ir(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Dt(this.e,this.sin_phi,this.cos_phi),this.ml1=ut(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<w?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Dt(this.e,this.sin_phi,this.cos_phi),this.ml2=ut(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ut(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function pv(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var s=ut(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-s)}var i=this.ns*T(e-this.long0,this.over),a=this.x0+r*Math.sin(i),o=this.y0+this.rh-r*Math.cos(i);return t.x=a,t.y=o,t}function mv(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,s;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var i=0;if(n!==0&&(i=Math.atan2(e*t.x,e*t.y)),this.sphere)return s=T(this.long0+i/this.ns,this.over),r=ve(this.g-n/this.a),t.x=s,t.y=r,t;var a=this.g-n/this.a;return r=Xr(a,this.e0,this.e1,this.e2,this.e3),s=T(this.long0+i/this.ns,this.over),t.x=s,t.y=r,t}var gv=["Equidistant_Conic","eqdc"];const _v={init:dv,forward:pv,inverse:mv,names:gv};function yv(){this.R=this.a}function vv(t){var e=t.x,n=t.y,r=T(e-this.long0,this.over),s,i;Math.abs(n)<=w&&(s=this.x0+this.R*r,i=this.y0);var a=pe(2*Math.abs(n/Math.PI));(Math.abs(r)<=w||Math.abs(Math.abs(n)-b)<=w)&&(s=this.x0,n>=0?i=this.y0+Math.PI*this.R*Math.tan(.5*a):i=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),c=o*o,l=Math.sin(a),h=Math.cos(a),u=h/(l+h-1),f=u*u,d=u*(2/l-1),p=d*d,_=Math.PI*this.R*(o*(u-p)+Math.sqrt(c*(u-p)*(u-p)-(p+c)*(f-p)))/(p+c);r<0&&(_=-_),s=this.x0+_;var m=c+u;return _=Math.PI*this.R*(d*m-o*Math.sqrt((p+c)*(c+1)-m*m))/(p+c),n>=0?i=this.y0+_:i=this.y0-_,t.x=s,t.y=i,t}function Sv(t){var e,n,r,s,i,a,o,c,l,h,u,f,d;return t.x-=this.x0,t.y-=this.y0,u=Math.PI*this.R,r=t.x/u,s=t.y/u,i=r*r+s*s,a=-Math.abs(s)*(1+i),o=a-2*s*s+r*r,c=-2*a+1+2*s*s+i*i,d=s*s/c+(2*o*o*o/c/c/c-9*a*o/c/c)/27,l=(a-o*o/3/c)/c,h=2*Math.sqrt(-l/3),u=3*d/l/h,Math.abs(u)>1&&(u>=0?u=1:u=-1),f=Math.acos(u)/3,t.y>=0?n=(-h*Math.cos(f+Math.PI/3)-o/3/c)*Math.PI:n=-(-h*Math.cos(f+Math.PI/3)-o/3/c)*Math.PI,Math.abs(r)<w?e=this.long0:e=T(this.long0+Math.PI*(i-1+Math.sqrt(1+2*(r*r-s*s)+i*i))/2/r,this.over),t.x=e,t.y=n,t}var Ev=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const bv={init:yv,forward:vv,inverse:Sv,names:Ev};function Mv(t,e,n,r,s,i){const a=r-e,o=Math.atan((1-i)*Math.tan(t)),c=Math.atan((1-i)*Math.tan(n)),l=Math.sin(o),h=Math.cos(o),u=Math.sin(c),f=Math.cos(c);let d=a,p,_=100,m,y,S,M,N,I,v,E,k,L,V,W,it,K;do{if(m=Math.sin(d),y=Math.cos(d),S=Math.sqrt(f*m*(f*m)+(h*u-l*f*y)*(h*u-l*f*y)),S===0)return{azi1:0,s12:0};M=l*u+h*f*y,N=Math.atan2(S,M),I=h*f*m/S,v=1-I*I,E=v!==0?M-2*l*u/v:0,k=i/16*v*(4+i*(4-3*v)),p=d,d=a+(1-k)*i*I*(N+k*S*(E+k*M*(-1+2*E*E)))}while(Math.abs(d-p)>1e-12&&--_>0);return _===0?{azi1:NaN,s12:NaN}:(L=v*(s*s-s*(1-i)*(s*(1-i)))/(s*(1-i)*(s*(1-i))),V=1+L/16384*(4096+L*(-768+L*(320-175*L))),W=L/1024*(256+L*(-128+L*(74-47*L))),it=W*S*(E+W/4*(M*(-1+2*E*E)-W/6*E*(-3+4*S*S)*(-3+4*E*E))),K=s*(1-i)*V*(N-it),{azi1:Math.atan2(f*m,h*u-l*f*y),s12:K})}function xv(t,e,n,r,s,i){const a=Math.atan((1-i)*Math.tan(t)),o=Math.sin(a),c=Math.cos(a),l=Math.sin(n),h=Math.cos(n),u=Math.atan2(o,c*h),f=c*l,d=1-f*f,p=d*(s*s-s*(1-i)*(s*(1-i)))/(s*(1-i)*(s*(1-i))),_=1+p/16384*(4096+p*(-768+p*(320-175*p))),m=p/1024*(256+p*(-128+p*(74-47*p)));let y=r/(s*(1-i)*_),S,M=100,N,I,v,E;do N=Math.cos(2*u+y),I=Math.sin(y),v=Math.cos(y),E=m*I*(N+m/4*(v*(-1+2*N*N)-m/6*N*(-3+4*I*I)*(-3+4*N*N))),S=y,y=r/(s*(1-i)*_)+E;while(Math.abs(y-S)>1e-12&&--M>0);if(M===0)return{lat2:NaN,lon2:NaN};const k=o*I-c*v*h,L=Math.atan2(o*v+c*I*h,(1-i)*Math.sqrt(f*f+k*k)),V=Math.atan2(I*l,c*v-o*I*h),W=i/16*d*(4+i*(4-3*d)),it=V-(1-W)*i*f*(y+W*I*(N+W*v*(-1+2*N*N))),K=e+it;return{lat2:L,lon2:K}}function wv(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Pv(t){var e=t.x,n=t.y,r=Math.sin(t.y),s=Math.cos(t.y),i=T(e-this.long0,this.over),a,o,c,l,h,u,f,d,p,_,m;return this.sphere?Math.abs(this.sin_p12-1)<=w?(t.x=this.x0+this.a*(b-n)*Math.sin(i),t.y=this.y0-this.a*(b-n)*Math.cos(i),t):Math.abs(this.sin_p12+1)<=w?(t.x=this.x0+this.a*(b+n)*Math.sin(i),t.y=this.y0+this.a*(b+n)*Math.cos(i),t):(p=this.sin_p12*r+this.cos_p12*s*Math.cos(i),f=Math.acos(p),d=f?f/Math.sin(f):1,t.x=this.x0+this.a*d*s*Math.sin(i),t.y=this.y0+this.a*d*(this.cos_p12*r-this.sin_p12*s*Math.cos(i)),t):(a=nr(this.es),o=rr(this.es),c=sr(this.es),l=ir(this.es),Math.abs(this.sin_p12-1)<=w?(h=this.a*ut(a,o,c,l,b),u=this.a*ut(a,o,c,l,n),t.x=this.x0+(h-u)*Math.sin(i),t.y=this.y0-(h-u)*Math.cos(i),t):Math.abs(this.sin_p12+1)<=w?(h=this.a*ut(a,o,c,l,b),u=this.a*ut(a,o,c,l,n),t.x=this.x0+(h+u)*Math.sin(i),t.y=this.y0+(h+u)*Math.cos(i),t):Math.abs(e)<w&&Math.abs(n-this.lat0)<w?(t.x=t.y=0,t):(_=Mv(this.lat0,this.long0,n,e,this.a,this.f),m=_.azi1,t.x=_.s12*Math.sin(m),t.y=_.s12*Math.cos(m),t))}function Tv(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,s,i,a,o,c,l,h,u,f,d,p,_,m;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*b*this.a?void 0:(n=e/this.a,r=Math.sin(n),s=Math.cos(n),i=this.long0,Math.abs(e)<=w?a=this.lat0:(a=pe(s*this.sin_p12+t.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-b,Math.abs(o)<=w?this.lat0>=0?i=T(this.long0+Math.atan2(t.x,-t.y),this.over):i=T(this.long0-Math.atan2(-t.x,t.y),this.over):i=T(this.long0+Math.atan2(t.x*r,e*this.cos_p12*s-t.y*this.sin_p12*r),this.over)),t.x=i,t.y=a,t)):(c=nr(this.es),l=rr(this.es),h=sr(this.es),u=ir(this.es),Math.abs(this.sin_p12-1)<=w?(f=this.a*ut(c,l,h,u,b),e=Math.sqrt(t.x*t.x+t.y*t.y),d=f-e,a=Xr(d/this.a,c,l,h,u),i=T(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=i,t.y=a,t):Math.abs(this.sin_p12+1)<=w?(f=this.a*ut(c,l,h,u,b),e=Math.sqrt(t.x*t.x+t.y*t.y),d=e-f,a=Xr(d/this.a,c,l,h,u),i=T(this.long0+Math.atan2(t.x,t.y),this.over),t.x=i,t.y=a,t):(p=Math.atan2(t.x,t.y),_=Math.sqrt(t.x*t.x+t.y*t.y),m=xv(this.lat0,this.long0,p,_,this.a,this.f),t.x=m.lon2,t.y=m.lat2,t))}var Nv=["Azimuthal_Equidistant","aeqd"];const Iv={init:wv,forward:Pv,inverse:Tv,names:Nv};function kv(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Cv(t){var e,n,r,s,i,a,o,c,l=t.x,h=t.y;return r=T(l-this.long0,this.over),e=Math.sin(h),n=Math.cos(h),s=Math.cos(r),a=this.sin_p14*e+this.cos_p14*n*s,i=1,(a>0||Math.abs(a)<=w)&&(o=this.a*i*n*Math.sin(r),c=this.y0+this.a*i*(this.cos_p14*e-this.sin_p14*n*s)),t.x=o,t.y=c,t}function Av(t){var e,n,r,s,i,a,o;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=pe(e/this.a),r=Math.sin(n),s=Math.cos(n),a=this.long0,Math.abs(e)<=w?(o=this.lat0,t.x=a,t.y=o,t):(o=pe(s*this.sin_p14+t.y*r*this.cos_p14/e),i=Math.abs(this.lat0)-b,Math.abs(i)<=w?(this.lat0>=0?a=T(this.long0+Math.atan2(t.x,-t.y),this.over):a=T(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=a,t.y=o,t):(a=T(this.long0+Math.atan2(t.x*r,e*this.cos_p14*s-t.y*this.sin_p14*r),this.over),t.x=a,t.y=o,t))}var Gv=["ortho"];const Rv={init:kv,forward:Cv,inverse:Av,names:Gv};var Y={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},q={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Lv(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=b-U/2?this.face=Y.TOP:this.lat0<=-(b-U/2)?this.face=Y.BOTTOM:Math.abs(this.long0)<=U?this.face=Y.FRONT:Math.abs(this.long0)<=b+U?this.face=this.long0>0?Y.RIGHT:Y.LEFT:this.face=Y.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Ov(t){var e={x:0,y:0},n,r,s,i,a,o,c={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===Y.TOP)i=b-n,r>=U&&r<=b+U?(c.value=q.AREA_0,s=r-b):r>b+U||r<=-(b+U)?(c.value=q.AREA_1,s=r>0?r-tt:r+tt):r>-(b+U)&&r<=-U?(c.value=q.AREA_2,s=r+b):(c.value=q.AREA_3,s=r);else if(this.face===Y.BOTTOM)i=b+n,r>=U&&r<=b+U?(c.value=q.AREA_0,s=-r+b):r<U&&r>=-U?(c.value=q.AREA_1,s=-r):r<-U&&r>=-(b+U)?(c.value=q.AREA_2,s=-r-b):(c.value=q.AREA_3,s=r>0?-r+tt:-r-tt);else{var l,h,u,f,d,p,_;this.face===Y.RIGHT?r=Je(r,+b):this.face===Y.BACK?r=Je(r,+tt):this.face===Y.LEFT&&(r=Je(r,-b)),f=Math.sin(n),d=Math.cos(n),p=Math.sin(r),_=Math.cos(r),l=d*_,h=d*p,u=f,this.face===Y.FRONT?(i=Math.acos(l),s=yr(i,u,h,c)):this.face===Y.RIGHT?(i=Math.acos(h),s=yr(i,u,-l,c)):this.face===Y.BACK?(i=Math.acos(-l),s=yr(i,u,-h,c)):this.face===Y.LEFT?(i=Math.acos(-h),s=yr(i,u,l,c)):(i=s=0,c.value=q.AREA_0)}return o=Math.atan(12/tt*(s+Math.acos(Math.sin(s)*Math.cos(U))-b)),a=Math.sqrt((1-Math.cos(i))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(s))))),c.value===q.AREA_1?o+=b:c.value===q.AREA_2?o+=tt:c.value===q.AREA_3&&(o+=1.5*tt),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function jv(t){var e={lam:0,phi:0},n,r,s,i,a,o,c,l,h,u={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?u.value=q.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(u.value=q.AREA_1,n-=b):t.x<0&&-t.x>=Math.abs(t.y)?(u.value=q.AREA_2,n=n<0?n+tt:n-tt):(u.value=q.AREA_3,n+=b),h=tt/12*Math.tan(n),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),s=Math.cos(n),i=Math.tan(r),c=1-s*s*i*i*(1-Math.cos(Math.atan(1/Math.cos(o)))),c<-1?c=-1:c>1&&(c=1),this.face===Y.TOP)l=Math.acos(c),e.phi=b-l,u.value===q.AREA_0?e.lam=o+b:u.value===q.AREA_1?e.lam=o<0?o+tt:o-tt:u.value===q.AREA_2?e.lam=o-b:e.lam=o;else if(this.face===Y.BOTTOM)l=Math.acos(c),e.phi=l-b,u.value===q.AREA_0?e.lam=-o+b:u.value===q.AREA_1?e.lam=-o:u.value===q.AREA_2?e.lam=-o-b:e.lam=o<0?-o-tt:-o+tt;else{var f,d,p;f=c,h=f*f,h>=1?p=0:p=Math.sqrt(1-h)*Math.sin(o),h+=p*p,h>=1?d=0:d=Math.sqrt(1-h),u.value===q.AREA_1?(h=d,d=-p,p=h):u.value===q.AREA_2?(d=-d,p=-p):u.value===q.AREA_3&&(h=d,d=p,p=-h),this.face===Y.RIGHT?(h=f,f=-d,d=h):this.face===Y.BACK?(f=-f,d=-d):this.face===Y.LEFT&&(h=f,f=d,d=-h),e.phi=Math.acos(-p)-b,e.lam=Math.atan2(d,f),this.face===Y.RIGHT?e.lam=Je(e.lam,-b):this.face===Y.BACK?e.lam=Je(e.lam,-tt):this.face===Y.LEFT&&(e.lam=Je(e.lam,+b))}if(this.es!==0){var _,m,y;_=e.phi<0?1:0,m=Math.tan(e.phi),y=this.b/Math.sqrt(m*m+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-y*y)/(this.one_minus_f*y)),_&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function yr(t,e,n,r){var s;return t<w?(r.value=q.AREA_0,s=0):(s=Math.atan2(e,n),Math.abs(s)<=U?r.value=q.AREA_0:s>U&&s<=b+U?(r.value=q.AREA_1,s-=b):s>b+U||s<=-(b+U)?(r.value=q.AREA_2,s=s>=0?s-tt:s+tt):(r.value=q.AREA_3,s+=b)),s}function Je(t,e){var n=t+e;return n<-tt?n+=On:n>+tt&&(n-=On),n}var Fv=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const $v={init:Lv,forward:Ov,inverse:jv,names:Fv};var ci=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Mn=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],iu=.8487,au=1.3523,ou=mt/5,Dv=1/ou,We=18,Kr=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},Uv=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function qv(t,e,n,r){for(var s=e;r;--r){var i=t(s);if(s-=i,Math.abs(i)<n)break}return s}function Bv(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Hv(t){var e=T(t.x-this.long0,this.over),n=Math.abs(t.y),r=Math.floor(n*ou);r<0?r=0:r>=We&&(r=We-1),n=mt*(n-Dv*r);var s={x:Kr(ci[r],n)*e,y:Kr(Mn[r],n)};return t.y<0&&(s.y=-s.y),s.x=s.x*this.a*iu+this.x0,s.y=s.y*this.a*au+this.y0,s}function Wv(t){var e={x:(t.x-this.x0)/(this.a*iu),y:Math.abs(t.y-this.y0)/(this.a*au)};if(e.y>=1)e.x/=ci[We][0],e.y=t.y<0?-b:b;else{var n=Math.floor(e.y*We);for(n<0?n=0:n>=We&&(n=We-1);;)if(Mn[n][0]>e.y)--n;else if(Mn[n+1][0]<=e.y)++n;else break;var r=Mn[n],s=5*(e.y-r[0])/(Mn[n+1][0]-r[0]);s=qv(function(i){return(Kr(r,i)-e.y)/Uv(r,i)},s,w,100),e.x/=Kr(ci[n],s),e.y=(5*n+s)*Q,t.y<0&&(e.y=-e.y)}return e.x=T(e.x+this.long0,this.over),e}var zv=["Robinson","robin"];const Vv={init:Bv,forward:Hv,inverse:Wv,names:zv};function Jv(){this.name="geocent"}function Xv(t){var e=Jl(t,this.es,this.a);return e}function Kv(t){var e=Xl(t,this.es,this.a,this.b);return e}var Yv=["Geocentric","geocentric","geocent","Geocent"];const Qv={init:Jv,forward:Xv,inverse:Kv,names:Yv};var ct={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},vn={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Zv(){if(Object.keys(vn).forEach((function(n){if(typeof this[n]>"u")this[n]=vn[n].def;else{if(vn[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);vn[n].num&&(this[n]=parseFloat(this[n]))}vn[n].degrees&&(this[n]=this[n]*Q)}).bind(this)),Math.abs(Math.abs(this.lat0)-b)<w?this.mode=this.lat0<0?ct.S_POLE:ct.N_POLE:Math.abs(this.lat0)<w?this.mode=ct.EQUIT:(this.mode=ct.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function t4(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),s,i;switch(this.mode){case ct.OBLIQ:i=this.sinph0*e+this.cosph0*n*r;break;case ct.EQUIT:i=n*r;break;case ct.S_POLE:i=-e;break;case ct.N_POLE:i=e;break}switch(i=this.pn1/(this.p-i),s=i*n*Math.sin(t.x),this.mode){case ct.OBLIQ:i*=this.cosph0*e-this.sinph0*n*r;break;case ct.EQUIT:i*=e;break;case ct.N_POLE:i*=-(n*r);break;case ct.S_POLE:i*=n*r;break}var a,o;return a=i*this.cg+s*this.sg,o=1/(a*this.sw*this.h1+this.cw),s=(s*this.cg-i*this.sg)*this.cw*o,i=a*o,t.x=s*this.a,t.y=i*this.a,t}function e4(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,s;s=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*s,r=this.pn1*t.y*this.cw*s,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var i=pt(t.x,t.y);if(Math.abs(i)<w)e.x=0,e.y=t.y;else{var a,o;switch(o=1-i*i*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/i+i/this.pn1),a=Math.sqrt(1-o*o),this.mode){case ct.OBLIQ:e.y=Math.asin(a*this.sinph0+t.y*o*this.cosph0/i),t.y=(a-this.sinph0*Math.sin(e.y))*i,t.x*=o*this.cosph0;break;case ct.EQUIT:e.y=Math.asin(t.y*o/i),t.y=a*i,t.x*=o;break;case ct.N_POLE:e.y=Math.asin(a),t.y=-t.y;break;case ct.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var n4=["Tilted_Perspective","tpers"];const r4={init:Zv,forward:t4,inverse:e4,names:n4};function s4(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function i4(t){var e=t.x,n=t.y,r,s,i,a;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var o=this.radius_p/pt(this.radius_p*Math.cos(n),Math.sin(n));if(s=o*Math.cos(e)*Math.cos(n),i=o*Math.sin(e)*Math.cos(n),a=o*Math.sin(n),(this.radius_g-s)*s-i*i-a*a*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-s,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/pt(a,r)),t.y=this.radius_g_1*Math.atan(a/r)):(t.x=this.radius_g_1*Math.atan(i/r),t.y=this.radius_g_1*Math.atan(a/pt(i,r)))}else this.shape==="sphere"&&(r=Math.cos(n),s=Math.cos(e)*r,i=Math.sin(e)*r,a=Math.sin(n),r=this.radius_g-s,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/pt(a,r)),t.y=this.radius_g_1*Math.atan(a/r)):(t.x=this.radius_g_1*Math.atan(i/r),t.y=this.radius_g_1*Math.atan(a/pt(i,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function a4(t){var e=-1,n=0,r=0,s,i,a,o;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*pt(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*pt(1,n));var c=r/this.radius_p;if(s=n*n+c*c+e*e,i=2*this.radius_g*e,a=i*i-4*s*this.C,a<0)return t.x=Number.NaN,t.y=Number.NaN,t;o=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+o*e,n*=o,r*=o,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),s=n*n+r*r+e*e,i=2*this.radius_g*e,a=i*i-4*s*this.C,a<0)return t.x=Number.NaN,t.y=Number.NaN,t;o=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+o*e,n*=o,r*=o,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var o4=["Geostationary Satellite View","Geostationary_Satellite","geos"];const c4={init:s4,forward:i4,inverse:a4,names:o4};var Pn=1.340264,Tn=-.081106,Nn=893e-6,In=.003796,Yr=Math.sqrt(3)/2;function l4(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function u4(t){var e=T(t.x-this.long0,this.over),n=t.y,r=Math.asin(Yr*Math.sin(n)),s=r*r,i=s*s*s;return t.x=e*Math.cos(r)/(Yr*(Pn+3*Tn*s+i*(7*Nn+9*In*s))),t.y=r*(Pn+Tn*s+i*(Nn+In*s)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function h4(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,s,i,a,o,c,l;for(l=0;l<n&&(s=r*r,i=s*s*s,a=r*(Pn+Tn*s+i*(Nn+In*s))-t.y,o=Pn+3*Tn*s+i*(7*Nn+9*In*s),r-=c=a/o,!(Math.abs(c)<e));++l);return s=r*r,i=s*s*s,t.x=Yr*t.x*(Pn+3*Tn*s+i*(7*Nn+9*In*s))/Math.cos(r),t.y=Math.asin(Math.sin(r)/Yr),t.x=T(t.x+this.long0,this.over),t}var f4=["eqearth","Equal Earth","Equal_Earth"];const d4={init:l4,forward:u4,inverse:h4,names:f4};var $n=1e-10;function p4(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<$n)throw new Error;this.es?(this.en=qi(this.es),this.m1=gn(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=g4,this.forward=m4):(Math.abs(this.phi1)+$n>=b?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=y4,this.forward=_4)}function m4(t){var e=T(t.x-(this.long0||0),this.over),n=t.y,r,s,i;return r=this.am1+this.m1-gn(n,s=Math.sin(n),i=Math.cos(n),this.en),s=i*e/(r*Math.sqrt(1-this.es*s*s)),t.x=r*Math.sin(s),t.y=this.am1-r*Math.cos(s),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function g4(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,s;if(n=pt(t.x,t.y=this.am1-t.y),s=Bi(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(s))<b)e=Math.sin(s),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(s);else if(Math.abs(e-b)<=$n)r=0;else throw new Error;return t.x=T(r+(this.long0||0),this.over),t.y=ve(s),t}function _4(t){var e=T(t.x-(this.long0||0),this.over),n=t.y,r,s;return s=this.cphi1+this.phi1-n,Math.abs(s)>$n?(t.x=s*Math.sin(r=e*Math.cos(n)/s),t.y=this.cphi1-s*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function y4(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=pt(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>b)throw new Error;return Math.abs(Math.abs(n)-b)<=$n?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=T(e+(this.long0||0),this.over),t.y=ve(n),t}var v4=["bonne","Bonne (Werner lat_1=90)"];const S4={init:p4,names:v4},Fo={OBLIQUE:{forward:w4,inverse:T4},TRANSVERSE:{forward:P4,inverse:N4}},Qr={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function E4(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=Hl.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Nt(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let n;const r=Object.keys(Qr),s=o=>{if(typeof this[o]>"u")return;const c=parseFloat(this[o])*Q;if(isNaN(c))throw new Error("Invalid value for "+o+": "+this[o]);return c};for(let o=0;o<r.length;o++){const c=r[o],l=Qr[c],h=Object.entries(l);if(h.some(([f])=>typeof this[f]<"u")){n=l;for(let f=0;f<h.length;f++){const[d,p]=h[f],_=s(d);if(typeof _>"u")throw new Error("Missing parameter: "+d+".");this[p]=_}break}}if(!n)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:i,phip:a}=x4(this,n);this.lamp=i,Math.abs(a)>w?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=Fo.OBLIQUE):this.projectionType=Fo.TRANSVERSE}function b4(t){return this.projectionType.forward(this,t)}function M4(t){return this.projectionType.inverse(this,t)}function x4(t,e){let n,r;if(e===Qr.ROTATE){let s=t.oLongC,i=t.oLatC,a=t.oAlpha;if(Math.abs(Math.abs(i)-b)<=w)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");r=s+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(i)),n=Math.asin(Math.cos(i)*Math.sin(a))}else if(e===Qr.NEW_POLE)r=t.oLongP,n=t.oLatP;else{let s=t.oLong1,i=t.oLat1,a=t.oLong2,o=t.oLat2,c=Math.abs(i);if(Math.abs(i)>b-w)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(o)>b-w)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(i-o)<w)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(c<w)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(i)*Math.sin(o)*Math.cos(s)-Math.sin(i)*Math.cos(o)*Math.cos(a),Math.sin(i)*Math.cos(o)*Math.sin(a)-Math.cos(i)*Math.sin(o)*Math.sin(s)),n=Math.atan(-1*Math.cos(r-s)/Math.tan(i))}return{lamp:r,phip:n}}function w4(t,e){let{x:n,y:r}=e;n+=t.long0;const s=Math.cos(n),i=Math.sin(r),a=Math.cos(r);e.x=T(Math.atan2(a*Math.sin(n),t.sphip*a*s+t.cphip*i)+t.lamp),e.y=Math.asin(t.sphip*i-t.cphip*a*s);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=mt,o.y*=mt),o}function P4(t,e){let{x:n,y:r}=e;n+=t.long0;const s=Math.cos(r),i=Math.cos(n);e.x=T(Math.atan2(s*Math.sin(n),Math.sin(r))+t.lamp),e.y=Math.asin(-1*s*i);const a=t.obliqueProjection.forward(e);return t.isIdentity&&(a.x*=mt,a.y*=mt),a}function T4(t,e){t.isIdentity&&(e.x*=Q,e.y*=Q);const n=t.obliqueProjection.inverse(e);let{x:r,y:s}=n;if(r<Number.MAX_VALUE){r-=t.lamp;const i=Math.cos(r),a=Math.sin(s),o=Math.cos(s);e.x=Math.atan2(o*Math.sin(r),t.sphip*o*i-t.cphip*a),e.y=Math.asin(t.sphip*a+t.cphip*o*i)}return e.x=T(e.x+t.long0),e}function N4(t,e){t.isIdentity&&(e.x*=Q,e.y*=Q);const n=t.obliqueProjection.inverse(e);let{x:r,y:s}=n;if(r<Number.MAX_VALUE){const i=Math.cos(s);r-=t.lamp,e.x=Math.atan2(i*Math.sin(r),-1*Math.sin(s)),e.y=Math.asin(i*Math.cos(r))}return e.x=T(e.x+t.long0),e}var I4=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const k4={init:E4,forward:b4,inverse:M4,names:I4};function C4(t){t.Proj.projections.add(Ar),t.Proj.projections.add(Gr),t.Proj.projections.add(vy),t.Proj.projections.add(Ny),t.Proj.projections.add(Gy),t.Proj.projections.add(Fy),t.Proj.projections.add(Hy),t.Proj.projections.add(Xy),t.Proj.projections.add(t2),t.Proj.projections.add(i2),t.Proj.projections.add(y2),t.Proj.projections.add(x2),t.Proj.projections.add(I2),t.Proj.projections.add(L2),t.Proj.projections.add(D2),t.Proj.projections.add(W2),t.Proj.projections.add(K2),t.Proj.projections.add(ev),t.Proj.projections.add(ov),t.Proj.projections.add(fv),t.Proj.projections.add(_v),t.Proj.projections.add(bv),t.Proj.projections.add(Iv),t.Proj.projections.add(Rv),t.Proj.projections.add($v),t.Proj.projections.add(Vv),t.Proj.projections.add(Qv),t.Proj.projections.add(r4),t.Proj.projections.add(c4),t.Proj.projections.add(d4),t.Proj.projections.add(S4),t.Proj.projections.add(k4)}const te=Object.assign(O_,{defaultDatum:"WGS84",Proj:Nt,WGS84:new Nt("WGS84"),Point:nn,toPoint:Kl,defs:ot,nadgrid:y_,transform:Jr,mgrs:j_,version:"__VERSION__"});C4(te);te.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs");te.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs");te.defs("EPSG:27700","+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs");const cu={"EPSG:4326":"WGS84 (lon/lat)","EPSG:3857":"Web Mercator","EPSG:27700":"British National Grid"};function Ee(t,e,n){if(e===n)return t;const r=t[0]??0,s=t[1]??0,i=t[2],a=te(e,n,[r,s]),o=a[0]??0,c=a[1]??0;return i!==void 0?[o,c,i]:[o,c]}function me(t,e,n){if(e===n)return t;switch(t.type){case"Point":return{type:"Point",coordinates:Ee(t.coordinates,e,n)};case"MultiPoint":return{type:"MultiPoint",coordinates:t.coordinates.map(r=>Ee(r,e,n))};case"LineString":return{type:"LineString",coordinates:t.coordinates.map(r=>Ee(r,e,n))};case"MultiLineString":return{type:"MultiLineString",coordinates:t.coordinates.map(r=>r.map(s=>Ee(s,e,n)))};case"Polygon":return{type:"Polygon",coordinates:t.coordinates.map(r=>r.map(s=>Ee(s,e,n)))};case"MultiPolygon":return{type:"MultiPolygon",coordinates:t.coordinates.map(r=>r.map(s=>s.map(i=>Ee(i,e,n))))};case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(r=>me(r,e,n))};default:return t}}function lu(t){const e=t[0],n=t[1];return e===void 0||n===void 0?!1:e>=-180&&e<=180&&n>=-90&&n<=90}function uu(t){for(const e of t)if(!lu(e))return{valid:!1,invalidCoord:e};return{valid:!0}}const Ns={WGS84_MAX:180,BNG_MAX:13e5,WEB_MERCATOR_MAX:2003750834e-2};function ar(t){if(t.length===0)return"EPSG:4326";let e=0;for(const n of t){const r=n[0],s=n[1];r!==void 0&&(e=Math.max(e,Math.abs(r))),s!==void 0&&(e=Math.max(e,Math.abs(s)))}return e<=Ns.WGS84_MAX?"EPSG:4326":e<=Ns.BNG_MAX?"EPSG:27700":e<=Ns.WEB_MERCATOR_MAX?"EPSG:3857":"EPSG:4326"}const A4=Object.freeze(Object.defineProperty({__proto__:null,detectProjectionFromCoordinates:ar,isValidWGS84Coordinate:lu,proj4:te,projectionLabels:cu,transformCoordinate:Ee,transformGeometry:me,validateWGS84Coordinates:uu},Symbol.toStringTag,{value:"Module"})),G4={geojson:"GeoJSON",wkt:"WKT",ewkt:"EWKT",csv:"CSV",kml:"KML",gpx:"GPX",polyline5:"Polyline5",polyline6:"Polyline6",shapefile:"Shapefile"};function R4({error:t}){const[e,n]=x.useState(!1),r=x.useCallback(()=>{n(a=>!a)},[]),s=x.useCallback(()=>{n(!0)},[]),i=x.useCallback(()=>{n(!1)},[]);return g.jsxs("span",{className:"relative inline-flex items-center",children:[g.jsx("button",{type:"button",onClick:r,onMouseEnter:s,onMouseLeave:i,className:"inline-flex items-center","aria-label":"Show error details",children:g.jsx(e1,{className:"h-4 w-4 text-red-600 dark:text-red-400"})}),e&&g.jsx("div",{className:"absolute left-0 top-full z-50 mt-1 max-w-xs whitespace-normal rounded-md border border-red-200 bg-red-50 p-2 text-xs text-red-700 shadow-lg dark:border-red-800 dark:bg-red-950 dark:text-red-300",children:t})]})}function L4(){const{inputFormat:t,inputProjection:e,detectedFormat:n,detectedProjection:r,parseError:s,coordinateError:i,isParsing:a,features:o,rawText:c}=Ft(),l=t==="auto",h=e==="auto",u=s||i,f=c.trim().length>0,d=o.length>0;if(a)return g.jsx("span",{className:"inline-flex items-center gap-1 text-xs text-neutral-500 dark:text-neutral-400",children:g.jsx(c1,{className:"h-3 w-3 animate-spin"})});if(!f)return null;const p=n?G4[n]:null,_=r?cu[r]:null,m=!u&&d,y=s||i;return g.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[m&&g.jsx(Zg,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),y&&g.jsx(R4,{error:y}),l&&p&&g.jsx("span",{className:"rounded bg-neutral-100 px-1.5 py-0.5 text-xs font-medium text-neutral-600 dark:bg-neutral-700 dark:text-neutral-300",children:p}),h&&_&&g.jsx("span",{className:"rounded bg-neutral-100 px-1.5 py-0.5 text-xs font-medium text-neutral-600 dark:bg-neutral-700 dark:text-neutral-300",children:_})]})}const O4=[".json",".geojson",".wkt",".csv",".kml",".gpx",".txt"];function j4(){const{rawText:t,inputFormat:e,inputProjection:n,detectedFormat:r,detectedProjection:s,setRawText:i,setInputFormat:a,setInputProjection:o}=Ft(),c=x.useCallback((u,f)=>{i(u)},[i]),l=x.useCallback(()=>{i("")},[i]),h=x.useCallback(async()=>{await navigator.clipboard.writeText(window.location.href)},[]);return g.jsxs("div",{className:"border-b border-neutral-200 p-3 md:p-4 dark:border-neutral-700",children:[g.jsxs("div",{className:"mb-2 flex items-center gap-2 md:mb-3",children:[g.jsx("h2",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Input Geometry"}),g.jsx(L4,{}),g.jsxs("div",{className:"ml-auto flex gap-1",children:[t&&g.jsx("button",{onClick:h,className:"rounded p-1 text-neutral-400 transition-colors hover:bg-neutral-200 hover:text-neutral-600 dark:hover:bg-neutral-700 dark:hover:text-neutral-300",title:"Copy link to clipboard","aria-label":"Copy shareable link to clipboard",children:g.jsx(o1,{className:"h-4 w-4"})}),t&&g.jsx("button",{onClick:l,className:"rounded p-1 text-neutral-400 transition-colors hover:bg-neutral-200 hover:text-neutral-600 dark:hover:bg-neutral-700 dark:hover:text-neutral-300",title:"Clear input","aria-label":"Clear input",children:g.jsx(g1,{className:"h-4 w-4"})})]})]}),g.jsxs("div",{className:"mb-2 flex gap-2 md:mb-3",children:[g.jsx(M1,{value:e,onChange:a,detectedValue:r,label:"Format"}),g.jsx(x1,{value:n,onChange:o,detectedValue:s,label:"Projection"})]}),g.jsx(E1,{onFileDrop:c,accept:O4,children:g.jsx(b1,{value:t,onChange:i,placeholder:"Paste or drop GeoJSON, WKT, CSV, KML, GPX..."})})]})}const or=tr(t=>({outputFormat:"geojson",outputProjection:"EPSG:4326",setOutputFormat:e=>{t({outputFormat:e})},setOutputProjection:e=>{t({outputProjection:e})}})),hu=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","Feature","FeatureCollection"];function F4(t){const e=[];if(!t||typeof t!="object")return e.push("GeoJSON must be an object"),e;const n=t;return n.type?typeof n.type!="string"?(e.push('"type" must be a string'),e):hu.includes(n.type)?(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"].includes(n.type)&&("coordinates"in n||e.push(`${n.type} must have "coordinates" property`)),n.type==="Feature"&&("geometry"in n||e.push('Feature must have "geometry" property')),n.type==="FeatureCollection"&&(Array.isArray(n.features)||e.push('FeatureCollection must have "features" array')),n.type==="GeometryCollection"&&(Array.isArray(n.geometries)||e.push('GeometryCollection must have "geometries" array')),e):(e.push(`Invalid GeoJSON type: "${n.type}"`),e):(e.push('GeoJSON must have a "type" property'),e)}function fu(t){const e=[];let n=0,r=-1;for(let s=0;s<t.length;s++){const i=t[s];i==="{"?(n===0&&(r=s),n++):i==="}"&&(n--,n===0&&r!==-1&&(e.push(t.slice(r,s+1)),r=-1))}return e}function $4(t){let e;try{e=JSON.parse(t)}catch(r){return{features:[],errors:[{message:r instanceof Error?r.message:"Invalid JSON"}]}}const n=F4(e);return n.length>0?{features:[],errors:n.map(r=>({message:r}))}:{features:U4(e),errors:[]}}function D4(t){const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"geojson"};const n=fu(e);if(n.length===0)return{features:[],errors:[{message:"No valid JSON objects found"}]};const r=[],s=[];for(let i=0;i<n.length;i++){const a=n[i];if(!a)continue;const o=$4(a);if(o.errors.length>0){const c=n.length>1?`Object ${String(i+1)}: `:"";s.push(...o.errors.map(l=>({...l,message:c+l.message})))}else r.push(...o.features)}return r.length>0?{features:q4(r),errors:s,detectedFormat:"geojson"}:{features:[],errors:s.length>0?s:[{message:"No features found in GeoJSON"}]}}function U4(t){switch(t.type){case"FeatureCollection":return t.features;case"Feature":return[t];case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":case"GeometryCollection":return[{type:"Feature",geometry:t,properties:{}}];default:return[]}}function q4(t){return t.map((e,n)=>{var r;return{...e,id:((r=e.id)==null?void 0:r.toString())??`feature-${String(n)}`,properties:e.properties??{}}})}function B4(t){return JSON.stringify({type:"FeatureCollection",features:t},null,2)}function H4(t){const e=t.trim();if(!e.startsWith("{"))return!1;const n=fu(e);if(n.length===0)return!1;try{const r=n[0];if(!r)return!1;const s=JSON.parse(r);return typeof s.type=="string"&&hu.includes(s.type)}catch{return!1}}const du={name:"geojson",parse:D4,format:B4,detect:H4};var Sn={exports:{}},$o;function W4(){if($o)return Sn.exports;$o=1,Sn.exports=n,Sn.exports.parse=n,Sn.exports.stringify=r;var t=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,e=new RegExp("^"+t.source+"(\\s"+t.source+"){1,}");function n(s){var i=s.split(";"),a=i.pop(),o=(i.shift()||"").split("=").pop(),c=0;function l(v){var E=a.substring(c).match(v);return E?(c+=E[0].length,E[0]):null}function h(v){return v&&o.match(/\d+/)&&(v.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+o}}),v}function u(){l(/^\s*/)}function f(){u();for(var v=0,E=[],k=[E],L=E,V;V=l(/^(\()/)||l(/^(\))/)||l(/^(,)/)||l(e);){if(V==="(")k.push(L),L=[],k[k.length-1].push(L),v++;else if(V===")"){if(L.length===0||(L=k.pop(),!L))return null;if(v--,v===0)break}else if(V===",")L=[],k[k.length-1].push(L);else if(!V.split(/\s/g).some(isNaN))Array.prototype.push.apply(L,V.split(/\s/g).map(parseFloat));else return null;u()}return v!==0?null:E}function d(){for(var v=[],E,k;k=l(e)||l(/^(,)/);)k===","?(v.push(E),E=[]):k.split(/\s/g).some(isNaN)||(E||(E=[]),Array.prototype.push.apply(E,k.split(/\s/g).map(parseFloat))),u();if(E)v.push(E);else return null;return v.length?v:null}function p(){if(!l(/^(point(\sz)?)/i)||(u(),!l(/^(\()/)))return null;var v=d();return!v||(u(),!l(/^(\))/))?null:{type:"Point",coordinates:v[0]}}function _(){if(!l(/^(multipoint)/i))return null;u();var v=a.substring(a.indexOf("(")+1,a.length-1).replace(/\(/g,"").replace(/\)/g,"");a="MULTIPOINT ("+v+")";var E=f();return E?(u(),{type:"MultiPoint",coordinates:E}):null}function m(){if(!l(/^(multilinestring)/i))return null;u();var v=f();return v?(u(),{type:"MultiLineString",coordinates:v}):null}function y(){if(!l(/^(linestring(\sz)?)/i)||(u(),!l(/^(\()/)))return null;var v=d();return!v||!l(/^(\))/)?null:{type:"LineString",coordinates:v}}function S(){if(!l(/^(polygon(\sz)?)/i))return null;u();var v=f();return v?{type:"Polygon",coordinates:v}:null}function M(){if(!l(/^(multipolygon)/i))return null;u();var v=f();return v?{type:"MultiPolygon",coordinates:v}:null}function N(){var v=[],E;if(!l(/^(geometrycollection)/i)||(u(),!l(/^(\()/)))return null;for(;E=I();)v.push(E),u(),l(/^(,)/),u();return l(/^(\))/)?{type:"GeometryCollection",geometries:v}:null}function I(){return p()||y()||S()||_()||m()||M()||N()}return h(I())}function r(s){s.type==="Feature"&&(s=s.geometry);function i(h){return h.join(" ")}function a(h){return h.map(i).join(", ")}function o(h){return h.map(a).map(l).join(", ")}function c(h){return h.map(o).map(l).join(", ")}function l(h){return"("+h+")"}switch(s.type){case"Point":return"POINT ("+i(s.coordinates)+")";case"LineString":return"LINESTRING ("+a(s.coordinates)+")";case"Polygon":return"POLYGON ("+o(s.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+a(s.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+c(s.coordinates)+")";case"MultiLineString":return"MULTILINESTRING ("+o(s.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+s.geometries.map(r).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}}return Sn.exports}var pu=W4();function mu(t){var i;const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"wkt"};const n=e.split(/\n\s*\n/).filter(a=>a.trim()),r=[],s=[];for(let a=0;a<n.length;a++){const o=(i=n[a])==null?void 0:i.trim();if(o)try{const c=pu.parse(o);c?r.push({type:"Feature",id:`feature-${String(a)}`,geometry:c,properties:{}}):s.push({message:`Failed to parse WKT at block ${String(a+1)}`})}catch(c){s.push({message:c instanceof Error?c.message:`Invalid WKT at block ${String(a+1)}`})}}return{features:r,errors:s,detectedFormat:"wkt"}}function z4(t){const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"ewkt"};let n,r=e;const s=/^SRID=(\d+);/i.exec(e);if(s){const a=parseInt(s[1]??"0",10);switch(r=e.slice(s[0].length),a){case 4326:n="EPSG:4326";break;case 3857:n="EPSG:3857";break;case 27700:n="EPSG:27700";break}}return{...mu(r),detectedFormat:"ewkt",detectedProjection:n}}function gu(t){return t.map(e=>pu.stringify(e.geometry)).filter(Boolean).join(`

`)}function V4(t,e=4326){const n=gu(t);return n?n.split(`

`).map(r=>`SRID=${String(e)};${r}`).join(`

`):""}function J4(t){const e=t.trim().toUpperCase();return["POINT","LINESTRING","POLYGON","MULTIPOINT","MULTILINESTRING","MULTIPOLYGON","GEOMETRYCOLLECTION"].some(r=>e.startsWith(r))}function X4(t){return/^SRID=\d+;/i.test(t.trim())}const _u={name:"wkt",parse:mu,format:gu,detect:J4},yu={name:"ewkt",parse:z4,format:(t,e)=>{const n={"EPSG:4326":4326,"EPSG:3857":3857,"EPSG:27700":27700},r=e!=null&&e.projection?n[e.projection]??4326:4326;return V4(t,r)},detect:X4};function K4(t){return t.trim().replace(/(?:\r\n|\r|\n)/g," ").replace(/\s+/g," ")}function Y4(t){const e=K4(t);if(!e)return[];const n=e.split(/[#&\\:/|;,\s]/),r=[];for(const s of n){if(!s)continue;const i=Number(s);if(Number.isNaN(i))throw new Error(`Invalid number: ${s}`);r.push(i)}return r}function Q4(t){const e=t.trim();if(!e)return[];const n=e.split(/[#&\\:/|;,\t ]+/),r=[];for(const s of n){if(!s)continue;const i=Number(s);if(Number.isNaN(i))throw new Error(`Invalid number: ${s}`);r.push(i)}return r}function Z4(t){const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"csv"};try{const n=e.split(/\r?\n/).filter(s=>s.trim()),r=[];for(let s=0;s<n.length;s++){const i=n[s];if(!i)continue;const a=Q4(i);if(a.length===0)continue;if(a.length%2!==0)return{features:[],errors:[{message:`Line ${String(s+1)}: Odd number of coordinates - expected pairs of x,y (lon,lat)`}]};const o=[];for(let l=0;l<a.length;l+=2){const h=a[l]??0,u=a[l+1]??0;o.push([h,u])}const c=tS(o,s);r.push(c)}return r.length===0?{features:[],errors:[{message:"No coordinates found in input"}]}:{features:r,errors:[],detectedFormat:"csv"}}catch(n){return{features:[],errors:[{message:n instanceof Error?n.message:"Failed to parse CSV"}]}}}function tS(t,e){const n=`feature-${String(e)}`;if(t.length===1){const o=t[0];if(!o)throw new Error("Expected coordinate at index 0");return{type:"Feature",id:n,geometry:{type:"Point",coordinates:o},properties:{index:e}}}const r=t[0],s=t[t.length-1];return r&&s&&r[0]===s[0]&&r[1]===s[1]&&t.length>3?{type:"Feature",id:n,geometry:{type:"Polygon",coordinates:[t]},properties:{index:e}}:{type:"Feature",id:n,geometry:{type:"LineString",coordinates:t},properties:{index:e}}}function eS(t){const e=[];for(const n of t){const r=vu(n.geometry);if(r.length>0){const s=r.map(([i,a])=>`${String(i)},${String(a)}`).join(",");e.push(s)}}return e.join(`
`)}function vu(t){switch(t.type){case"Point":return[[t.coordinates[0]??0,t.coordinates[1]??0]];case"MultiPoint":case"LineString":return t.coordinates.map(e=>[e[0]??0,e[1]??0]);case"MultiLineString":case"Polygon":return t.coordinates.flat().map(e=>[e[0]??0,e[1]??0]);case"MultiPolygon":return t.coordinates.flat(2).map(e=>[e[0]??0,e[1]??0]);case"GeometryCollection":return t.geometries.flatMap(e=>vu(e));default:return[]}}function nS(t){const e=t.trim();if(e.startsWith("{")||e.startsWith("[")||e.toUpperCase().startsWith("POINT")||e.toUpperCase().startsWith("LINESTRING")||e.toUpperCase().startsWith("POLYGON")||e.toUpperCase().startsWith("SRID=")||e.startsWith("<"))return!1;try{const n=Y4(e);return n.length>=2&&n.length%2===0}catch{return!1}}const Su={name:"csv",parse:Z4,format:eS,detect:nS};function Do(t,e=5){const n=Math.pow(10,e),r=[];let s=0,i=0,a=0;for(;s<t.length;){let o=0,c=0,l;do l=t.charCodeAt(s++)-63,c|=(l&31)<<o,o+=5;while(l>=32);i+=(c&1)!==0?~(c>>1):c>>1,o=0,c=0;do l=t.charCodeAt(s++)-63,c|=(l&31)<<o,o+=5;while(l>=32);a+=(c&1)!==0?~(c>>1):c>>1,r.push([a/n,i/n])}return r}function rS(t,e=5){const n=Math.pow(10,e);let r="",s=0,i=0;for(const a of t){const o=a[0]??0,c=a[1]??0,l=Math.round(c*n),h=Math.round(o*n);r+=Uo(l-s),r+=Uo(h-i),s=l,i=h}return r}function Uo(t){let e="",n=t<0?~(t<<1):t<<1;for(;n>=32;)e+=String.fromCharCode((32|n&31)+63),n>>=5;return e+=String.fromCharCode(n+63),e}function Eu(t){const e=`polyline${String(t)}`;function n(i){const a=i.trim();if(!a)return{features:[],errors:[],detectedFormat:e};try{const o=Do(a,t);return o.length===0?{features:[],errors:[{message:"No coordinates decoded from polyline"}]}:{features:[{type:"Feature",id:"feature-0",geometry:{type:"LineString",coordinates:o},properties:{pointCount:o.length}}],errors:[],detectedFormat:e,detectedProjection:"EPSG:4326"}}catch(o){return{features:[],errors:[{message:o instanceof Error?o.message:"Failed to decode polyline"}]}}}function r(i){const a=[];for(const o of i){const c=bu(o.geometry);a.push(...c)}return a.length===0?"":rS(a,t)}function s(i){const a=i.trim();if(a.startsWith("{")||a.startsWith("[")||a.startsWith("<")||/[\s,;:]/.test(a)||!/^[?-~]+$/.test(a))return!1;try{const o=Do(a,t);if(o.length<2)return!1;for(const[c,l]of o)if(l===void 0||c===void 0||l<-90||l>90||c<-180||c>180)return!1;return!0}catch{return!1}}return{name:e,parse:n,format:r,detect:s}}function bu(t){switch(t.type){case"Point":return[t.coordinates];case"MultiPoint":case"LineString":return t.coordinates;case"MultiLineString":case"Polygon":return t.coordinates.flat();case"MultiPolygon":return t.coordinates.flat(2);case"GeometryCollection":return t.geometries.flatMap(e=>bu(e));default:return[]}}const Mu=Eu(5),xu=Eu(6);let Is=null;async function sS(){return Is||(Is=(await xe(()=>import("./togeojson-okOaiIBC.js").then(e=>e.t),__vite__mapDeps([0,1]),import.meta.url)).kml),Is}function iS(t){const e=[],n=t.split(/<\/kml>/i);for(const r of n){const s=r.trim();if(!s)continue;const i=s.match(/<\?xml[^?]*\?>/i),a=s.match(/<kml[^>]*>/i);if(a){const o=a.index??0;let c=s.slice(o)+"</kml>";i&&(i.index??0)<o&&(c=i[0]+`
`+c),e.push(c)}}return e}async function aS(t,e){const r=new DOMParser().parseFromString(t,"text/xml"),s=r.querySelector("parsererror");if(s)return{features:[],errors:[{message:"Invalid XML: "+s.textContent}]};const a=(await sS())(r);return a.features.length===0?{features:[],errors:[]}:{features:a.features.map((c,l)=>{var d;const h=c.properties??{},u=typeof h.name=="string"?h.name:void 0,f=typeof h.description=="string"?h.description:void 0;return{type:"Feature",id:((d=c.id)==null?void 0:d.toString())??`feature-${String(e+l)}`,geometry:c.geometry,properties:{...h,name:u,description:f}}}),errors:[]}}async function oS(t){const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"kml"};try{const n=iS(e);n.length===0&&n.push(e);const r=[],s=[];for(let i=0;i<n.length;i++){const a=n[i];if(!a)continue;const o=await aS(a,r.length);if(o.errors.length>0){const c=n.length>1?`Document ${String(i+1)}: `:"";s.push(...o.errors.map(l=>({message:c+l.message})))}else r.push(...o.features)}return r.length>0?{features:r,errors:s,detectedFormat:"kml",detectedProjection:"EPSG:4326"}:{features:[],errors:s.length>0?s:[{message:"No features found in KML"}]}}catch(n){return{features:[],errors:[{message:n instanceof Error?n.message:"Failed to parse KML"}]}}}function cS(t){return`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document>
${t.map((n,r)=>{const s=n.properties,i=s?s.name:void 0,a=typeof i=="string"?i:`Feature ${String(r+1)}`,o=n.geometry;let c="";if(o.type==="Point"){const[l,h,u]=o.coordinates;c=`<Point><coordinates>${String(l)},${String(h)}${u!==void 0?","+String(u):""}</coordinates></Point>`}else o.type==="LineString"?c=`<LineString><coordinates>${o.coordinates.map(h=>`${String(h[0])},${String(h[1])}${h[2]!==void 0?","+String(h[2]):""}`).join(" ")}</coordinates></LineString>`:o.type==="Polygon"&&(c=`<Polygon>${o.coordinates.map((h,u)=>{const f=h.map(p=>`${String(p[0])},${String(p[1])}${p[2]!==void 0?","+String(p[2]):""}`).join(" "),d=u===0?"outerBoundaryIs":"innerBoundaryIs";return`<${d}><LinearRing><coordinates>${f}</coordinates></LinearRing></${d}>`}).join("")}</Polygon>`);return`<Placemark><name>${lS(a)}</name>${c}</Placemark>`}).join(`
`)}
</Document>
</kml>`}function lS(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function uS(t){const e=t.trim();return!e.startsWith("<?xml")&&!e.toLowerCase().startsWith("<kml")?!1:/<kml/i.test(e)}const wu={name:"kml",parse:oS,format:cS,detect:uS};let ks=null;async function hS(){return ks||(ks=(await xe(()=>import("./togeojson-okOaiIBC.js").then(e=>e.t),__vite__mapDeps([0,1]),import.meta.url)).gpx),ks}function fS(t){const e=[],n=t.split(/<\/gpx>/i);for(const r of n){const s=r.trim();if(!s)continue;const i=s.match(/<\?xml[^?]*\?>/i),a=s.match(/<gpx[^>]*>/i);if(a){const o=a.index??0;let c=s.slice(o)+"</gpx>";i&&(i.index??0)<o&&(c=i[0]+`
`+c),e.push(c)}}return e}async function dS(t,e){const r=new DOMParser().parseFromString(t,"text/xml"),s=r.querySelector("parsererror");if(s)return{features:[],errors:[{message:"Invalid XML: "+s.textContent}]};const a=(await hS())(r);return a.features.length===0?{features:[],errors:[]}:{features:a.features.map((c,l)=>{var d;const h=c.properties??{},u=typeof h.name=="string"?h.name:void 0,f=typeof h.desc=="string"?h.desc:void 0;return{type:"Feature",id:((d=c.id)==null?void 0:d.toString())??`feature-${String(e+l)}`,geometry:c.geometry,properties:{...h,name:u,description:f}}}),errors:[]}}async function pS(t){const e=t.trim();if(!e)return{features:[],errors:[],detectedFormat:"gpx"};try{const n=fS(e);n.length===0&&n.push(e);const r=[],s=[];for(let i=0;i<n.length;i++){const a=n[i];if(!a)continue;const o=await dS(a,r.length);if(o.errors.length>0){const c=n.length>1?`Document ${String(i+1)}: `:"";s.push(...o.errors.map(l=>({message:c+l.message})))}else r.push(...o.features)}return r.length>0?{features:r,errors:s,detectedFormat:"gpx",detectedProjection:"EPSG:4326"}:{features:[],errors:s.length>0?s:[{message:"No features found in GPX"}]}}catch(n){return{features:[],errors:[{message:n instanceof Error?n.message:"Failed to parse GPX"}]}}}function mS(t){const e=[];for(const n of t){const r=n.properties,s=r?r.name:void 0,i=typeof s=="string"?s:"",a=n.geometry;if(a.type==="Point"){const[o,c,l]=a.coordinates;e.push(`<wpt lat="${String(c)}" lon="${String(o)}">${i?`<name>${Cs(i)}</name>`:""}${l!==void 0?`<ele>${String(l)}</ele>`:""}</wpt>`)}else if(a.type==="LineString"){const o=a.coordinates.map(c=>{const[l,h,u]=c;return`<trkpt lat="${String(h)}" lon="${String(l)}">${u!==void 0?`<ele>${String(u)}</ele>`:""}</trkpt>`}).join(`
        `);e.push(`<trk>${i?`<name>${Cs(i)}</name>`:""}<trkseg>
        ${o}
      </trkseg></trk>`)}else if(a.type==="MultiLineString"){const o=a.coordinates.map(c=>`<trkseg>
        ${c.map(h=>{const[u,f,d]=h;return`<trkpt lat="${String(f)}" lon="${String(u)}">${d!==void 0?`<ele>${String(d)}</ele>`:""}</trkpt>`}).join(`
        `)}
      </trkseg>`).join(`
      `);e.push(`<trk>${i?`<name>${Cs(i)}</name>`:""}${o}</trk>`)}}return`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="GeoFiddle" xmlns="http://www.topografix.com/GPX/1/1">
  ${e.join(`
  `)}
</gpx>`}function Cs(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function gS(t){const e=t.trim();return!e.startsWith("<?xml")&&!e.toLowerCase().startsWith("<gpx")?!1:/<gpx/i.test(e)}const Pu={name:"gpx",parse:pS,format:mS,detect:gS};var Tu,qo=()=>new DecompressionStream("deflate-raw");try{qo(),Tu=async t=>{let e=qo(),n=e.writable.getWriter(),r=e.readable.getReader(),s,i=[],a=0,o=0,c;for(n.write(t),n.close();!(c=await r.read()).done;)s=c.value,i.push(s),a+=s.length;return!i[1]&&s||(s=new Uint8Array(a),i.map(l=>(s.set(l,o),o+=l.length))),s}}catch{}var _S=new TextDecoder,As=t=>{throw new Error("but-unzip~"+t)},Bo=t=>_S.decode(t);function*yS(t,e=Tu){let n=t.length-20,r=Math.max(n-65516,2);for(;(n=t.lastIndexOf(80,n-1))!==-1&&!(t[n+1]===75&&t[n+2]===5&&t[n+3]===6)&&n>r;);n===-1&&As(2);let s=(l,h)=>t.subarray(n+=l,n+=h),i=new DataView(t.buffer,t.byteOffset),a=l=>i.getUint16(l+n,!0),o=l=>i.getUint32(l+n,!0),c=a(10);for(c!==a(8)&&As(3),n=o(16);c--;){let l=a(10),h=a(30),u=a(32),f=o(20),d=o(42),p=Bo(s(46,a(28))),_=Bo(s(h,u)),m=n,y;n=d,y=s(30+a(26)+a(28),f),yield{filename:p,comment:_,read:()=>l&8?e(y):l?As(1):y},n=m}}const vS=/.+\.(shp|dbf|json|prj|cpg)$/i,SS=async t=>{const e={},n=[];for(const i of yS(t))vS.test(i.filename)&&n.push(Promise.resolve(i.read()).then(a=>e[i.filename]=a));await Promise.all(n);const r={},s=new TextDecoder;for(const[i,a]of Object.entries(e))i.slice(-3).toLowerCase()==="shp"||i.slice(-3).toLowerCase()==="dbf"?r[i]=new DataView(a.buffer,a.byteOffset,a.byteLength):r[i]=s.decode(a);return r},ES=globalThis.URL,bS=(t,e)=>{if(!e)return t;const n=new ES(t);return n.pathname=`${n.pathname}.${e}`,n.href};async function Dn(t,e){const n=bS(t,e),r=e==="prj"||e==="cpg";try{const s=await fetch(n);if(s.status>399)throw new Error(s.statusText);if(r)return s.text();const i=await s.arrayBuffer();return new DataView(i)}catch(s){if(r||e==="dbf")return!1;throw s}}function MS(t){let e=0,n=1;const r=t.length;let s,i;const a=[t[0][0],t[0][1],t[0][0],t[0][1]];for(;n<r;)s=i||t[0],i=t[n],e+=(i[0]-s[0])*(i[1]+s[1]),n++,i[0]<a[0]&&(a[0]=i[0]),i[1]<a[1]&&(a[1]=i[1]),i[0]>a[2]&&(a[2]=i[0]),i[1]>a[3]&&(a[3]=i[1]);return{ring:t,clockWise:e>0,bbox:a,children:[]}}function Ho(t,e){return!(t.bbox[0]>e.bbox[0]||t.bbox[1]>e.bbox[1]||t.bbox[2]<e.bbox[2]||t.bbox[3]<e.bbox[3])}function Nu(t,e=!1){const n=[],r=[];for(const a of t){const o=MS(a);o.clockWise!==e?n.push(o):r.push(o)}const s=[];for(const a of r){let o;for(const c of n)Ho(c,a)&&(o?Ho(o,c)&&(o=c):o=c);o?o.children.push(a.ring):s.push(a)}if(e)return{outers:n,orphens:s};if(s.length&&!e){const a=Nu(t,!0);if(a.orphens.length===0){const o=[];for(const c of a.outers)o.push([c.ring.toReversed()].concat(c.children.map(l=>l.toReversed())));return o}}const i=[];for(const a of n)i.push([a.ring].concat(a.children));return i}et.prototype.parsePoint=function(t){return{type:"Point",coordinates:this.parseCoord(t,0)}};et.prototype.parseZPoint=function(t){const e=this.parsePoint(t);return e.coordinates.push(t.getFloat64(16,!0)),e};et.prototype.parsePointArray=function(t,e,n){const r=[];let s=0;for(;s<n;)r.push(this.parseCoord(t,e)),e+=16,s++;return r};et.prototype.parseZPointArray=function(t,e,n,r){let s=0;for(;s<n;)r[s].push(t.getFloat64(e,!0)),s++,e+=8;return r};et.prototype.parseArrayGroup=function(t,e,n,r,s){const i=[];let a=0,o,c=0,l;for(;a<r;)a++,n+=4,o=c,a===r?c=s:c=t.getInt32(n,!0),l=c-o,l&&(i.push(this.parsePointArray(t,e,l)),e+=l<<4);return i};et.prototype.parseZArrayGroup=function(t,e,n,r){let s=0;for(;s<n;)r[s]=this.parseZPointArray(t,e,r[s].length,r[s]),e+=r[s].length<<3,s++;return r};et.prototype.parseMultiPoint=function(t){const e={},n=t.getInt32(32,!0);if(!n)return null;const r=this.parseCoord(t,0),s=this.parseCoord(t,16);e.bbox=[r[0],r[1],s[0],s[1]];const i=36;return n===1?(e.type="Point",e.coordinates=this.parseCoord(t,i)):(e.type="MultiPoint",e.coordinates=this.parsePointArray(t,i,n)),e};et.prototype.parseZMultiPoint=function(t){const e=this.parseMultiPoint(t);if(!e)return null;let n;if(e.type==="Point")return e.coordinates.push(t.getFloat64(72,!0)),e;n=e.coordinates.length;const r=52+(n<<4);return e.coordinates=this.parseZPointArray(t,r,n,e.coordinates),e};et.prototype.parsePolyline=function(t){const e={},n=t.getInt32(32,!0);if(!n)return null;const r=this.parseCoord(t,0),s=this.parseCoord(t,16);e.bbox=[r[0],r[1],s[0],s[1]];const i=t.getInt32(36,!0);let a,o;return n===1?(e.type="LineString",a=44,e.coordinates=this.parsePointArray(t,a,i)):(e.type="MultiLineString",a=40+(n<<2),o=40,e.coordinates=this.parseArrayGroup(t,a,o,n,i)),e};et.prototype.parseZPolyline=function(t){const e=this.parsePolyline(t);if(!e)return null;const n=e.coordinates.length;let r;return e.type==="LineString"?(r=60+(n<<4),e.coordinates=this.parseZPointArray(t,r,n,e.coordinates),e):(r=56+(e.coordinates.reduce(function(i,a){return i+a.length},0)<<4)+(n<<2),e.coordinates=this.parseZArrayGroup(t,r,n,e.coordinates),e)};et.prototype.polyFuncs=function(t){return t&&(t.type==="LineString"?(t.type="Polygon",t.coordinates=[t.coordinates],t):(t.coordinates=Nu(t.coordinates),t.coordinates.length===1?(t.type="Polygon",t.coordinates=t.coordinates[0],t):(t.type="MultiPolygon",t)))};et.prototype.parsePolygon=function(t){return this.polyFuncs(this.parsePolyline(t))};et.prototype.parseZPolygon=function(t){return this.polyFuncs(this.parseZPolyline(t))};const Wo={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function xS(t){return t?function(e,n){const r=[e.getFloat64(n,!0),e.getFloat64(n+8,!0)];return t.inverse(r)}:function(e,n){return[e.getFloat64(n,!0),e.getFloat64(n+8,!0)]}}function et(t,e){if(!(this instanceof et))return new et(t,e);this.buffer=t,this.headers=this.parseHeader(),this.shpFuncs(e),this.rows=this.getRows()}et.prototype.shpFuncs=function(t){let e=this.headers.shpCode;if(e>20&&(e-=20),!(e in Wo))throw new Error(`I don't know shp type "${e}"`);this.parseFunc=this[Wo[e]],this.parseCoord=xS(t)};et.prototype.getShpCode=function(){return this.parseHeader().shpCode};et.prototype.parseHeader=function(){const t=this.buffer;return{length:t.getInt32(24)<<1,version:t.getInt32(28,!0),shpCode:t.getInt32(32,!0),bbox:[t.getFloat64(36,!0),t.getFloat64(44,!0),t.getFloat64(52,!0),t.getFloat64(60,!0)]}};et.prototype.getRows=function(){let t=100;const e=this.buffer.byteLength-8,n=[];let r;for(;t<=e&&(r=this.getRow(t),!!r);)t+=8,t+=r.len,r.type?n.push(this.parseFunc(r.data)):n.push(null);return n};et.prototype.getRow=function(t){const e=this.buffer.getInt32(t),n=this.buffer.getInt32(t+4)<<1;if(n===0)return{id:e,len:n,type:0};if(!(t+n+8>this.buffer.byteLength))return{id:e,len:n,data:new DataView(this.buffer.buffer,this.buffer.byteOffset+t+12,n-4),type:this.buffer.getInt32(t+8,!0)}};function Xi(t,e){return new et(t,e).rows}var wS=/^(?:ANSI\s)?(\d+)$/m;function Iu(t,e){if(!t)return r;try{new TextDecoder(t.trim())}catch{var n=wS.exec(t);return n&&!e?Iu("windows-"+n[1],!0):(t=void 0,r)}return r;function r(s){var i=new TextDecoder(t||void 0),a=i.decode(s,{stream:!0})+i.decode();return a.replace(/\0/g,"").trim()}}function PS(t){var e={};return e.lastUpdated=new Date(t.getUint8(1)+1900,t.getUint8(2),t.getUint8(3)),e.records=t.getUint32(4,!0),e.headerLen=t.getUint16(8,!0),e.recLen=t.getUint16(10,!0),e}function TS(t,e,n){for(var r=[],s=32;s<e&&(r.push({name:n(new Uint8Array(t.buffer.slice(t.byteOffset+s,t.byteOffset+s+11))),dataType:String.fromCharCode(t.getUint8(s+11)),len:t.getUint8(s+16),decimal:t.getUint8(s+17)}),t.getUint8(s+32)!==13);)s+=32;return r}function NS(t,e,n,r,s){const i=new Uint8Array(t.buffer.slice(t.byteOffset+e,t.byteOffset+e+n));var a=s(i);switch(r){case"N":case"F":case"O":return parseFloat(a,10);case"D":return new Date(a.slice(0,4),parseInt(a.slice(4,6),10)-1,a.slice(6,8));case"L":return a.toLowerCase()==="y"||a.toLowerCase()==="t";default:return a}}function IS(t,e,n,r){for(var s={},i=0,a=n.length,o,c;i<a;)c=n[i],o=NS(t,e,c.len,c.dataType,r),e+=c.len,typeof o<"u"&&(s[c.name]=o),i++;return s}function Ki(t,e){for(var n=Iu(e),r=PS(t),s=TS(t,r.headerLen-1,n),i=(s.length+1<<5)+2,a=r.recLen,o=r.records,c=[];o;)c.push(IS(t,i,s,n)),i+=a,o--;return c}const kS=globalThis.URL,CS=t=>{if(!t)throw new Error("forgot to pass buffer");if(rn(t))return new Uint8Array(t);if(rn(t.buffer))return t.BYTES_PER_ELEMENT===1?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("invalid buffer like object")},AS=new TextDecoder,ku=t=>{if(t){if(typeof t=="string")return t;if(rn(t)||ArrayBuffer.isView(t)||Yi(t))return AS.decode(t)}},Cu=t=>{if(!t)throw new Error("forgot to pass buffer");if(Yi(t))return t;if(rn(t))return new DataView(t);if(rn(t.buffer))return new DataView(t.buffer,t.byteOffset,t.byteLength);throw new Error("invalid buffer like object")};function rn(t){return t instanceof globalThis.ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]"}function Yi(t){return t instanceof globalThis.DataView||Object.prototype.toString.call(t)==="[object DataView]"}const Qi=function([t,e]){const n={};n.type="FeatureCollection",n.features=[];let r=0;const s=t.length;for(e||(e=[]);r<s;)n.features.push({type:"Feature",geometry:t[r],properties:e[r]||{}}),r++;return n},Au=async function(t,e){let n;t=CS(t);const r=await SS(t),s=[];e=e||[];for(n in r)n.indexOf("__MACOSX")===-1&&(n.slice(-4).toLowerCase()===".shp"?(s.push(n.slice(0,-4)),r[n.slice(0,-3)+n.slice(-3).toLowerCase()]=r[n]):n.slice(-4).toLowerCase()===".prj"?r[n.slice(0,-3)+n.slice(-3).toLowerCase()]=te(r[n]):n.slice(-5).toLowerCase()===".json"||e.indexOf(n.split(".").pop())>-1?s.push(n.slice(0,-3)+n.slice(-3).toLowerCase()):(n.slice(-4).toLowerCase()===".dbf"||n.slice(-4).toLowerCase()===".cpg")&&(r[n.slice(0,-3)+n.slice(-3).toLowerCase()]=r[n]));if(!s.length)throw new Error("no layers founds");const i=s.map(function(a){let o,c;const l=a.lastIndexOf(".");return l>-1&&a.slice(l).indexOf("json")>-1?(o=JSON.parse(r[a]),o.fileName=a.slice(0,l)):e.indexOf(a.slice(l+1))>-1?(o=r[a],o.fileName=a):(r[a+".dbf"]&&(c=Ki(r[a+".dbf"],r[a+".cpg"])),o=Qi([Xi(r[a+".shp"],r[a+".prj"]),c]),o.fileName=a),o});return i.length===1?i[0]:i};async function GS(t,e){const n=await Dn(t);return Au(n,e)}const RS=async t=>{const e=await Promise.all([Dn(t,"shp"),Dn(t,"prj")]);let n=!1;try{e[1]&&(n=te(e[1]))}catch{n=!1}return Xi(e[0],n)},LS=async t=>{const[e,n]=await Promise.all([Dn(t,"dbf"),Dn(t,"cpg")]);if(e)return Ki(e,n)},zo=(t,e)=>{var r;return new kS(t,(r=globalThis==null?void 0:globalThis.document)==null?void 0:r.location).pathname.slice(-4).toLowerCase()===e},OS=({shp:t,dbf:e,cpg:n,prj:r})=>{const s=[FS(t,r)];return e&&s.push($S(e,n)),Qi(s)},jS=async function(t,e){if(typeof t!="string"){if(rn(t)||ArrayBuffer.isView(t)||Yi(t))return Au(t);if(t.shp)return OS(t);throw new TypeError("must be a string, some sort of Buffer, or an object with at least a .shp property")}if(zo(t,".zip"))return GS(t,e);zo(t,".shp")&&(t=t.slice(0,-4));const n=await Promise.all([RS(t),LS(t)]);return Qi(n)},FS=function(t,e){if(t=Cu(t),e=ku(e),typeof e=="string")try{e=te(e)}catch{e=!1}return Xi(t,e)},$S=function(t,e){return t=Cu(t),e=ku(e),Ki(t,e)};async function DS(t){var e;try{let n;if(typeof t=="string"){if(t.trim()==="")return{features:[],errors:[],detectedFormat:"shapefile"};const o=t.replace(/^data:.*?;base64,/,""),c=atob(o),l=new Uint8Array(c.length);for(let h=0;h<c.length;h++)l[h]=c.charCodeAt(h);n=l.buffer}else n=t;const r=await jS(n),s=Array.isArray(r)?r:[r],i=[];let a=0;for(const o of s)for(const c of o.features)i.push({type:"Feature",id:((e=c.id)==null?void 0:e.toString())??`feature-${String(a)}`,geometry:c.geometry,properties:c.properties??{}}),a++;return i.length===0?{features:[],errors:[{message:"No features found in shapefile"}]}:{features:i,errors:[],detectedFormat:"shapefile",detectedProjection:"EPSG:4326"}}catch(n){return{features:[],errors:[{message:n instanceof Error?n.message:"Failed to parse shapefile"}]}}}function US(t){return t.trim()?{features:[],errors:[{message:"Shapefile parsing requires async operation. Use parseShapefile() instead."}]}:{features:[],errors:[],detectedFormat:"shapefile"}}function qS(t){return JSON.stringify({type:"FeatureCollection",features:t},null,2)}function BS(t){const e=t.trim();return!!(e.startsWith("data:application/zip")||e.startsWith("data:application/octet-stream")||e.startsWith("data:application/x-zip")||e.startsWith("UEs")||e.startsWith("UEsD"))}const Gu={name:"shapefile",parse:US,parseAsync:DS,format:qS,detect:BS},Zi={geojson:du,ewkt:yu,wkt:_u,kml:wu,gpx:Pu,shapefile:Gu,polyline6:xu,polyline5:Mu,csv:Su};async function li(t,e){const n=Zi[e];return n?n.parse(t):{features:[],errors:[{message:`Unsupported format: ${e}`}]}}function Me(t,e,n){const r=Zi[e];if(!r)throw new Error(`Unsupported format: ${e}`);return r.format(t,n)}function Ru(t){const e=t.trim();if(!e)return null;for(const[n,r]of Object.entries(Zi))if(r.detect(e))return n;return null}const HS=Object.freeze(Object.defineProperty({__proto__:null,csvParser:Su,detectFormat:Ru,ewktParser:yu,format:Me,geojsonParser:du,gpxParser:Pu,kmlParser:wu,parse:li,polyline5Parser:Mu,polyline6Parser:xu,shapefileParser:Gu,wktParser:_u},Symbol.toStringTag,{value:"Module"}));function WS(t){const e=[],n=r=>{if(!r)return;if(r.type==="GeometryCollection"){for(const i of r.geometries)n(i);return}const s=i=>{if(Array.isArray(i))if(typeof i[0]=="number"&&typeof i[1]=="number")e.push(i);else for(const a of i)s(a)};s(r.coordinates)};for(const r of t)n(r.geometry);return e}function zS(){const{features:t,isParsing:e,inputProjection:n,detectedProjection:r}=Ft(),{outputFormat:s,outputProjection:i}=or(),a=x.useMemo(()=>{if(n!=="auto")return n;if(r)return r;if(t.length>0){const l=WS(t);return ar(l)}return"EPSG:4326"},[n,r,t]),o=x.useMemo(()=>{if(t.length===0)return"";try{const l=a===i?t:t.map(h=>({...h,geometry:me(h.geometry,a,i)}));return Me(l,s,{projection:i})}catch{return""}},[t,s,a,i]),c=x.useCallback(async()=>{o&&await navigator.clipboard.writeText(o)},[o]);return e?g.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-md border border-neutral-200 bg-neutral-100 p-3 text-sm text-neutral-600 dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-400",children:[g.jsxs("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Parsing..."]}):g.jsxs("div",{className:"relative mb-3",children:[g.jsx("pre",{className:"max-h-48 min-h-[3rem] overflow-auto rounded-md border border-neutral-200 bg-neutral-100 p-3 pr-10 font-mono text-sm text-neutral-900 dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100",children:o||" "}),o&&g.jsx("button",{onClick:c,className:"absolute right-2 top-2 flex h-7 w-7 items-center justify-center rounded text-neutral-500 transition-colors hover:bg-neutral-200 hover:text-neutral-700 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-200",title:"Copy to clipboard","aria-label":"Copy converted geometry to clipboard",children:g.jsx(Gl,{className:"h-4 w-4"})})]})}var lt=63710088e-1,VS={centimeters:lt*100,centimetres:lt*100,degrees:360/(2*Math.PI),feet:lt*3.28084,inches:lt*39.37,kilometers:lt/1e3,kilometres:lt/1e3,meters:lt,metres:lt,miles:lt/1609.344,millimeters:lt*1e3,millimetres:lt*1e3,nauticalmiles:lt/1852,radians:1,yards:lt*1.0936};function ui(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function JS(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return ui({type:"LineString",coordinates:t},e,n)}function hi(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function XS(t,e="kilometers"){const n=VS[e];if(!n)throw new Error(e+" units is invalid");return t*n}function vr(t){return t%360*Math.PI/180}function Vo(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function KS(t,e,n={}){var r=Vo(t),s=Vo(e),i=vr(s[1]-r[1]),a=vr(s[0]-r[0]),o=vr(r[1]),c=vr(s[1]),l=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(o)*Math.cos(c);return XS(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),n.units)}function ta(t,e,n){if(t!==null)for(var r,s,i,a,o,c,l,h=0,u=0,f,d=t.type,p=d==="FeatureCollection",_=d==="Feature",m=p?t.features.length:1,y=0;y<m;y++){l=p?t.features[y].geometry:_?t.geometry:t,f=l?l.type==="GeometryCollection":!1,o=f?l.geometries.length:1;for(var S=0;S<o;S++){var M=0,N=0;if(a=f?l.geometries[S]:l,a!==null){c=a.coordinates;var I=a.type;switch(h=0,I){case null:break;case"Point":if(e(c,u,y,M,N)===!1)return!1;u++,M++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(e(c[r],u,y,M,N)===!1)return!1;u++,I==="MultiPoint"&&M++}I==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(s=0;s<c[r].length-h;s++){if(e(c[r][s],u,y,M,N)===!1)return!1;u++}I==="MultiLineString"&&M++,I==="Polygon"&&N++}I==="Polygon"&&M++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(N=0,s=0;s<c[r].length;s++){for(i=0;i<c[r][s].length-h;i++){if(e(c[r][s][i],u,y,M,N)===!1)return!1;u++}N++}M++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(ta(a.geometries[r],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Lu(t,e){var n,r,s,i,a,o,c,l,h,u,f=0,d=t.type==="FeatureCollection",p=t.type==="Feature",_=d?t.features.length:1;for(n=0;n<_;n++){for(o=d?t.features[n].geometry:p?t.geometry:t,l=d?t.features[n].properties:p?t.properties:{},h=d?t.features[n].bbox:p?t.bbox:void 0,u=d?t.features[n].id:p?t.id:void 0,c=o?o.type==="GeometryCollection":!1,a=c?o.geometries.length:1,s=0;s<a;s++){if(i=c?o.geometries[s]:o,i===null){if(e(null,f,l,h,u)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(i,f,l,h,u)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<i.geometries.length;r++)if(e(i.geometries[r],f,l,h,u)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}f++}}function YS(t,e,n){var r=n;return Lu(t,function(s,i,a,o,c){r=e(r,s,i,a,o,c)}),r}function QS(t,e){Lu(t,function(n,r,s,i,a){var o=n===null?null:n.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(ui(n,s,{bbox:i,id:a}),r,0)===!1?!1:void 0}var c;switch(o){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var l=0;l<n.coordinates.length;l++){var h=n.coordinates[l],u={type:c,coordinates:h};if(e(ui(u,s),r,l)===!1)return!1}})}function ZS(t,e){QS(t,function(n,r,s){var i=0;if(n.geometry){var a=n.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var o,c=0,l=0,h=0;if(ta(n,function(u,f,d,p,_){if(o===void 0||r>c||p>l||_>h){o=u,c=r,l=p,h=_,i=0;return}var m=JS([o,u],n.properties);if(e(m,r,s,_,i)===!1)return!1;i++,o=u})===!1)return!1}}})}function tE(t,e,n){var r=n,s=!1;return ZS(t,function(i,a,o,c,l){s===!1&&n===void 0?r=i:r=e(r,i,a,o,c,l),s=!0}),r}function eE(t){return YS(t,(e,n)=>e+nE(n),0)}function nE(t){let e=0,n;switch(t.type){case"Polygon":return Jo(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=Jo(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Jo(t){let e=0;if(t&&t.length>0){e+=Math.abs(Xo(t[0]));for(let n=1;n<t.length;n++)e-=Math.abs(Xo(t[n]))}return e}var rE=lt*lt/2,Gs=Math.PI/180;function Xo(t){const e=t.length-1;if(e<=2)return 0;let n=0,r=0;for(;r<e;){const s=t[r],i=t[r+1===e?0:r+1],a=t[r+2>=e?(r+2)%e:r+2],o=s[0]*Gs,c=i[1]*Gs,l=a[0]*Gs;n+=(l-o)*Math.sin(c),r++}return n*rE}function Lr(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const n=[1/0,1/0,-1/0,-1/0];return ta(t,r=>{n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}function sE(t,e={}){return tE(t,(n,r)=>{const s=r.geometry.coordinates;return n+KS(s[0],s[1],e)},0)}const iE={longitude:-.1276,latitude:51.5074,zoom:10},ea=tr(t=>({viewState:iE,basemap:"osm",panToFeatureId:null,isEnvelopeHovered:!1,setViewState:e=>{t({viewState:e})},setBasemap:e=>{t({basemap:e})},panToFeature:e=>{t({panToFeatureId:e})},clearPanToFeature:()=>{t({panToFeatureId:null})},setEnvelopeHovered:e=>{t({isEnvelopeHovered:e})}}));function aE(t){const e=[],n=r=>{if(!r)return;if(r.type==="GeometryCollection"){for(const i of r.geometries)n(i);return}const s=i=>{if(Array.isArray(i))if(typeof i[0]=="number"&&typeof i[1]=="number")e.push(i);else for(const a of i)s(a)};s(r.coordinates)};for(const r of t)n(r.geometry);return e}function re(t,e){const n=e==="EPSG:4326"?6:2;return t.toFixed(n)}function oE(){const{features:t,inputProjection:e,detectedProjection:n}=Ft(),{outputProjection:r}=or(),{setEnvelopeHovered:s}=ea(),i=x.useMemo(()=>{if(e!=="auto")return e;if(n)return n;if(t.length>0){const d=aE(t);return ar(d)}return"EPSG:4326"},[e,n,t]),a=x.useMemo(()=>{if(t.length===0)return null;try{const d=i==="EPSG:4326"?t:t.map(K=>({...K,geometry:me(K.geometry,i,"EPSG:4326")})),p=hi(d),_=Lr(p);if(!_.every(K=>isFinite(K)))return null;const[m,y,S,M]=_,N={type:"Polygon",coordinates:[[[m,y],[S,y],[S,M],[m,M],[m,y]]]},v=(r!=="EPSG:4326"?me(N,"EPSG:4326",r):N).coordinates[0];if(!v||v.length<4)return null;const E=v[0],k=v[2];if(!E||!k||E.length<2||k.length<2)return null;const L=E[0],V=E[1],W=k[0],it=k[1];return L===void 0||V===void 0||W===void 0||it===void 0?null:{sw:{x:L,y:V},ne:{x:W,y:it},wgs84Bbox:_}}catch{return null}},[t,i,r]),o=x.useCallback(async()=>{if(!a)return;const d=`SW: ${re(a.sw.x,r)}, ${re(a.sw.y,r)}
NE: ${re(a.ne.x,r)}, ${re(a.ne.y,r)}`;await navigator.clipboard.writeText(d)},[a,r]),c=x.useCallback(()=>{s(!0)},[s]),l=x.useCallback(()=>{s(!1)},[s]);if(!a)return null;const h=r==="EPSG:4326",u=h?"Lon":"E",f=h?"Lat":"N";return g.jsxs("div",{className:"mb-3 flex items-center justify-between rounded-md border border-neutral-200 bg-neutral-50 px-3 py-2 text-xs dark:border-neutral-700 dark:bg-neutral-800",onMouseEnter:c,onMouseLeave:l,children:[g.jsxs("div",{className:"flex flex-col gap-0.5 font-mono text-neutral-700 dark:text-neutral-300",children:[g.jsxs("div",{children:[g.jsx("span",{className:"text-neutral-500 dark:text-neutral-400",children:"SW: "}),u," ",re(a.sw.x,r),", ",f," ",re(a.sw.y,r)]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-neutral-500 dark:text-neutral-400",children:"NE: "}),u," ",re(a.ne.x,r),", ",f," ",re(a.ne.y,r)]})]}),g.jsx("button",{onClick:o,className:"flex h-7 w-7 items-center justify-center rounded text-neutral-500 transition-colors hover:bg-neutral-200 hover:text-neutral-700 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-200",title:"Copy to clipboard","aria-label":"Copy envelope coordinates to clipboard",children:g.jsx(Gl,{className:"h-4 w-4"})})]})}function cE(t){const e=[],n=r=>{if(!r)return;if(r.type==="GeometryCollection"){for(const i of r.geometries)n(i);return}const s=i=>{if(Array.isArray(i))if(typeof i[0]=="number"&&typeof i[1]=="number")e.push(i);else for(const a of i)s(a)};s(r.coordinates)};for(const r of t)n(r.geometry);return e}function lE(t){switch(t){case"geojson":return"application/geo+json";case"wkt":case"ewkt":case"csv":return"text/plain";case"polyline5":case"polyline6":return"text/plain";default:return"text/plain"}}function uE(t){switch(t){case"geojson":return"geojson";case"wkt":return"wkt";case"ewkt":return"ewkt";case"csv":return"csv";case"polyline5":case"polyline6":return"txt";default:return"txt"}}function hE(){const{features:t,inputProjection:e,detectedProjection:n}=Ft(),{outputFormat:r,outputProjection:s}=or(),i=x.useMemo(()=>{if(e!=="auto")return e;if(n)return n;if(t.length>0){const l=cE(t);return ar(l)}return"EPSG:4326"},[e,n,t]),a=x.useMemo(()=>{if(t.length===0)return"";try{const l=i===s?t:t.map(h=>({...h,geometry:me(h.geometry,i,s)}));return Me(l,r,{projection:s})}catch{return""}},[t,r,i,s]),o=x.useCallback(()=>{if(!a)return;const l=lE(r),h=uE(r),u=new Blob([a],{type:l}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=`geometry.${h}`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)},[a,r]),c=!a;return g.jsx("button",{onClick:o,disabled:c,className:"flex h-7 w-7 items-center justify-center rounded text-neutral-500 transition-colors hover:bg-neutral-200 hover:text-neutral-700 disabled:cursor-not-allowed disabled:opacity-50 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-200",title:"Download","aria-label":"Download converted geometry",children:g.jsx(n1,{className:"h-4 w-4"})})}const fE=[{value:"geojson",label:"GeoJSON"},{value:"wkt",label:"WKT"},{value:"ewkt",label:"EWKT"},{value:"csv",label:"CSV"},{value:"polyline5",label:"Polyline (5)"},{value:"polyline6",label:"Polyline (6)"}],dE=[{value:"EPSG:4326",label:"WGS84 (EPSG:4326)"},{value:"EPSG:3857",label:"Web Mercator (EPSG:3857)"},{value:"EPSG:27700",label:"British National Grid (EPSG:27700)"}];function pE(){const{outputFormat:t,outputProjection:e,setOutputFormat:n,setOutputProjection:r}=or(),{features:s}=Ft(),i=s.length>0;return g.jsxs("div",{className:"flex-1 p-3 md:p-4",children:[g.jsxs("div",{className:"mb-2 flex items-center justify-between md:mb-3",children:[g.jsx("h2",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Conversion"}),i&&g.jsx(hE,{})]}),g.jsxs("div",{className:"mb-2 flex gap-2 md:mb-3",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"label",children:"Format"}),g.jsx("select",{value:t,onChange:a=>{n(a.target.value)},className:"input",children:fE.map(a=>g.jsx("option",{value:a.value,children:a.label},a.value))})]}),g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"label",children:"Projection"}),g.jsx("select",{value:e,onChange:a=>{r(a.target.value)},className:"input",children:dE.map(a=>g.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),g.jsx(zS,{}),i&&g.jsx(oE,{})]})}function mE(t){if(!t||t.type!=="Polygon"&&t.type!=="MultiPolygon")return null;try{return eE({type:"Feature",geometry:t,properties:{}})}catch{return null}}function gE(t){if(!t||t.type!=="LineString"&&t.type!=="MultiLineString")return null;try{return sE({type:"Feature",geometry:t,properties:{}},{units:"meters"})}catch{return null}}function Ou(t){if(!t)return 0;switch(t.type){case"Point":return 1;case"MultiPoint":case"LineString":return t.coordinates.length;case"MultiLineString":case"Polygon":return t.coordinates.reduce((e,n)=>e+n.length,0);case"MultiPolygon":return t.coordinates.reduce((e,n)=>e+n.reduce((r,s)=>r+s.length,0),0);case"GeometryCollection":return t.geometries.reduce((e,n)=>e+Ou(n),0);default:return 0}}function _E(t){return t?t.replace(/([A-Z])/g," $1").trim():"Unknown"}function yE(t){return t===null?"-":t>=1e6?`${(t/1e6).toFixed(2)} km`:t>=1e4?`${(t/1e4).toFixed(2)} ha`:`${t.toFixed(2)} m`}function vE(t){return t===null?"-":t>=1e3?`${(t/1e3).toFixed(2)} km`:`${t.toFixed(2)} m`}const SE="geofiddle-geocode",EE=1,sn="geocode-results",bE=10080*60*1e3;let Sr=null;function ju(){return Sr||(Sr=new Promise((t,e)=>{const n=indexedDB.open(SE,EE);n.onerror=()=>{var r;e(new Error(((r=n.error)==null?void 0:r.message)??"Failed to open IndexedDB"))},n.onsuccess=()=>{t(n.result)},n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(sn)||s.createObjectStore(sn,{keyPath:"key"})}}),Sr)}function ME(t,e){const n=Math.round(t*1e3)/1e3,r=Math.round(e*1e3)/1e3;return`${String(n)},${String(r)}`}async function xE(t){try{const e=await ju();return await new Promise(n=>{const i=e.transaction(sn,"readonly").objectStore(sn).get(t);i.onsuccess=()=>{const a=i.result;a&&Date.now()-a.timestamp<bE?n(a.location):n(null)},i.onerror=()=>{n(null)}})}catch{return null}}async function wE(t,e){try{const n=await ju();await new Promise(r=>{const s=n.transaction(sn,"readwrite"),i=s.objectStore(sn),a={key:t,location:e,timestamp:Date.now()};i.put(a),s.oncomplete=()=>{r()},s.onerror=()=>{r()}})}catch{}}const PE="https://nominatim.openstreetmap.org/reverse",TE=1e3;let Ko=0;const Rs=new Map;function NE(t){if(!t.address)return null;const{city:e,town:n,village:r,municipality:s,county:i,state:a,country:o}=t.address,c=e??n??r??s??i;return c&&o?`${c}, ${o}`:a&&o?`${a}, ${o}`:o||null}async function IE(t,e){const n=ME(t,e),r=Rs.get(n);if(r)return r;const s=await xE(n);if(s)return s;const a=Date.now()-Ko,o=Math.max(0,TE-a),c=new Promise(l=>{setTimeout(()=>{Ko=Date.now(),(async()=>{try{const u=new URL(PE);u.searchParams.set("lat",String(t)),u.searchParams.set("lon",String(e)),u.searchParams.set("format","json"),u.searchParams.set("zoom","10");const f=await fetch(u.toString(),{headers:{"User-Agent":"GeoFiddle/2.0 (https://geofiddle.com)"}});if(!f.ok)return null;const d=await f.json(),p=NE(d);return p&&await wE(n,p),p}catch{return null}finally{Rs.delete(n)}})().then(l).catch(()=>{l(null)})},o)});return Rs.set(n,c),c}function kE(t,e){const[n,r]=x.useState(null),[s,i]=x.useState(!1),a=x.useRef(!1);return x.useEffect(()=>{if(t===null||e===null){r(null),i(!1);return}if(t<-90||t>90||e<-180||e>180){r(null),i(!1);return}return a.current=!1,i(!0),IE(t,e).then(o=>{a.current||(r(o),i(!1))}).catch(()=>{a.current||(r(null),i(!1))}),()=>{a.current=!0}},[t,e]),{location:n,isLoading:s}}function Fu(t){if(!t||typeof t!="object")return null;const e=t;if(e.type==="GeometryCollection"&&Array.isArray(e.geometries)){for(const a of e.geometries){const o=Fu(a);if(o)return o}return null}if(!e.coordinates)return null;const n=[],r=a=>{if(Array.isArray(a))if(typeof a[0]=="number"&&typeof a[1]=="number")n.push([a[0],a[1]]);else for(const o of a)r(o)};if(r(e.coordinates),n.length===0)return null;let s=0,i=0;for(const[a,o]of n)s+=a,i+=o;return{lon:s/n.length,lat:i/n.length}}function CE(t){switch(t){case"Point":return uo;case"MultiPoint":return t1;case"LineString":return ho;case"MultiLineString":return ho;case"Polygon":return Ol;case"MultiPolygon":return a1;case"GeometryCollection":return Xg;default:return uo}}function AE(t){return t==null?"":typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"?String(t):JSON.stringify(t)}function GE({feature:t,calculations:e}){const{geometry:n,properties:r}=t,s=x.useMemo(()=>Fu(n),[n]),{location:i,isLoading:a}=kE((s==null?void 0:s.lat)??null,(s==null?void 0:s.lon)??null),o=e.area!==null&&e.area>0,c=e.length!==null&&e.length>0,l=x.useMemo(()=>Object.entries(r).filter(([h])=>h!=="name").filter(([,h])=>h!=null),[r]);return g.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 border-t border-neutral-200 pt-2 text-xs dark:border-neutral-700",children:[g.jsxs("div",{className:"col-span-2 flex items-center gap-1.5 text-neutral-600 dark:text-neutral-400",children:[g.jsx(Rl,{className:"h-3.5 w-3.5 shrink-0"}),a?g.jsx("span",{className:"animate-pulse text-neutral-400",children:"Loading location..."}):i?g.jsx("span",{className:"truncate",title:i,children:i}):g.jsx("span",{className:"text-neutral-400 dark:text-neutral-500",children:"Location unavailable"})]}),g.jsxs("div",{className:"text-neutral-500 dark:text-neutral-400",children:[g.jsx("span",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:"Points:"})," ",e.pointCount]}),o&&g.jsxs("div",{className:"text-neutral-500 dark:text-neutral-400",children:[g.jsx("span",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:"Area:"})," ",e.formattedArea]}),c&&g.jsxs("div",{className:"text-neutral-500 dark:text-neutral-400",children:[g.jsx("span",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:n.type.includes("Polygon")?"Perimeter:":"Length:"})," ",e.formattedLength]}),s&&g.jsxs("div",{className:"col-span-2 text-neutral-500 dark:text-neutral-400",children:[g.jsx("span",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:"Centroid:"})," ",s.lat.toFixed(6),", ",s.lon.toFixed(6)]}),l.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"col-span-2 mt-2 border-t border-neutral-200 pt-2 font-medium text-neutral-700 dark:border-neutral-700 dark:text-neutral-300",children:"Properties"}),l.map(([h,u])=>g.jsxs("div",{className:"col-span-2 text-neutral-500 dark:text-neutral-400",children:[g.jsxs("span",{className:"font-medium text-neutral-700 dark:text-neutral-300",children:[h,":"]})," ",g.jsx("span",{className:"break-all",children:AE(u)})]},h))]})]})}function RE({feature:t,index:e,isSelected:n,onSelect:r,onHover:s}){const[i,a]=x.useState(!1),{geometry:o,properties:c}=t,l=()=>{s(!0)},h=()=>{s(!1)},u=x.useMemo(()=>{const S=mE(o),M=gE(o),N=Ou(o),I=_E(o.type);return{area:S,length:M,pointCount:N,typeLabel:I,formattedArea:yE(S),formattedLength:vE(M)}},[o]),f=c.name,d=typeof f=="string"&&f.trim()?f:`Feature ${String(e+1)}`,p=CE(o.type),_=S=>{S.stopPropagation(),a(M=>!M)},m=S=>{S.key==="Enter"?(S.preventDefault(),r()):S.key===" "&&(S.preventDefault(),a(M=>!M))},y=x.useMemo(()=>{const S=[u.typeLabel];return u.pointCount>1&&S.push(`${String(u.pointCount)} pts`),u.area!==null&&u.area>0?S.push(u.formattedArea):u.length!==null&&u.length>0&&S.push(u.formattedLength),S.join("  ")},[u]);return g.jsxs("div",{onClick:r,onKeyDown:m,onMouseEnter:l,onMouseLeave:h,tabIndex:0,role:"button","aria-expanded":i,"aria-selected":n,className:`cursor-pointer border-b border-neutral-200 px-3 py-2 transition-colors hover:bg-neutral-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary-500 dark:border-neutral-700 dark:hover:bg-neutral-800 ${n?"bg-blue-50 hover:bg-blue-100 dark:bg-blue-950 dark:hover:bg-blue-900":"bg-white dark:bg-neutral-900"}`,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("button",{onClick:_,className:"flex h-6 w-6 shrink-0 items-center justify-center rounded text-neutral-400 hover:bg-neutral-200 hover:text-neutral-600 dark:hover:bg-neutral-700 dark:hover:text-neutral-300","aria-label":i?"Collapse details":"Expand details",children:i?g.jsx(Yg,{className:"h-4 w-4"}):g.jsx(Qg,{className:"h-4 w-4"})}),g.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${n?"bg-primary-100 text-primary-600 dark:bg-primary-900 dark:text-primary-400":"bg-neutral-100 text-neutral-500 dark:bg-neutral-800 dark:text-neutral-400"}`,children:g.jsx(p,{className:"h-4 w-4"})}),g.jsxs("div",{className:"min-w-0 flex-1",children:[g.jsx("div",{className:"truncate text-sm font-medium text-neutral-900 dark:text-neutral-100",children:d}),g.jsx("div",{className:"truncate text-xs text-neutral-500 dark:text-neutral-400",children:y})]}),g.jsxs("div",{className:"shrink-0 text-xs font-medium text-neutral-400 dark:text-neutral-500",children:["#",e+1]})]}),i&&g.jsx(GE,{feature:t,calculations:u})]})}function LE({onPanToFeature:t}){const{features:e,selectedFeatureId:n,setSelectedFeatureId:r,setHoveredFeatureId:s}=Ft(),i=x.useCallback(o=>{n===o?r(null):(r(o),t==null||t(o))},[n,r,t]),a=x.useCallback(o=>{s(o)},[s]);return e.length===0?g.jsx("div",{className:"rounded-md border border-neutral-200 bg-neutral-50 p-4 text-center text-sm text-neutral-500 dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-400",children:"No geometries to display"}):g.jsxs("div",{className:"overflow-hidden rounded-md border border-neutral-200 dark:border-neutral-700",children:[g.jsx("div",{className:"max-h-80 overflow-auto",children:e.map((o,c)=>g.jsx(RE,{feature:o,index:c,isSelected:n===o.id,onSelect:()=>{i(o.id)},onHover:l=>{a(l?o.id:null)}},o.id))}),g.jsxs("div",{className:"border-t border-neutral-200 bg-neutral-50 px-3 py-2 text-xs text-neutral-500 dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-400",children:[e.length," ",e.length===1?"geometry":"geometries"]})]})}function $u(){const t=ea(e=>e.panToFeature);return g.jsxs("div",{className:"flex h-full flex-col overflow-y-auto bg-neutral-50 dark:bg-neutral-900",children:[g.jsx(j4,{}),g.jsxs("div",{className:"border-t border-neutral-200 p-3 md:p-4 dark:border-neutral-700",children:[g.jsx("h3",{className:"mb-2 text-sm font-medium text-neutral-700 md:mb-3 dark:text-neutral-300",children:"Geometries"}),g.jsx(LE,{onPanToFeature:t})]}),g.jsx(pE,{})]})}const OE=xe(()=>import("./maplibre-gl-aGn2FQTM.js").then(t=>t.m),__vite__mapDeps([2,1]),import.meta.url),jE=x.forwardRef(function(e,n){return Wu(e,n,OE)}),FE=zu,St=Ju,fi=Vu,$E={id:"geometry-fill",type:"fill",source:"geometry-source",paint:{"fill-color":"#3b82f6","fill-opacity":.2},filter:["==","$type","Polygon"]},DE={id:"geometry-line",type:"line",source:"geometry-source",paint:{"line-color":"#2563eb","line-width":2},filter:["in","$type","LineString","Polygon"]},UE={id:"geometry-point",type:"circle",source:"geometry-source",paint:{"circle-radius":6,"circle-color":"#2563eb","circle-stroke-color":"#ffffff","circle-stroke-width":2},filter:["==","$type","Point"]},qE={id:"geometry-fill-hover",type:"fill",source:"geometry-source",paint:{"fill-color":"#8b5cf6","fill-opacity":.3}},BE={id:"geometry-line-hover",type:"line",source:"geometry-source",paint:{"line-color":"#7c3aed","line-width":3}},HE={id:"geometry-point-hover",type:"circle",source:"geometry-source",paint:{"circle-radius":8,"circle-color":"#8b5cf6","circle-stroke-color":"#ffffff","circle-stroke-width":2}},WE={id:"geometry-fill-selected",type:"fill",source:"geometry-source",paint:{"fill-color":"#f97316","fill-opacity":.4}},zE={id:"geometry-line-selected",type:"line",source:"geometry-source",paint:{"line-color":"#ea580c","line-width":4}},VE={id:"geometry-point-selected",type:"circle",source:"geometry-source",paint:{"circle-radius":10,"circle-color":"#f97316","circle-stroke-color":"#ffffff","circle-stroke-width":3}},JE={id:"envelope-fill",type:"fill",source:"envelope-source",paint:{"fill-color":"#10b981","fill-opacity":.1}},XE={id:"envelope-line",type:"line",source:"envelope-source",paint:{"line-color":"#059669","line-width":2,"line-dasharray":[4,2]}};function KE({features:t,selectedFeatureId:e,hoveredFeatureId:n,isEnvelopeHovered:r,envelope:s}){const i=x.useMemo(()=>{const p=e?["==","id",e]:null,_=n&&n!==e?["==","id",n]:null;let m;return e&&n&&n!==e?m=["all",["!=","id",e],["!=","id",n]]:e?m=["!=","id",e]:n&&(m=["!=","id",n]),{selectedFilter:p,hoverFilter:_,baseExcludeFilter:m}},[e,n]),a=x.useMemo(()=>{if(!r||!s)return null;const[p,_,m,y]=s;return{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[p,_],[m,_],[m,y],[p,y],[p,_]]]},properties:{}}]}},[r,s]);if(t.length===0)return null;const o={type:"FeatureCollection",features:t.map(p=>({...p,properties:{...p.properties,id:p.id}}))},{selectedFilter:c,hoverFilter:l,baseExcludeFilter:h}=i,u=h?["all",["==","$type","Polygon"],h]:["==","$type","Polygon"],f=h?["all",["in","$type","LineString","Polygon"],h]:["in","$type","LineString","Polygon"],d=h?["all",["==","$type","Point"],h]:["==","$type","Point"];return g.jsxs(g.Fragment,{children:[g.jsxs(fi,{id:"geometry-source",type:"geojson",data:o,children:[g.jsx(St,{...$E,filter:u}),g.jsx(St,{...DE,filter:f}),g.jsx(St,{...UE,filter:d}),l&&g.jsxs(g.Fragment,{children:[g.jsx(St,{...qE,filter:["all",["==","$type","Polygon"],l]}),g.jsx(St,{...BE,filter:["all",["in","$type","LineString","Polygon"],l]}),g.jsx(St,{...HE,filter:["all",["==","$type","Point"],l]})]}),c&&g.jsxs(g.Fragment,{children:[g.jsx(St,{...WE,filter:["all",["==","$type","Polygon"],c]}),g.jsx(St,{...zE,filter:["all",["in","$type","LineString","Polygon"],c]}),g.jsx(St,{...VE,filter:["all",["==","$type","Point"],c]})]})]}),a&&g.jsxs(fi,{id:"envelope-source",type:"geojson",data:a,children:[g.jsx(St,{...JE}),g.jsx(St,{...XE})]})]})}function YE({viewState:t,onViewStateChange:e,basemap:n,features:r,selectedFeatureId:s,hoveredFeatureId:i,isEnvelopeHovered:a,envelope:o,isDrawing:c,drawingPreview:l,onMapClick:h,children:u}){const f=x.useRef(null),d=x.useCallback(m=>{e({longitude:m.viewState.longitude,latitude:m.viewState.latitude,zoom:m.viewState.zoom})},[e]),p=x.useCallback(m=>{h({lng:m.lngLat.lng,lat:m.lngLat.lat})},[h]),_=n==="satellite"?"https://api.maptiler.com/maps/hybrid/style.json?key=get_your_own_key":"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json";return g.jsxs(jE,{ref:f,...t,onMove:d,onClick:p,mapStyle:_,style:{width:"100%",height:"100%"},cursor:c?"crosshair":void 0,children:[g.jsx(FE,{position:"top-right"}),u,l&&g.jsxs(fi,{id:"drawing-preview",type:"geojson",data:l,children:[g.jsx(St,{id:"drawing-preview-line",type:"line",paint:{"line-color":"#f97316","line-width":2,"line-dasharray":[2,2]},filter:["==","$type","LineString"]}),g.jsx(St,{id:"drawing-preview-points",type:"circle",paint:{"circle-radius":6,"circle-color":"#f97316","circle-stroke-color":"#ffffff","circle-stroke-width":2},filter:["==","$type","Point"]})]}),g.jsx(KE,{features:r,selectedFeatureId:s,hoveredFeatureId:i,isEnvelopeHovered:a,envelope:o})]})}const Du=tr(t=>({mode:"none",currentPoints:[],setMode:e=>{t({mode:e,currentPoints:[]})},addPoint:e=>{t(n=>({currentPoints:[...n.currentPoints,e]}))},clearPoints:()=>{t({currentPoints:[]})},reset:()=>{t({mode:"none",currentPoints:[]})}}));function QE(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const a=c=>c===null?null:JSON.parse(c,void 0),o=(i=n.getItem(s))!=null?i:null;return o instanceof Promise?o.then(a):a(o)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const di=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return di(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return di(r)(n)}}}},ZE=(t,e)=>(n,r,s)=>{let i={storage:QE(()=>localStorage),partialize:m=>m,version:0,merge:(m,y)=>({...y,...m}),...e},a=!1,o=0;const c=new Set,l=new Set;let h=i.storage;if(!h)return t((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...m)},r,s);const u=()=>{const m=i.partialize({...r()});return h.setItem(i.name,{state:m,version:i.version})},f=s.setState;s.setState=(m,y)=>(f(m,y),u());const d=t((...m)=>(n(...m),u()),r,s);s.getInitialState=()=>d;let p;const _=()=>{var m,y;if(!h)return;const S=++o;a=!1,c.forEach(N=>{var I;return N((I=r())!=null?I:d)});const M=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(m=r())!=null?m:d))||void 0;return di(h.getItem.bind(h))(i.name).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==i.version){if(i.migrate){const I=i.migrate(N.state,N.version);return I instanceof Promise?I.then(v=>[!0,v]):[!0,I]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,N.state];return[!1,void 0]}).then(N=>{var I;if(S!==o)return;const[v,E]=N;if(p=i.merge(E,(I=r())!=null?I:d),n(p,!0),v)return u()}).then(()=>{S===o&&(M==null||M(p,void 0),p=r(),a=!0,l.forEach(N=>N(p)))}).catch(N=>{S===o&&(M==null||M(void 0,N))})};return s.persist={setOptions:m=>{i={...i,...m},m.storage&&(h=m.storage)},clearStorage:()=>{h==null||h.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:m=>(c.add(m),()=>{c.delete(m)}),onFinishHydration:m=>(l.add(m),()=>{l.delete(m)})},i.skipHydration||_(),p||d},tb=ZE,eb=33.33,na=tr()(tb(t=>({theme:"system",leftPanelWidthPercent:eb,autoPanToGeometry:!0,mapProvider:"maplibre",setTheme:e=>{t({theme:e})},setLeftPanelWidthPercent:e=>{t({leftPanelWidthPercent:e})},setAutoPanToGeometry:e=>{t({autoPanToGeometry:e})},toggleAutoPanToGeometry:()=>{t(e=>({autoPanToGeometry:!e.autoPanToGeometry}))},setMapProvider:e=>{t({mapProvider:e})}}),{name:"geofiddle-preferences"}));async function Uu(t){const{geometry:e,rawText:n,inputFormat:r,inputProjection:s,detectedFormat:i,detectedProjection:a}=t,o=r!=="auto"?r:i??"geojson",c=s!=="auto"?s:a??"EPSG:4326",h={type:"Feature",geometry:c!=="EPSG:4326"?me(e,"EPSG:4326",c):e,properties:{}},u=n.trim();if(!u)return{newText:Me([h],o,{projection:c}),effectiveFormat:o,effectiveProjection:c};const f=await li(u,o);if(f.features.length>0){const p=[...f.features,h];return{newText:Me(p,o,{projection:c}),effectiveFormat:o,effectiveProjection:c}}const d=Ru(u);if(d&&d!==o){const p=await li(u,d);if(p.features.length>0){const _=[...p.features,h];return{newText:Me(_,d,{projection:c}),effectiveFormat:d,effectiveProjection:c}}}return{newText:Me([h],o,{projection:c}),effectiveFormat:o,effectiveProjection:c}}function nb({onFitBounds:t,hasFeatures:e=!1}){const{mode:n,setMode:r,currentPoints:s,reset:i}=Du(),{rawText:a,inputFormat:o,inputProjection:c,detectedFormat:l,detectedProjection:h,setRawText:u}=Ft(),{autoPanToGeometry:f,toggleAutoPanToGeometry:d,mapProvider:p,setMapProvider:_}=na(),m=x.useCallback(()=>{_(p==="maplibre"?"google":"maplibre")},[p,_]),y=x.useCallback(v=>{n===v?i():r(v)},[n,r,i]),S=x.useCallback(async()=>{if(s.length===0){i();return}let v=null;const E=s[0];if(n==="point"&&s.length>=1&&E?v={type:"Point",coordinates:E}:n==="line"&&s.length>=2?v={type:"LineString",coordinates:s}:n==="polygon"&&s.length>=3&&E&&(v={type:"Polygon",coordinates:[[...s,E]]}),v){const k=await Uu({geometry:v,rawText:a,inputFormat:o,inputProjection:c,detectedFormat:l,detectedProjection:h});u(k.newText)}i()},[n,s,a,o,c,l,h,u,i]),M=x.useCallback(()=>{i()},[i]),N=n!=="none",I=n==="point"&&s.length>=1||n==="line"&&s.length>=2||n==="polygon"&&s.length>=3;return g.jsxs("div",{className:"absolute left-2 top-2 flex flex-col gap-1",children:[g.jsxs("div",{className:"flex gap-1 rounded bg-white p-1 shadow-md",children:[g.jsx("button",{onClick:()=>{y("point")},className:`flex h-8 w-8 items-center justify-center rounded transition-colors ${n==="point"?"bg-primary-500 text-white":"text-neutral-700 hover:bg-neutral-100"}`,title:"Draw point","aria-label":"Draw point","aria-pressed":n==="point",children:g.jsx(Rl,{className:"h-4 w-4"})}),g.jsx("button",{onClick:()=>{y("line")},className:`flex h-8 w-8 items-center justify-center rounded transition-colors ${n==="line"?"bg-primary-500 text-white":"text-neutral-700 hover:bg-neutral-100"}`,title:"Draw line","aria-label":"Draw line","aria-pressed":n==="line",children:g.jsx(f1,{className:"h-4 w-4"})}),g.jsx("button",{onClick:()=>{y("polygon")},className:`flex h-8 w-8 items-center justify-center rounded transition-colors ${n==="polygon"?"bg-primary-500 text-white":"text-neutral-700 hover:bg-neutral-100"}`,title:"Draw polygon","aria-label":"Draw polygon","aria-pressed":n==="polygon",children:g.jsx(Ol,{className:"h-4 w-4"})}),g.jsx("div",{className:"mx-0.5 w-px self-stretch bg-neutral-200"}),g.jsx("button",{onClick:d,className:`flex h-8 w-8 items-center justify-center rounded transition-colors ${f?"bg-primary-500 text-white":"text-neutral-700 hover:bg-neutral-100"}`,title:f?"Auto-pan enabled (click to disable)":"Auto-pan disabled (click to enable)","aria-label":f?"Disable auto-pan to geometry":"Enable auto-pan to geometry","aria-pressed":f,children:f?g.jsx(l1,{className:"h-4 w-4"}):g.jsx(u1,{className:"h-4 w-4"})}),e&&t&&g.jsx("button",{onClick:t,className:"flex h-8 w-8 items-center justify-center rounded text-neutral-700 transition-colors hover:bg-neutral-100",title:"Fit map to geometry","aria-label":"Fit map to geometry",children:g.jsx(h1,{className:"h-4 w-4"})}),g.jsx("div",{className:"mx-0.5 w-px self-stretch bg-neutral-200"}),g.jsx("button",{onClick:m,className:"flex h-8 w-8 items-center justify-center rounded text-neutral-700 transition-colors hover:bg-neutral-100",title:p==="maplibre"?"Switch to Google Maps":"Switch to MapLibre","aria-label":p==="maplibre"?"Switch to Google Maps":"Switch to MapLibre",children:p==="maplibre"?g.jsx(Ll,{className:"h-4 w-4"}):g.jsx(i1,{className:"h-4 w-4"})})]}),N&&g.jsxs("div",{className:"rounded bg-white p-2 shadow-md",children:[g.jsxs("div",{className:"mb-2 text-xs text-neutral-600",children:[n==="point"&&"Click to place point",n==="line"&&`Click to add points (${String(s.length)} added)`,n==="polygon"&&`Click to add vertices (${String(s.length)} added)`]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsxs("button",{onClick:S,disabled:!I,className:"flex flex-1 items-center justify-center gap-1 rounded bg-primary-500 px-2 py-1 text-xs text-white hover:bg-primary-600 disabled:opacity-50",children:[g.jsx(Kg,{className:"h-3 w-3"}),"Finish"]}),g.jsx("button",{onClick:M,className:"flex items-center justify-center rounded border border-neutral-300 px-2 py-1 text-xs text-neutral-700 hover:bg-neutral-100",children:g.jsx(y1,{className:"h-3 w-3"})})]})]})]})}const rb=x.lazy(()=>xe(()=>import("./index-B9vnM0By.js"),__vite__mapDeps([3,1]),import.meta.url).then(t=>({default:t.GoogleMap})));function Yo(t){const e=[],n=r=>{if(!r)return;if(r.type==="GeometryCollection"){for(const i of r.geometries)n(i);return}const s=i=>{if(Array.isArray(i))if(typeof i[0]=="number"&&typeof i[1]=="number")e.push(i);else for(const a of i)s(a)};s(r.coordinates)};for(const r of t)n(r.geometry);return e}function sb(){return g.jsx("div",{className:"flex h-full w-full items-center justify-center bg-neutral-100",children:g.jsx("div",{className:"text-neutral-600",children:"Loading map..."})})}function qu(){const{viewState:t,setViewState:e,basemap:n,panToFeatureId:r,clearPanToFeature:s,isEnvelopeHovered:i}=ea(),{features:a,selectedFeatureId:o,hoveredFeatureId:c,rawText:l,inputFormat:h,inputProjection:u,detectedFormat:f,detectedProjection:d,setCoordinateError:p,setRawText:_}=Ft(),{mode:m,currentPoints:y,addPoint:S,reset:M}=Du(),{autoPanToGeometry:N,mapProvider:I}=na(),v=x.useMemo(()=>{if(u!=="auto")return u;if(d)return d;if(a.length>0){const A=Yo(a);return ar(A)}return"EPSG:4326"},[u,d,a]),{transformedFeatures:E,coordinateError:k}=x.useMemo(()=>{if(a.length===0)return{transformedFeatures:[],coordinateError:null};const A=v==="EPSG:4326"?a:a.map(F=>({...F,geometry:me(F.geometry,v,"EPSG:4326")})),O=Yo(A),G=uu(O);if(!G.valid&&G.invalidCoord){const[F,J]=G.invalidCoord;return{transformedFeatures:[],coordinateError:`Coordinates out of range for WGS84: (${String(F)}, ${String(J)}). Longitude must be -180 to 180, latitude must be -90 to 90. Try selecting a different input projection.`}}return{transformedFeatures:A,coordinateError:null}},[a,v]);x.useEffect(()=>{p(k)},[k,p]);const L=x.useCallback(()=>{if(E.length===0)return null;const A=hi(E),O=Lr(A);if(!O.every(cs=>isFinite(cs)))return null;const[G,F,J,at]=O,At=(G+J)/2,vt=(F+at)/2,Oe=at-F,qt=J-G,ee=Math.max(Oe,qt);let Gt=10;return ee>0&&(Gt=Math.floor(Math.log2(360/ee))-1,Gt=Math.max(1,Math.min(Gt,18))),{longitude:At,latitude:vt,zoom:Gt}},[E]),V=x.useCallback(()=>{const A=L();A&&e(A)},[L,e]);x.useEffect(()=>{N&&V()},[N,V]),x.useEffect(()=>{if(!r)return;const A=E.find(O=>O.id===r);if(!A){s();return}try{const O=Lr(A);if(!O.every(cs=>isFinite(cs))){s();return}const[G,F,J,at]=O,At=(G+J)/2,vt=(F+at)/2,Oe=at-F,qt=J-G,ee=Math.max(Oe,qt);let Gt=14;ee>0&&(Gt=Math.floor(Math.log2(360/ee))-1,Gt=Math.max(1,Math.min(Gt,18))),e({longitude:At,latitude:vt,zoom:Gt})}finally{s()}},[r,E,e,s]);const W=x.useCallback(async A=>{if(m==="none")return;const{lng:O,lat:G}=A,F=[O,G];if(m==="point"){const J=await Uu({geometry:{type:"Point",coordinates:F},rawText:l,inputFormat:h,inputProjection:u,detectedFormat:f,detectedProjection:d});_(J.newText),M()}else S(F)},[m,l,h,u,f,d,_,S,M]),it=x.useMemo(()=>{if(m==="none"||y.length===0)return null;const A=[];if(y.forEach((O,G)=>{A.push({type:"Feature",geometry:{type:"Point",coordinates:O},properties:{index:G}})}),y.length>=2){const O=y[0],G=m==="polygon"&&y.length>=3&&O?[...y,O]:y;A.push({type:"Feature",geometry:{type:"LineString",coordinates:G},properties:{}})}return{type:"FeatureCollection",features:A}},[m,y]),K=E.length>0,X=m!=="none",Ut=x.useMemo(()=>{if(E.length===0)return null;try{const A=hi(E),O=Lr(A);return O.every(G=>isFinite(G))?O:null}catch{return null}},[E]),yt={viewState:t,onViewStateChange:e,basemap:n,features:E,selectedFeatureId:o,hoveredFeatureId:c,isEnvelopeHovered:i,envelope:Ut,isDrawing:X,drawingPreview:it,onMapClick:W},Ct=g.jsx(nb,{onFitBounds:V,hasFeatures:K});return I==="google"?g.jsx(x.Suspense,{fallback:g.jsx(sb,{}),children:g.jsx(rb,{...yt,children:Ct})}):g.jsx(YE,{...yt,children:Ct})}function ib(){const[t,e]=x.useState("input");return g.jsxs("main",{id:"main-content",className:"flex flex-1 flex-col overflow-hidden",role:"main",children:[g.jsx("div",{className:"flex-1 overflow-hidden",children:t==="input"?g.jsx("div",{className:"h-full overflow-y-auto",children:g.jsx($u,{})}):g.jsx(qu,{})}),g.jsxs("nav",{className:"flex shrink-0 border-t border-neutral-200 bg-white dark:border-neutral-700 dark:bg-neutral-900",role:"tablist","aria-label":"Main navigation",children:[g.jsxs("button",{role:"tab","aria-selected":t==="input","aria-controls":"input-panel",onClick:()=>{e("input")},className:`flex flex-1 items-center justify-center gap-1.5 py-2 text-xs font-medium transition-colors ${t==="input"?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200"}`,children:[g.jsx(s1,{className:"h-4 w-4"}),g.jsx("span",{children:"Input"})]}),g.jsxs("button",{role:"tab","aria-selected":t==="map","aria-controls":"map-panel",onClick:()=>{e("map")},className:`flex flex-1 items-center justify-center gap-1.5 py-2 text-xs font-medium transition-colors ${t==="map"?"text-primary-600 dark:text-primary-400":"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200"}`,children:[g.jsx(Ll,{className:"h-4 w-4"}),g.jsx("span",{children:"Map"})]})]})]})}const Qo=768;function ab(){const[t,e]=x.useState(()=>typeof window>"u"?!1:window.innerWidth<Qo);return x.useEffect(()=>{const n=window.matchMedia(`(max-width: ${String(Qo-1)}px)`),r=s=>{e(s.matches)};return e(n.matches),n.addEventListener("change",r),()=>{n.removeEventListener("change",r)}},[]),t}const ob=20,cb=66.67;function lb(){const{theme:t,setTheme:e,leftPanelWidthPercent:n,setLeftPanelWidthPercent:r}=na(),s=ab();return x.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),t==="system"){const a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(a)}else i.classList.add(t)},[t]),x.useEffect(()=>{if(t!=="system")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),a=o=>{const c=window.document.documentElement;c.classList.remove("light","dark"),c.classList.add(o.matches?"dark":"light")};return i.addEventListener("change",a),()=>{i.removeEventListener("change",a)}},[t]),g.jsxs("div",{className:"flex h-full flex-col",children:[g.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),g.jsx(v1,{theme:t,onThemeChange:e}),s?g.jsx(ib,{}):g.jsx(S1,{left:g.jsx($u,{}),right:g.jsx(qu,{}),leftWidthPercent:n,minLeftWidthPercent:ob,maxLeftWidthPercent:cb,onLeftWidthPercentChange:r})]})}function ub(t){const e=[],n=r=>{if(!r)return;if(r.type==="GeometryCollection"){for(const i of r.geometries)n(i);return}const s=i=>{if(Array.isArray(i))if(typeof i[0]=="number"&&typeof i[1]=="number")e.push(i);else for(const a of i)s(a)};"coordinates"in r&&s(r.coordinates)};for(const r of t)n(r.geometry);return e}const hb=100*1024,fb=150;function db(){const{rawText:t,inputFormat:e,inputProjection:n,setFeatures:r,setParseError:s,setDetectedFormat:i,setDetectedProjection:a,setIsParsing:o}=Ft(),c=x.useRef(null),l=x.useRef(0),h=x.useRef();x.useEffect(()=>()=>{c.current&&(c.current.terminate(),c.current=null),h.current&&clearTimeout(h.current)},[]);const u=x.useCallback(()=>(c.current||(c.current=new Worker(new URL(""+new URL("parser.worker-5m5OEhxp.js",import.meta.url).href,import.meta.url),{type:"module"})),c.current),[]),f=x.useCallback(p=>{const _=u(),m=++l.current;o(!0),_.onmessage=S=>{const M=S.data;M.id===l.current&&(o(!1),M.parseError?s(M.parseError):r(M.features),i(M.detectedFormat),a(M.detectedProjection))},_.onerror=S=>{o(!1),s(`Worker error: ${S.message}`)};const y={id:m,rawText:p,inputFormat:e,inputProjection:n};_.postMessage(y)},[u,e,n,r,s,i,a,o]),d=x.useCallback(async p=>{const{parse:_}=await xe(async()=>{const{parse:v}=await Promise.resolve().then(()=>HS);return{parse:v}},void 0,import.meta.url),{detectFormat:m,detectProjection:y}=await xe(async()=>{const{detectFormat:v,detectProjection:E}=await import("./format-detection-Chare-MU.js");return{detectFormat:v,detectProjection:E}},__vite__mapDeps([4,1]),import.meta.url),{detectProjectionFromCoordinates:S}=await xe(async()=>{const{detectProjectionFromCoordinates:v}=await Promise.resolve().then(()=>A4);return{detectProjectionFromCoordinates:v}},void 0,import.meta.url);if(!p.trim()){r([]),i(null),a(null);return}const M=e==="auto"?m(p):e,N=e==="auto"?M:null;if(!M){s("Could not auto-detect format. Please select a format manually.");return}let I=n==="auto"?y(p,M):null;try{const v=await _(p,M);if(v.errors.length>0)s(v.errors.map(E=>E.message).join(`
`));else if(r(v.features),n==="auto"&&!I&&!v.detectedProjection&&v.features.length>0){const E=ub(v.features);E.length>0&&(I=S(E))}i(N),a(I??v.detectedProjection??null)}catch(v){s(v instanceof Error?v.message:"Parsing failed")}},[e,n,r,s,i,a]);x.useEffect(()=>{if(h.current&&clearTimeout(h.current),!t.trim()){r([]),i(null),a(null),o(!1);return}return h.current=setTimeout(()=>{t.length>hb?f(t):d(t)},fb),()=>{h.current&&clearTimeout(h.current)}},[t,e,n,f,d,r,i,a,o])}function pb(){const{rawText:t,inputFormat:e,inputProjection:n,setRawText:r,setInputFormat:s,setInputProjection:i}=Ft(),{setOutputFormat:a,setOutputProjection:o}=or(),c=x.useRef(!0),l=x.useRef(!1);x.useEffect(()=>{const h=window.location.hash.slice(1);if(!h){c.current=!1;return}try{const u=Zo(h);u.format&&(s(u.format),a(u.format==="auto"?"geojson":u.format)),u.projection&&(i(u.projection),o(u.projection==="auto"?"EPSG:4326":u.projection)),u.geometry&&(l.current=!0,r(u.geometry))}catch(u){console.warn("Failed to parse URL hash:",u)}c.current=!1},[r,s,i,a,o]),x.useEffect(()=>{if(c.current)return;if(l.current){l.current=!1;return}const h=_b({format:e,projection:n,geometry:t}),u=h?`#${h}`:window.location.pathname;window.history.replaceState(null,"",u)},[t,e,n]),x.useEffect(()=>{const h=()=>{const u=window.location.hash.slice(1);if(u)try{const f=Zo(u);l.current=!0,f.format&&s(f.format),f.projection&&i(f.projection),f.geometry&&r(f.geometry)}catch(f){console.warn("Failed to parse URL hash:",f)}};return window.addEventListener("hashchange",h),()=>{window.removeEventListener("hashchange",h)}},[r,s,i])}const mb={auto:"auto","EPSG:4326":"wgs84","EPSG:27700":"bng","EPSG:3857":"web-mercator"},gb={auto:"auto",wgs84:"EPSG:4326",bng:"EPSG:27700","web-mercator":"EPSG:3857","EPSG:4326":"EPSG:4326","EPSG:27700":"EPSG:27700","EPSG:3857":"EPSG:3857"};function Zo(t){const e=t.split("/"),n={};if(e[0]&&(n.format=decodeURIComponent(e[0])),e[1]){const r=decodeURIComponent(e[1]);n.projection=gb[r]??"auto"}return e[2]&&(n.geometry=decodeURIComponent(e[2])),n}function _b(t){var i;if(!((i=t.geometry)!=null&&i.trim()))return"";const e=encodeURIComponent(t.format??"auto"),n=t.projection??"auto",r=encodeURIComponent(mb[n]),s=encodeURIComponent(t.geometry);return`${e}/${r}/${s}`}function yb(){return pb(),db(),g.jsx(lb,{})}function vb(t){const e=window.dataLayer??[];window.dataLayer=e,window.gtag=function(...s){e.push(s)},window.gtag("js",new Date),window.gtag("config",t);const n=document.createElement("script");n.async=!0,n.src=`https://www.googletagmanager.com/gtag/js?id=${t}`,document.head.appendChild(n)}async function Sb(){try{const t=await fetch("./PRIVATE.json");if(!t.ok)return;const e=await t.json();e.sentryDsn&&Wg({dsn:e.sentryDsn,release:"260fa3e5ce5cc77737d8e6de0ffd761a64f27bcf",environment:"production",enabled:!0,integrations:[Dg()],tracesSampleRate:.1}),e.googleAnalyticsId&&vb(e.googleAnalyticsId)}catch{}}async function Eb(){await Sb();const t=document.getElementById("root");if(!t)throw new Error("Failed to find root element");Qu.createRoot(t).render(g.jsx(x.StrictMode,{children:g.jsx(yb,{})}))}Eb();export{Ru as d,g as j};
//# sourceMappingURL=index-y2HwiKNe.js.map

//# debugId=bfc13d24-9a94-5353-a651-a6af953764ae
